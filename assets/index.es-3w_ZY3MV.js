import{g as cn,a as $0,bc as F0,bb as Vn,c as Oi}from"./index-Bgg2saC1.js";import{a as q0,b as U0,d as z0,e as B0,f as Ni,g as Ri,c as k0,h as wo,i as K0,j as _o,p as Gi}from"./format-CvwSKJ1T.js";var xo={exports:{}},en=typeof Reflect=="object"?Reflect:null,df=en&&typeof en.apply=="function"?en.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)},ms;en&&typeof en.ownKeys=="function"?ms=en.ownKeys:Object.getOwnPropertySymbols?ms=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:ms=function(e){return Object.getOwnPropertyNames(e)};function j0(r){console&&console.warn&&console.warn(r)}var cc=Number.isNaN||function(e){return e!==e};function it(){it.init.call(this)}xo.exports=it;xo.exports.once=W0;it.EventEmitter=it;it.prototype._events=void 0;it.prototype._eventsCount=0;it.prototype._maxListeners=void 0;var pf=10;function Vs(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(it,"defaultMaxListeners",{enumerable:!0,get:function(){return pf},set:function(r){if(typeof r!="number"||r<0||cc(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");pf=r}});it.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};it.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||cc(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function uc(r){return r._maxListeners===void 0?it.defaultMaxListeners:r._maxListeners}it.prototype.getMaxListeners=function(){return uc(this)};it.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var h;if(t.length>0&&(h=t[0]),h instanceof Error)throw h;var u=new Error("Unhandled error."+(h?" ("+h.message+")":""));throw u.context=h,u}var g=s[e];if(g===void 0)return!1;if(typeof g=="function")df(g,this,t);else for(var b=g.length,_=gc(g,b),i=0;i<b;++i)df(_[i],this,t);return!0};function lc(r,e,t,i){var n,s,h;if(Vs(t),s=r._events,s===void 0?(s=r._events=Object.create(null),r._eventsCount=0):(s.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),s=r._events),h=s[e]),h===void 0)h=s[e]=t,++r._eventsCount;else if(typeof h=="function"?h=s[e]=i?[t,h]:[h,t]:i?h.unshift(t):h.push(t),n=uc(r),n>0&&h.length>n&&!h.warned){h.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+h.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=r,u.type=e,u.count=h.length,j0(u)}return r}it.prototype.addListener=function(e,t){return lc(this,e,t,!1)};it.prototype.on=it.prototype.addListener;it.prototype.prependListener=function(e,t){return lc(this,e,t,!0)};function H0(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function dc(r,e,t){var i={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},n=H0.bind(i);return n.listener=t,i.wrapFn=n,n}it.prototype.once=function(e,t){return Vs(t),this.on(e,dc(this,e,t)),this};it.prototype.prependOnceListener=function(e,t){return Vs(t),this.prependListener(e,dc(this,e,t)),this};it.prototype.removeListener=function(e,t){var i,n,s,h,u;if(Vs(t),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===t||i.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if(typeof i!="function"){for(s=-1,h=i.length-1;h>=0;h--)if(i[h]===t||i[h].listener===t){u=i[h].listener,s=h;break}if(s<0)return this;s===0?i.shift():V0(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,u||t)}return this};it.prototype.off=it.prototype.removeListener;it.prototype.removeAllListeners=function(e){var t,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),h;for(n=0;n<s.length;++n)h=s[n],h!=="removeListener"&&this.removeAllListeners(h);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=i[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this};function pc(r,e,t){var i=r._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?t?[n.listener||n]:[n]:t?G0(n):gc(n,n.length)}it.prototype.listeners=function(e){return pc(this,e,!0)};it.prototype.rawListeners=function(e){return pc(this,e,!1)};it.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):vc.call(r,e)};it.prototype.listenerCount=vc;function vc(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}it.prototype.eventNames=function(){return this._eventsCount>0?ms(this._events):[]};function gc(r,e){for(var t=new Array(e),i=0;i<e;++i)t[i]=r[i];return t}function V0(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function G0(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function W0(r,e){return new Promise(function(t,i){function n(h){r.removeListener(e,s),i(h)}function s(){typeof r.removeListener=="function"&&r.removeListener("error",n),t([].slice.call(arguments))}bc(r,e,s,{once:!0}),e!=="error"&&J0(r,n,{once:!0})})}function J0(r,e,t){typeof r.on=="function"&&bc(r,"error",e,t)}function bc(r,e,t,i){if(typeof r.on=="function")i.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function n(s){i.once&&r.removeEventListener(e,n),t(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var Tr=xo.exports;const mc=cn(Tr);var be={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ja=function(r,e){return Ja=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},Ja(r,e)};function Y0(r,e){Ja(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Ya=function(){return Ya=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Ya.apply(this,arguments)};function X0(r,e){var t={};for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&e.indexOf(i)<0&&(t[i]=r[i]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(r);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(r,i[n])&&(t[i[n]]=r[i[n]]);return t}function Z0(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var u=r.length-1;u>=0;u--)(h=r[u])&&(s=(n<3?h(s):n>3?h(e,t,s):h(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s}function Q0(r,e){return function(t,i){e(t,i,r)}}function el(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function tl(r,e,t,i){function n(s){return s instanceof t?s:new t(function(h){h(s)})}return new(t||(t=Promise))(function(s,h){function u(_){try{b(i.next(_))}catch(M){h(M)}}function g(_){try{b(i.throw(_))}catch(M){h(M)}}function b(_){_.done?s(_.value):n(_.value).then(u,g)}b((i=i.apply(r,e||[])).next())})}function rl(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,h;return h={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function u(b){return function(_){return g([b,_])}}function g(b){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,n&&(s=b[0]&2?n.return:b[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,b[1])).done)return s;switch(n=0,s&&(b=[b[0]&2,s.value]),b[0]){case 0:case 1:s=b;break;case 4:return t.label++,{value:b[1],done:!1};case 5:t.label++,n=b[1],b=[0];continue;case 7:b=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(b[0]===6||b[0]===2)){t=0;continue}if(b[0]===3&&(!s||b[1]>s[0]&&b[1]<s[3])){t.label=b[1];break}if(b[0]===6&&t.label<s[1]){t.label=s[1],s=b;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(b);break}s[2]&&t.ops.pop(),t.trys.pop();continue}b=e.call(r,t)}catch(_){b=[6,_],n=0}finally{i=s=0}if(b[0]&5)throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}}function il(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}function nl(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function Xa(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function yc(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var i=t.call(r),n,s=[],h;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(u){h={error:u}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(h)throw h.error}}return s}function sl(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(yc(arguments[e]));return r}function al(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var i=Array(r),n=0,e=0;e<t;e++)for(var s=arguments[e],h=0,u=s.length;h<u;h++,n++)i[n]=s[h];return i}function zn(r){return this instanceof zn?(this.v=r,this):new zn(r)}function ol(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(r,e||[]),n,s=[];return n={},h("next"),h("throw"),h("return"),n[Symbol.asyncIterator]=function(){return this},n;function h(A){i[A]&&(n[A]=function(I){return new Promise(function(D,N){s.push([A,I,D,N])>1||u(A,I)})})}function u(A,I){try{g(i[A](I))}catch(D){M(s[0][3],D)}}function g(A){A.value instanceof zn?Promise.resolve(A.value.v).then(b,_):M(s[0][2],A)}function b(A){u("next",A)}function _(A){u("throw",A)}function M(A,I){A(I),s.shift(),s.length&&u(s[0][0],s[0][1])}}function fl(r){var e,t;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=r[n]?function(h){return(t=!t)?{value:zn(r[n](h)),done:n==="return"}:s?s(h):h}:s}}function hl(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof Xa=="function"?Xa(r):r[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=r[s]&&function(h){return new Promise(function(u,g){h=r[s](h),n(u,g,h.done,h.value)})}}function n(s,h,u,g){Promise.resolve(g).then(function(b){s({value:b,done:u})},h)}}function cl(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function ul(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function ll(r){return r&&r.__esModule?r:{default:r}}function dl(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function pl(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}const vl=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Ya},__asyncDelegator:fl,__asyncGenerator:ol,__asyncValues:hl,__await:zn,__awaiter:tl,__classPrivateFieldGet:dl,__classPrivateFieldSet:pl,__createBinding:il,__decorate:Z0,__exportStar:nl,__extends:Y0,__generator:rl,__importDefault:ll,__importStar:ul,__makeTemplateObject:cl,__metadata:el,__param:Q0,__read:yc,__rest:X0,__spread:sl,__spreadArrays:al,__values:Xa},Symbol.toStringTag,{value:"Module"})),Gs=$0(vl);var ya={},Sn={},vf;function gl(){if(vf)return Sn;vf=1,Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.delay=void 0;function r(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return Sn.delay=r,Sn}var Mi={},wa={},Ei={},gf;function bl(){return gf||(gf=1,Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.ONE_THOUSAND=Ei.ONE_HUNDRED=void 0,Ei.ONE_HUNDRED=100,Ei.ONE_THOUSAND=1e3),Ei}var _a={},bf;function ml(){return bf||(bf=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ONE_YEAR=r.FOUR_WEEKS=r.THREE_WEEKS=r.TWO_WEEKS=r.ONE_WEEK=r.THIRTY_DAYS=r.SEVEN_DAYS=r.FIVE_DAYS=r.THREE_DAYS=r.ONE_DAY=r.TWENTY_FOUR_HOURS=r.TWELVE_HOURS=r.SIX_HOURS=r.THREE_HOURS=r.ONE_HOUR=r.SIXTY_MINUTES=r.THIRTY_MINUTES=r.TEN_MINUTES=r.FIVE_MINUTES=r.ONE_MINUTE=r.SIXTY_SECONDS=r.THIRTY_SECONDS=r.TEN_SECONDS=r.FIVE_SECONDS=r.ONE_SECOND=void 0,r.ONE_SECOND=1,r.FIVE_SECONDS=5,r.TEN_SECONDS=10,r.THIRTY_SECONDS=30,r.SIXTY_SECONDS=60,r.ONE_MINUTE=r.SIXTY_SECONDS,r.FIVE_MINUTES=r.ONE_MINUTE*5,r.TEN_MINUTES=r.ONE_MINUTE*10,r.THIRTY_MINUTES=r.ONE_MINUTE*30,r.SIXTY_MINUTES=r.ONE_MINUTE*60,r.ONE_HOUR=r.SIXTY_MINUTES,r.THREE_HOURS=r.ONE_HOUR*3,r.SIX_HOURS=r.ONE_HOUR*6,r.TWELVE_HOURS=r.ONE_HOUR*12,r.TWENTY_FOUR_HOURS=r.ONE_HOUR*24,r.ONE_DAY=r.TWENTY_FOUR_HOURS,r.THREE_DAYS=r.ONE_DAY*3,r.FIVE_DAYS=r.ONE_DAY*5,r.SEVEN_DAYS=r.ONE_DAY*7,r.THIRTY_DAYS=r.ONE_DAY*30,r.ONE_WEEK=r.SEVEN_DAYS,r.TWO_WEEKS=r.ONE_WEEK*2,r.THREE_WEEKS=r.ONE_WEEK*3,r.FOUR_WEEKS=r.ONE_WEEK*4,r.ONE_YEAR=r.ONE_DAY*365}(_a)),_a}var mf;function wc(){return mf||(mf=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Gs;e.__exportStar(bl(),r),e.__exportStar(ml(),r)}(wa)),wa}var yf;function yl(){if(yf)return Mi;yf=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.fromMiliseconds=Mi.toMiliseconds=void 0;const r=wc();function e(i){return i*r.ONE_THOUSAND}Mi.toMiliseconds=e;function t(i){return Math.floor(i/r.ONE_THOUSAND)}return Mi.fromMiliseconds=t,Mi}var wf;function wl(){return wf||(wf=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Gs;e.__exportStar(gl(),r),e.__exportStar(yl(),r)}(ya)),ya}var Wi={},_f;function _l(){if(_f)return Wi;_f=1,Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const i=this.get(t);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const n=Date.now()-i.started;this.timestamps.set(t,{started:i.started,elapsed:n})}get(t){const i=this.timestamps.get(t);if(typeof i>"u")throw new Error(`No timestamp found for label: ${t}`);return i}elapsed(t){const i=this.get(t);return i.elapsed||Date.now()-i.started}}return Wi.Watch=r,Wi.default=r,Wi}var xa={},In={},xf;function xl(){if(xf)return In;xf=1,Object.defineProperty(In,"__esModule",{value:!0}),In.IWatch=void 0;class r{}return In.IWatch=r,In}var Mf;function Ml(){return Mf||(Mf=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),Gs.__exportStar(xl(),r)}(xa)),xa}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Gs;e.__exportStar(wl(),r),e.__exportStar(_l(),r),e.__exportStar(Ml(),r),e.__exportStar(wc(),r)})(be);class Ui{}let El=class extends Ui{constructor(e){super()}};const Ef=be.FIVE_SECONDS,un={pulse:"heartbeat_pulse"};let Sl=class _c extends El{constructor(e){super(e),this.events=new Tr.EventEmitter,this.interval=Ef,this.interval=(e==null?void 0:e.interval)||Ef}static async init(e){const t=new _c(e);return await t.init(),t}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),be.toMiliseconds(this.interval))}pulse(){this.events.emit(un.pulse)}};const Il=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Al=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Dl=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Pl(r,e){if(r==="__proto__"||r==="constructor"&&e&&typeof e=="object"&&"prototype"in e){Ol(r);return}return e}function Ol(r){console.warn(`[destr] Dropping "${r}" key to prevent prototype pollution.`)}function ds(r,e={}){if(typeof r!="string")return r;const t=r.trim();if(r[0]==='"'&&r.endsWith('"')&&!r.includes("\\"))return t.slice(1,-1);if(t.length<=9){const i=t.toLowerCase();if(i==="true")return!0;if(i==="false")return!1;if(i==="undefined")return;if(i==="null")return null;if(i==="nan")return Number.NaN;if(i==="infinity")return Number.POSITIVE_INFINITY;if(i==="-infinity")return Number.NEGATIVE_INFINITY}if(!Dl.test(r)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return r}try{if(Il.test(r)||Al.test(r)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(r,Pl)}return JSON.parse(r)}catch(i){if(e.strict)throw i;return r}}function Nl(r){return!r||typeof r.then!="function"?Promise.resolve(r):r}function xt(r,...e){try{return Nl(r(...e))}catch(t){return Promise.reject(t)}}function Rl(r){const e=typeof r;return r===null||e!=="object"&&e!=="function"}function Tl(r){const e=Object.getPrototypeOf(r);return!e||e.isPrototypeOf(Object)}function ys(r){if(Rl(r))return String(r);if(Tl(r)||Array.isArray(r))return JSON.stringify(r);if(typeof r.toJSON=="function")return ys(r.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function xc(){if(typeof Buffer>"u")throw new TypeError("[unstorage] Buffer is not supported!")}const Za="base64:";function Cl(r){if(typeof r=="string")return r;xc();const e=Buffer.from(r).toString("base64");return Za+e}function Ll(r){return typeof r!="string"||!r.startsWith(Za)?r:(xc(),Buffer.from(r.slice(Za.length),"base64"))}function zt(r){return r?r.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function $l(...r){return zt(r.join(":"))}function ps(r){return r=zt(r),r?r+":":""}const Fl="memory",ql=()=>{const r=new Map;return{name:Fl,getInstance:()=>r,hasItem(e){return r.has(e)},getItem(e){return r.get(e)??null},getItemRaw(e){return r.get(e)??null},setItem(e,t){r.set(e,t)},setItemRaw(e,t){r.set(e,t)},removeItem(e){r.delete(e)},getKeys(){return[...r.keys()]},clear(){r.clear()},dispose(){r.clear()}}};function Ul(r={}){const e={mounts:{"":r.driver||ql()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=b=>{for(const _ of e.mountpoints)if(b.startsWith(_))return{base:_,relativeKey:b.slice(_.length),driver:e.mounts[_]};return{base:"",relativeKey:b,driver:e.mounts[""]}},i=(b,_)=>e.mountpoints.filter(M=>M.startsWith(b)||_&&b.startsWith(M)).map(M=>({relativeBase:b.length>M.length?b.slice(M.length):void 0,mountpoint:M,driver:e.mounts[M]})),n=(b,_)=>{if(e.watching){_=zt(_);for(const M of e.watchListeners)M(b,_)}},s=async()=>{if(!e.watching){e.watching=!0;for(const b in e.mounts)e.unwatch[b]=await Sf(e.mounts[b],n,b)}},h=async()=>{if(e.watching){for(const b in e.unwatch)await e.unwatch[b]();e.unwatch={},e.watching=!1}},u=(b,_,M)=>{const A=new Map,I=D=>{let N=A.get(D.base);return N||(N={driver:D.driver,base:D.base,items:[]},A.set(D.base,N)),N};for(const D of b){const N=typeof D=="string",U=zt(N?D:D.key),k=N?void 0:D.value,T=N||!D.options?_:{..._,...D.options},K=t(U);I(K).items.push({key:U,value:k,relativeKey:K.relativeKey,options:T})}return Promise.all([...A.values()].map(D=>M(D))).then(D=>D.flat())},g={hasItem(b,_={}){b=zt(b);const{relativeKey:M,driver:A}=t(b);return xt(A.hasItem,M,_)},getItem(b,_={}){b=zt(b);const{relativeKey:M,driver:A}=t(b);return xt(A.getItem,M,_).then(I=>ds(I))},getItems(b,_){return u(b,_,M=>M.driver.getItems?xt(M.driver.getItems,M.items.map(A=>({key:A.relativeKey,options:A.options})),_).then(A=>A.map(I=>({key:$l(M.base,I.key),value:ds(I.value)}))):Promise.all(M.items.map(A=>xt(M.driver.getItem,A.relativeKey,A.options).then(I=>({key:A.key,value:ds(I)})))))},getItemRaw(b,_={}){b=zt(b);const{relativeKey:M,driver:A}=t(b);return A.getItemRaw?xt(A.getItemRaw,M,_):xt(A.getItem,M,_).then(I=>Ll(I))},async setItem(b,_,M={}){if(_===void 0)return g.removeItem(b);b=zt(b);const{relativeKey:A,driver:I}=t(b);I.setItem&&(await xt(I.setItem,A,ys(_),M),I.watch||n("update",b))},async setItems(b,_){await u(b,_,async M=>{if(M.driver.setItems)return xt(M.driver.setItems,M.items.map(A=>({key:A.relativeKey,value:ys(A.value),options:A.options})),_);M.driver.setItem&&await Promise.all(M.items.map(A=>xt(M.driver.setItem,A.relativeKey,ys(A.value),A.options)))})},async setItemRaw(b,_,M={}){if(_===void 0)return g.removeItem(b,M);b=zt(b);const{relativeKey:A,driver:I}=t(b);if(I.setItemRaw)await xt(I.setItemRaw,A,_,M);else if(I.setItem)await xt(I.setItem,A,Cl(_),M);else return;I.watch||n("update",b)},async removeItem(b,_={}){typeof _=="boolean"&&(_={removeMeta:_}),b=zt(b);const{relativeKey:M,driver:A}=t(b);A.removeItem&&(await xt(A.removeItem,M,_),(_.removeMeta||_.removeMata)&&await xt(A.removeItem,M+"$",_),A.watch||n("remove",b))},async getMeta(b,_={}){typeof _=="boolean"&&(_={nativeOnly:_}),b=zt(b);const{relativeKey:M,driver:A}=t(b),I=Object.create(null);if(A.getMeta&&Object.assign(I,await xt(A.getMeta,M,_)),!_.nativeOnly){const D=await xt(A.getItem,M+"$",_).then(N=>ds(N));D&&typeof D=="object"&&(typeof D.atime=="string"&&(D.atime=new Date(D.atime)),typeof D.mtime=="string"&&(D.mtime=new Date(D.mtime)),Object.assign(I,D))}return I},setMeta(b,_,M={}){return this.setItem(b+"$",_,M)},removeMeta(b,_={}){return this.removeItem(b+"$",_)},async getKeys(b,_={}){b=ps(b);const M=i(b,!0);let A=[];const I=[];for(const D of M){const N=await xt(D.driver.getKeys,D.relativeBase,_);for(const U of N){const k=D.mountpoint+zt(U);A.some(T=>k.startsWith(T))||I.push(k)}A=[D.mountpoint,...A.filter(U=>!U.startsWith(D.mountpoint))]}return b?I.filter(D=>D.startsWith(b)&&D[D.length-1]!=="$"):I.filter(D=>D[D.length-1]!=="$")},async clear(b,_={}){b=ps(b),await Promise.all(i(b,!1).map(async M=>{if(M.driver.clear)return xt(M.driver.clear,M.relativeBase,_);if(M.driver.removeItem){const A=await M.driver.getKeys(M.relativeBase||"",_);return Promise.all(A.map(I=>M.driver.removeItem(I,_)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(b=>If(b)))},async watch(b){return await s(),e.watchListeners.push(b),async()=>{e.watchListeners=e.watchListeners.filter(_=>_!==b),e.watchListeners.length===0&&await h()}},async unwatch(){e.watchListeners=[],await h()},mount(b,_){if(b=ps(b),b&&e.mounts[b])throw new Error(`already mounted at ${b}`);return b&&(e.mountpoints.push(b),e.mountpoints.sort((M,A)=>A.length-M.length)),e.mounts[b]=_,e.watching&&Promise.resolve(Sf(_,n,b)).then(M=>{e.unwatch[b]=M}).catch(console.error),g},async unmount(b,_=!0){b=ps(b),!(!b||!e.mounts[b])&&(e.watching&&b in e.unwatch&&(e.unwatch[b](),delete e.unwatch[b]),_&&await If(e.mounts[b]),e.mountpoints=e.mountpoints.filter(M=>M!==b),delete e.mounts[b])},getMount(b=""){b=zt(b)+":";const _=t(b);return{driver:_.driver,base:_.base}},getMounts(b="",_={}){return b=zt(b),i(b,_.parents).map(A=>({driver:A.driver,base:A.mountpoint}))},keys:(b,_={})=>g.getKeys(b,_),get:(b,_={})=>g.getItem(b,_),set:(b,_,M={})=>g.setItem(b,_,M),has:(b,_={})=>g.hasItem(b,_),del:(b,_={})=>g.removeItem(b,_),remove:(b,_={})=>g.removeItem(b,_)};return g}function Sf(r,e,t){return r.watch?r.watch((i,n)=>e(i,t+n)):()=>{}}async function If(r){typeof r.dispose=="function"&&await xt(r.dispose)}function zi(r){return new Promise((e,t)=>{r.oncomplete=r.onsuccess=()=>e(r.result),r.onabort=r.onerror=()=>t(r.error)})}function Mc(r,e){const t=indexedDB.open(r);t.onupgradeneeded=()=>t.result.createObjectStore(e);const i=zi(t);return(n,s)=>i.then(h=>s(h.transaction(e,n).objectStore(e)))}let Ma;function Gn(){return Ma||(Ma=Mc("keyval-store","keyval")),Ma}function Af(r,e=Gn()){return e("readonly",t=>zi(t.get(r)))}function zl(r,e,t=Gn()){return t("readwrite",i=>(i.put(e,r),zi(i.transaction)))}function Bl(r,e=Gn()){return e("readwrite",t=>(t.delete(r),zi(t.transaction)))}function kl(r=Gn()){return r("readwrite",e=>(e.clear(),zi(e.transaction)))}function Kl(r,e){return r.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},zi(r.transaction)}function jl(r=Gn()){return r("readonly",e=>{if(e.getAllKeys)return zi(e.getAllKeys());const t=[];return Kl(e,i=>t.push(i.key)).then(()=>t)})}const Hl=r=>JSON.stringify(r,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),Vl=r=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=r.replace(e,'$1"$2n"$3');return JSON.parse(t,(i,n)=>typeof n=="string"&&n.match(/^\d+n$/)?BigInt(n.substring(0,n.length-1)):n)};function sn(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return Vl(r)}catch{return r}}function Li(r){return typeof r=="string"?r:Hl(r)||""}const Gl="idb-keyval";var Wl=(r={})=>{const e=r.base&&r.base.length>0?`${r.base}:`:"",t=n=>e+n;let i;return r.dbName&&r.storeName&&(i=Mc(r.dbName,r.storeName)),{name:Gl,options:r,async hasItem(n){return!(typeof await Af(t(n),i)>"u")},async getItem(n){return await Af(t(n),i)??null},setItem(n,s){return zl(t(n),s,i)},removeItem(n){return Bl(t(n),i)},getKeys(){return jl(i)},clear(){return kl(i)}}};const Jl="WALLET_CONNECT_V2_INDEXED_DB",Yl="keyvaluestorage";let Xl=class{constructor(){this.indexedDb=Ul({driver:Wl({dbName:Jl,storeName:Yl})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,Li(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var Ea=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ws={exports:{}};(function(){let r;function e(){}r=e,r.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},r.prototype.setItem=function(t,i){this[t]=String(i)},r.prototype.removeItem=function(t){delete this[t]},r.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(i){t[i]=void 0,delete t[i]})},r.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},r.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Ea<"u"&&Ea.localStorage?ws.exports=Ea.localStorage:typeof window<"u"&&window.localStorage?ws.exports=window.localStorage:ws.exports=new e})();function Zl(r){var e;return[r[0],sn((e=r[1])!=null?e:"")]}let Ql=class{constructor(){this.localStorage=ws.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(Zl)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return sn(t)}async setItem(e,t){this.localStorage.setItem(e,Li(t))}async removeItem(e){this.localStorage.removeItem(e)}};const ed="wc_storage_version",Df=1,td=async(r,e,t)=>{const i=ed,n=await e.getItem(i);if(n&&n>=Df){t(e);return}const s=await r.getKeys();if(!s.length){t(e);return}const h=[];for(;s.length;){const u=s.shift();if(!u)continue;const g=u.toLowerCase();if(g.includes("wc@")||g.includes("walletconnect")||g.includes("wc_")||g.includes("wallet_connect")){const b=await r.getItem(u);await e.setItem(u,b),h.push(u)}}await e.setItem(i,Df),t(e),rd(r,h)},rd=async(r,e)=>{e.length&&e.forEach(async t=>{await r.removeItem(t)})};let id=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new Ql;this.storage=e;try{const t=new Xl;td(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};function nd(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}var sd=ad;function ad(r,e,t){var i=t&&t.stringify||nd,n=1;if(typeof r=="object"&&r!==null){var s=e.length+n;if(s===1)return r;var h=new Array(s);h[0]=i(r);for(var u=1;u<s;u++)h[u]=i(e[u]);return h.join(" ")}if(typeof r!="string")return r;var g=e.length;if(g===0)return r;for(var b="",_=1-n,M=-1,A=r&&r.length||0,I=0;I<A;){if(r.charCodeAt(I)===37&&I+1<A){switch(M=M>-1?M:0,r.charCodeAt(I+1)){case 100:case 102:if(_>=g||e[_]==null)break;M<I&&(b+=r.slice(M,I)),b+=Number(e[_]),M=I+2,I++;break;case 105:if(_>=g||e[_]==null)break;M<I&&(b+=r.slice(M,I)),b+=Math.floor(Number(e[_])),M=I+2,I++;break;case 79:case 111:case 106:if(_>=g||e[_]===void 0)break;M<I&&(b+=r.slice(M,I));var D=typeof e[_];if(D==="string"){b+="'"+e[_]+"'",M=I+2,I++;break}if(D==="function"){b+=e[_].name||"<anonymous>",M=I+2,I++;break}b+=i(e[_]),M=I+2,I++;break;case 115:if(_>=g)break;M<I&&(b+=r.slice(M,I)),b+=String(e[_]),M=I+2,I++;break;case 37:M<I&&(b+=r.slice(M,I)),b+="%",M=I+2,I++,_--;break}++_}++I}return M===-1?r:(M<A&&(b+=r.slice(M)),b)}const Pf=sd;var Zi=Ur;const Bn=gd().console||{},od={mapHttpRequest:vs,mapHttpResponse:vs,wrapRequestSerializer:Sa,wrapResponseSerializer:Sa,wrapErrorSerializer:Sa,req:vs,res:vs,err:ld};function fd(r,e){return Array.isArray(r)?r.filter(function(i){return i!=="!stdSerializers.err"}):r===!0?Object.keys(e):!1}function Ur(r){r=r||{},r.browser=r.browser||{};const e=r.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const t=r.browser.write||Bn;r.browser.write&&(r.browser.asObject=!0);const i=r.serializers||{},n=fd(r.browser.serialize,i);let s=r.browser.serialize;Array.isArray(r.browser.serialize)&&r.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const h=["error","fatal","warn","info","debug","trace"];typeof t=="function"&&(t.error=t.fatal=t.warn=t.info=t.debug=t.trace=t),r.enabled===!1&&(r.level="silent");const u=r.level||"info",g=Object.create(t);g.log||(g.log=kn),Object.defineProperty(g,"levelVal",{get:_}),Object.defineProperty(g,"level",{get:M,set:A});const b={transmit:e,serialize:n,asObject:r.browser.asObject,levels:h,timestamp:dd(r)};g.levels=Ur.levels,g.level=u,g.setMaxListeners=g.getMaxListeners=g.emit=g.addListener=g.on=g.prependListener=g.once=g.prependOnceListener=g.removeListener=g.removeAllListeners=g.listeners=g.listenerCount=g.eventNames=g.write=g.flush=kn,g.serializers=i,g._serialize=n,g._stdErrSerialize=s,g.child=I,e&&(g._logEvent=Qa());function _(){return this.level==="silent"?1/0:this.levels.values[this.level]}function M(){return this._level}function A(D){if(D!=="silent"&&!this.levels.values[D])throw Error("unknown level "+D);this._level=D,Ji(b,g,"error","log"),Ji(b,g,"fatal","error"),Ji(b,g,"warn","error"),Ji(b,g,"info","log"),Ji(b,g,"debug","log"),Ji(b,g,"trace","log")}function I(D,N){if(!D)throw new Error("missing bindings for child Pino");N=N||{},n&&D.serializers&&(N.serializers=D.serializers);const U=N.serializers;if(n&&U){var k=Object.assign({},i,U),T=r.browser.serialize===!0?Object.keys(k):n;delete D.serializers,Ws([D],T,k,this._stdErrSerialize)}function K(R){this._childLevel=(R._childLevel|0)+1,this.error=Yi(R,D,"error"),this.fatal=Yi(R,D,"fatal"),this.warn=Yi(R,D,"warn"),this.info=Yi(R,D,"info"),this.debug=Yi(R,D,"debug"),this.trace=Yi(R,D,"trace"),k&&(this.serializers=k,this._serialize=T),e&&(this._logEvent=Qa([].concat(R._logEvent.bindings,D)))}return K.prototype=this,new K(this)}return g}Ur.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};Ur.stdSerializers=od;Ur.stdTimeFunctions=Object.assign({},{nullTime:Ec,epochTime:Sc,unixTime:pd,isoTime:vd});function Ji(r,e,t,i){const n=Object.getPrototypeOf(e);e[t]=e.levelVal>e.levels.values[t]?kn:n[t]?n[t]:Bn[t]||Bn[i]||kn,hd(r,e,t)}function hd(r,e,t){!r.transmit&&e[t]===kn||(e[t]=function(i){return function(){const s=r.timestamp(),h=new Array(arguments.length),u=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Bn?Bn:this;for(var g=0;g<h.length;g++)h[g]=arguments[g];if(r.serialize&&!r.asObject&&Ws(h,this._serialize,this.serializers,this._stdErrSerialize),r.asObject?i.call(u,cd(this,t,h,s)):i.apply(u,h),r.transmit){const b=r.transmit.level||e.level,_=Ur.levels.values[b],M=Ur.levels.values[t];if(M<_)return;ud(this,{ts:s,methodLevel:t,methodValue:M,transmitLevel:b,transmitValue:Ur.levels.values[r.transmit.level||e.level],send:r.transmit.send,val:e.levelVal},h)}}}(e[t]))}function cd(r,e,t,i){r._serialize&&Ws(t,r._serialize,r.serializers,r._stdErrSerialize);const n=t.slice();let s=n[0];const h={};i&&(h.time=i),h.level=Ur.levels.values[e];let u=(r._childLevel|0)+1;if(u<1&&(u=1),s!==null&&typeof s=="object"){for(;u--&&typeof n[0]=="object";)Object.assign(h,n.shift());s=n.length?Pf(n.shift(),n):void 0}else typeof s=="string"&&(s=Pf(n.shift(),n));return s!==void 0&&(h.msg=s),h}function Ws(r,e,t,i){for(const n in r)if(i&&r[n]instanceof Error)r[n]=Ur.stdSerializers.err(r[n]);else if(typeof r[n]=="object"&&!Array.isArray(r[n]))for(const s in r[n])e&&e.indexOf(s)>-1&&s in t&&(r[n][s]=t[s](r[n][s]))}function Yi(r,e,t){return function(){const i=new Array(1+arguments.length);i[0]=e;for(var n=1;n<i.length;n++)i[n]=arguments[n-1];return r[t].apply(this,i)}}function ud(r,e,t){const i=e.send,n=e.ts,s=e.methodLevel,h=e.methodValue,u=e.val,g=r._logEvent.bindings;Ws(t,r._serialize||Object.keys(r.serializers),r.serializers,r._stdErrSerialize===void 0?!0:r._stdErrSerialize),r._logEvent.ts=n,r._logEvent.messages=t.filter(function(b){return g.indexOf(b)===-1}),r._logEvent.level.label=s,r._logEvent.level.value=h,i(s,r._logEvent,u),r._logEvent=Qa(g)}function Qa(r){return{ts:0,messages:[],bindings:r||[],level:{label:"",value:0}}}function ld(r){const e={type:r.constructor.name,msg:r.message,stack:r.stack};for(const t in r)e[t]===void 0&&(e[t]=r[t]);return e}function dd(r){return typeof r.timestamp=="function"?r.timestamp:r.timestamp===!1?Ec:Sc}function vs(){return{}}function Sa(r){return r}function kn(){}function Ec(){return!1}function Sc(){return Date.now()}function pd(){return Math.round(Date.now()/1e3)}function vd(){return new Date(Date.now()).toISOString()}function gd(){function r(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return r(self)||r(window)||r(this)||{}}}const Js=cn(Zi),bd={level:"info"},Wn="custom_context",Mo=1e3*1024;let md=class{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},Of=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const t=new md(e);if(t.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let t=this.head;for(;t!==null;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const t=e.value;return e=e.next,{done:!1,value:t}}}}},Ic=class{constructor(e,t=Mo){this.level=e??"error",this.levelValue=Zi.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new Of(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===Zi.levels.values.error?console.error(e):t===Zi.levels.values.warn?console.warn(e):t===Zi.levels.values.debug?console.debug(e):t===Zi.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(Li({timestamp:new Date().toISOString(),log:e}));const t=typeof e=="string"?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new Of(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const t=this.getLogArray();return t.push(Li({extraMetadata:e})),new Blob(t,{type:"application/json"})}};class yd{constructor(e,t=Mo){this.baseChunkLogger=new Ic(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const t=URL.createObjectURL(this.logsToBlob(e)),i=document.createElement("a");i.href=t,i.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(t)}}let wd=class{constructor(e,t=Mo){this.baseChunkLogger=new Ic(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var _d=Object.defineProperty,xd=Object.defineProperties,Md=Object.getOwnPropertyDescriptors,Nf=Object.getOwnPropertySymbols,Ed=Object.prototype.hasOwnProperty,Sd=Object.prototype.propertyIsEnumerable,Rf=(r,e,t)=>e in r?_d(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ds=(r,e)=>{for(var t in e||(e={}))Ed.call(e,t)&&Rf(r,t,e[t]);if(Nf)for(var t of Nf(e))Sd.call(e,t)&&Rf(r,t,e[t]);return r},Ps=(r,e)=>xd(r,Md(e));function Eo(r){return Ps(Ds({},r),{level:(r==null?void 0:r.level)||bd.level})}function Id(r,e=Wn){return r[e]||""}function Ad(r,e,t=Wn){return r[t]=e,r}function Vt(r,e=Wn){let t="";return typeof r.bindings>"u"?t=Id(r,e):t=r.bindings().context||"",t}function Dd(r,e,t=Wn){const i=Vt(r,t);return i.trim()?`${i}/${e}`:e}function Ut(r,e,t=Wn){const i=Dd(r,e,t),n=r.child({context:i});return Ad(n,i,t)}function Pd(r){var e,t;const i=new yd((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:Js(Ps(Ds({},r.opts),{level:"trace",browser:Ps(Ds({},(t=r.opts)==null?void 0:t.browser),{write:n=>i.write(n)})})),chunkLoggerController:i}}function Od(r){var e;const t=new wd((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:Js(Ps(Ds({},r.opts),{level:"trace"}),t),chunkLoggerController:t}}function Nd(r){return typeof r.loggerOverride<"u"&&typeof r.loggerOverride!="string"?{logger:r.loggerOverride,chunkLoggerController:null}:typeof window<"u"?Pd(r):Od(r)}let Rd=class extends Ui{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}},Td=class extends Ui{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}},Cd=class{constructor(e,t){this.logger=e,this.core=t}},Ld=class extends Ui{constructor(e,t){super(),this.relayer=e,this.logger=t}};class $d extends Ui{constructor(e){super()}}class Fd{constructor(e,t,i,n){this.core=e,this.logger=t,this.name=i}}class qd extends Ui{constructor(e,t){super(),this.relayer=e,this.logger=t}}let Ud=class extends Ui{constructor(e,t){super(),this.core=e,this.logger=t}},zd=class{constructor(e,t,i){this.core=e,this.logger=t,this.store=i}},Bd=class{constructor(e,t){this.projectId=e,this.logger=t}},kd=class{constructor(e,t,i){this.core=e,this.logger=t,this.telemetryEnabled=i}},Kd=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},jd=class{constructor(e){this.client=e}};var So={},bi={},Ys={},Xs={};Object.defineProperty(Xs,"__esModule",{value:!0});Xs.BrowserRandomSource=void 0;const Tf=65536;class Hd{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let i=0;i<t.length;i+=Tf)this._crypto.getRandomValues(t.subarray(i,i+Math.min(t.length-i,Tf)));return t}}Xs.BrowserRandomSource=Hd;var Zs={},cr={};Object.defineProperty(cr,"__esModule",{value:!0});function Vd(r){for(var e=0;e<r.length;e++)r[e]=0;return r}cr.wipe=Vd;Object.defineProperty(Zs,"__esModule",{value:!0});Zs.NodeRandomSource=void 0;const Gd=cr;class Wd{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof F0<"u"){const e=Vn;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(e);for(let n=0;n<i.length;n++)i[n]=t[n];return(0,Gd.wipe)(t),i}}Zs.NodeRandomSource=Wd;Object.defineProperty(Ys,"__esModule",{value:!0});Ys.SystemRandomSource=void 0;const Jd=Xs,Yd=Zs;class Xd{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Jd.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Yd.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Ys.SystemRandomSource=Xd;var Ye={},Ac={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});function e(u,g){var b=u>>>16&65535,_=u&65535,M=g>>>16&65535,A=g&65535;return _*A+(b*A+_*M<<16>>>0)|0}r.mul=Math.imul||e;function t(u,g){return u+g|0}r.add=t;function i(u,g){return u-g|0}r.sub=i;function n(u,g){return u<<g|u>>>32-g}r.rotl=n;function s(u,g){return u<<32-g|u>>>g}r.rotr=s;function h(u){return typeof u=="number"&&isFinite(u)&&Math.floor(u)===u}r.isInteger=Number.isInteger||h,r.MAX_SAFE_INTEGER=9007199254740991,r.isSafeInteger=function(u){return r.isInteger(u)&&u>=-r.MAX_SAFE_INTEGER&&u<=r.MAX_SAFE_INTEGER}})(Ac);Object.defineProperty(Ye,"__esModule",{value:!0});var Dc=Ac;function Zd(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])<<16>>16}Ye.readInt16BE=Zd;function Qd(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])>>>0}Ye.readUint16BE=Qd;function ep(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])<<16>>16}Ye.readInt16LE=ep;function tp(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])>>>0}Ye.readUint16LE=tp;function Pc(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>8,e[t+1]=r>>>0,e}Ye.writeUint16BE=Pc;Ye.writeInt16BE=Pc;function Oc(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e}Ye.writeUint16LE=Oc;Ye.writeInt16LE=Oc;function eo(r,e){return e===void 0&&(e=0),r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}Ye.readInt32BE=eo;function to(r,e){return e===void 0&&(e=0),(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}Ye.readUint32BE=to;function ro(r,e){return e===void 0&&(e=0),r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]}Ye.readInt32LE=ro;function io(r,e){return e===void 0&&(e=0),(r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e])>>>0}Ye.readUint32LE=io;function Os(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>24,e[t+1]=r>>>16,e[t+2]=r>>>8,e[t+3]=r>>>0,e}Ye.writeUint32BE=Os;Ye.writeInt32BE=Os;function Ns(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e[t+2]=r>>>16,e[t+3]=r>>>24,e}Ye.writeUint32LE=Ns;Ye.writeInt32LE=Ns;function rp(r,e){e===void 0&&(e=0);var t=eo(r,e),i=eo(r,e+4);return t*4294967296+i-(i>>31)*4294967296}Ye.readInt64BE=rp;function ip(r,e){e===void 0&&(e=0);var t=to(r,e),i=to(r,e+4);return t*4294967296+i}Ye.readUint64BE=ip;function np(r,e){e===void 0&&(e=0);var t=ro(r,e),i=ro(r,e+4);return i*4294967296+t-(t>>31)*4294967296}Ye.readInt64LE=np;function sp(r,e){e===void 0&&(e=0);var t=io(r,e),i=io(r,e+4);return i*4294967296+t}Ye.readUint64LE=sp;function Nc(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Os(r/4294967296>>>0,e,t),Os(r>>>0,e,t+4),e}Ye.writeUint64BE=Nc;Ye.writeInt64BE=Nc;function Rc(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Ns(r>>>0,e,t),Ns(r/4294967296>>>0,e,t+4),e}Ye.writeUint64LE=Rc;Ye.writeInt64LE=Rc;function ap(r,e,t){if(t===void 0&&(t=0),r%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,s=r/8+t-1;s>=t;s--)i+=e[s]*n,n*=256;return i}Ye.readUintBE=ap;function op(r,e,t){if(t===void 0&&(t=0),r%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,s=t;s<t+r/8;s++)i+=e[s]*n,n*=256;return i}Ye.readUintLE=op;function fp(r,e,t,i){if(t===void 0&&(t=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Dc.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,s=r/8+i-1;s>=i;s--)t[s]=e/n&255,n*=256;return t}Ye.writeUintBE=fp;function hp(r,e,t,i){if(t===void 0&&(t=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Dc.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,s=i;s<i+r/8;s++)t[s]=e/n&255,n*=256;return t}Ye.writeUintLE=hp;function cp(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e)}Ye.readFloat32BE=cp;function up(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e,!0)}Ye.readFloat32LE=up;function lp(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e)}Ye.readFloat64BE=lp;function dp(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e,!0)}Ye.readFloat64LE=dp;function pp(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,r),e}Ye.writeFloat32BE=pp;function vp(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,r,!0),e}Ye.writeFloat32LE=vp;function gp(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,r),e}Ye.writeFloat64BE=gp;function bp(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,r,!0),e}Ye.writeFloat64LE=bp;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.randomStringForEntropy=r.randomString=r.randomUint32=r.randomBytes=r.defaultRandomSource=void 0;const e=Ys,t=Ye,i=cr;r.defaultRandomSource=new e.SystemRandomSource;function n(b,_=r.defaultRandomSource){return _.randomBytes(b)}r.randomBytes=n;function s(b=r.defaultRandomSource){const _=n(4,b),M=(0,t.readUint32LE)(_);return(0,i.wipe)(_),M}r.randomUint32=s;const h="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function u(b,_=h,M=r.defaultRandomSource){if(_.length<2)throw new Error("randomString charset is too short");if(_.length>256)throw new Error("randomString charset is too long");let A="";const I=_.length,D=256-256%I;for(;b>0;){const N=n(Math.ceil(b*256/D),M);for(let U=0;U<N.length&&b>0;U++){const k=N[U];k<D&&(A+=_.charAt(k%I),b--)}(0,i.wipe)(N)}return A}r.randomString=u;function g(b,_=h,M=r.defaultRandomSource){const A=Math.ceil(b/(Math.log(_.length)/Math.LN2));return u(A,_,M)}r.randomStringForEntropy=g})(bi);var Tc={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=Ye,t=cr;r.DIGEST_LENGTH=64,r.BLOCK_SIZE=128;var i=function(){function u(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},u.prototype.update=function(g,b){if(b===void 0&&(b=g.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var _=0;if(this._bytesHashed+=b,this._bufferLength>0){for(;this._bufferLength<r.BLOCK_SIZE&&b>0;)this._buffer[this._bufferLength++]=g[_++],b--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(b>=this.blockSize&&(_=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,g,_,b),b%=this.blockSize);b>0;)this._buffer[this._bufferLength++]=g[_++],b--;return this},u.prototype.finish=function(g){if(!this._finished){var b=this._bytesHashed,_=this._bufferLength,M=b/536870912|0,A=b<<3,I=b%128<112?128:256;this._buffer[_]=128;for(var D=_+1;D<I-8;D++)this._buffer[D]=0;e.writeUint32BE(M,this._buffer,I-8),e.writeUint32BE(A,this._buffer,I-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,I),this._finished=!0}for(var D=0;D<this.digestLength/8;D++)e.writeUint32BE(this._stateHi[D],g,D*8),e.writeUint32BE(this._stateLo[D],g,D*8+4);return this},u.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(g){return this._stateHi.set(g.stateHi),this._stateLo.set(g.stateLo),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(g){t.wipe(g.stateHi),t.wipe(g.stateLo),g.buffer&&t.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},u}();r.SHA512=i;var n=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(u,g,b,_,M,A,I){for(var D=b[0],N=b[1],U=b[2],k=b[3],T=b[4],K=b[5],R=b[6],C=b[7],$=_[0],E=_[1],O=_[2],J=_[3],Z=_[4],P=_[5],w=_[6],c=_[7],a,o,d,v,y,m,l,p;I>=128;){for(var f=0;f<16;f++){var x=8*f+A;u[f]=e.readUint32BE(M,x),g[f]=e.readUint32BE(M,x+4)}for(var f=0;f<80;f++){var H=D,j=N,G=U,B=k,z=T,q=K,S=R,F=C,W=$,te=E,fe=O,ie=J,Ce=Z,ye=P,oe=w,ze=c;if(a=C,o=c,y=o&65535,m=o>>>16,l=a&65535,p=a>>>16,a=(T>>>14|Z<<18)^(T>>>18|Z<<14)^(Z>>>9|T<<23),o=(Z>>>14|T<<18)^(Z>>>18|T<<14)^(T>>>9|Z<<23),y+=o&65535,m+=o>>>16,l+=a&65535,p+=a>>>16,a=T&K^~T&R,o=Z&P^~Z&w,y+=o&65535,m+=o>>>16,l+=a&65535,p+=a>>>16,a=n[f*2],o=n[f*2+1],y+=o&65535,m+=o>>>16,l+=a&65535,p+=a>>>16,a=u[f%16],o=g[f%16],y+=o&65535,m+=o>>>16,l+=a&65535,p+=a>>>16,m+=y>>>16,l+=m>>>16,p+=l>>>16,d=l&65535|p<<16,v=y&65535|m<<16,a=d,o=v,y=o&65535,m=o>>>16,l=a&65535,p=a>>>16,a=(D>>>28|$<<4)^($>>>2|D<<30)^($>>>7|D<<25),o=($>>>28|D<<4)^(D>>>2|$<<30)^(D>>>7|$<<25),y+=o&65535,m+=o>>>16,l+=a&65535,p+=a>>>16,a=D&N^D&U^N&U,o=$&E^$&O^E&O,y+=o&65535,m+=o>>>16,l+=a&65535,p+=a>>>16,m+=y>>>16,l+=m>>>16,p+=l>>>16,F=l&65535|p<<16,ze=y&65535|m<<16,a=B,o=ie,y=o&65535,m=o>>>16,l=a&65535,p=a>>>16,a=d,o=v,y+=o&65535,m+=o>>>16,l+=a&65535,p+=a>>>16,m+=y>>>16,l+=m>>>16,p+=l>>>16,B=l&65535|p<<16,ie=y&65535|m<<16,N=H,U=j,k=G,T=B,K=z,R=q,C=S,D=F,E=W,O=te,J=fe,Z=ie,P=Ce,w=ye,c=oe,$=ze,f%16===15)for(var x=0;x<16;x++)a=u[x],o=g[x],y=o&65535,m=o>>>16,l=a&65535,p=a>>>16,a=u[(x+9)%16],o=g[(x+9)%16],y+=o&65535,m+=o>>>16,l+=a&65535,p+=a>>>16,d=u[(x+1)%16],v=g[(x+1)%16],a=(d>>>1|v<<31)^(d>>>8|v<<24)^d>>>7,o=(v>>>1|d<<31)^(v>>>8|d<<24)^(v>>>7|d<<25),y+=o&65535,m+=o>>>16,l+=a&65535,p+=a>>>16,d=u[(x+14)%16],v=g[(x+14)%16],a=(d>>>19|v<<13)^(v>>>29|d<<3)^d>>>6,o=(v>>>19|d<<13)^(d>>>29|v<<3)^(v>>>6|d<<26),y+=o&65535,m+=o>>>16,l+=a&65535,p+=a>>>16,m+=y>>>16,l+=m>>>16,p+=l>>>16,u[x]=l&65535|p<<16,g[x]=y&65535|m<<16}a=D,o=$,y=o&65535,m=o>>>16,l=a&65535,p=a>>>16,a=b[0],o=_[0],y+=o&65535,m+=o>>>16,l+=a&65535,p+=a>>>16,m+=y>>>16,l+=m>>>16,p+=l>>>16,b[0]=D=l&65535|p<<16,_[0]=$=y&65535|m<<16,a=N,o=E,y=o&65535,m=o>>>16,l=a&65535,p=a>>>16,a=b[1],o=_[1],y+=o&65535,m+=o>>>16,l+=a&65535,p+=a>>>16,m+=y>>>16,l+=m>>>16,p+=l>>>16,b[1]=N=l&65535|p<<16,_[1]=E=y&65535|m<<16,a=U,o=O,y=o&65535,m=o>>>16,l=a&65535,p=a>>>16,a=b[2],o=_[2],y+=o&65535,m+=o>>>16,l+=a&65535,p+=a>>>16,m+=y>>>16,l+=m>>>16,p+=l>>>16,b[2]=U=l&65535|p<<16,_[2]=O=y&65535|m<<16,a=k,o=J,y=o&65535,m=o>>>16,l=a&65535,p=a>>>16,a=b[3],o=_[3],y+=o&65535,m+=o>>>16,l+=a&65535,p+=a>>>16,m+=y>>>16,l+=m>>>16,p+=l>>>16,b[3]=k=l&65535|p<<16,_[3]=J=y&65535|m<<16,a=T,o=Z,y=o&65535,m=o>>>16,l=a&65535,p=a>>>16,a=b[4],o=_[4],y+=o&65535,m+=o>>>16,l+=a&65535,p+=a>>>16,m+=y>>>16,l+=m>>>16,p+=l>>>16,b[4]=T=l&65535|p<<16,_[4]=Z=y&65535|m<<16,a=K,o=P,y=o&65535,m=o>>>16,l=a&65535,p=a>>>16,a=b[5],o=_[5],y+=o&65535,m+=o>>>16,l+=a&65535,p+=a>>>16,m+=y>>>16,l+=m>>>16,p+=l>>>16,b[5]=K=l&65535|p<<16,_[5]=P=y&65535|m<<16,a=R,o=w,y=o&65535,m=o>>>16,l=a&65535,p=a>>>16,a=b[6],o=_[6],y+=o&65535,m+=o>>>16,l+=a&65535,p+=a>>>16,m+=y>>>16,l+=m>>>16,p+=l>>>16,b[6]=R=l&65535|p<<16,_[6]=w=y&65535|m<<16,a=C,o=c,y=o&65535,m=o>>>16,l=a&65535,p=a>>>16,a=b[7],o=_[7],y+=o&65535,m+=o>>>16,l+=a&65535,p+=a>>>16,m+=y>>>16,l+=m>>>16,p+=l>>>16,b[7]=C=l&65535|p<<16,_[7]=c=y&65535|m<<16,A+=128,I-=128}return A}function h(u){var g=new i;g.update(u);var b=g.digest();return g.clean(),b}r.hash=h})(Tc);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.convertSecretKeyToX25519=r.convertPublicKeyToX25519=r.verify=r.sign=r.extractPublicKeyFromSecretKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.SEED_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=r.SIGNATURE_LENGTH=void 0;const e=bi,t=Tc,i=cr;r.SIGNATURE_LENGTH=64,r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=64,r.SEED_LENGTH=32;function n(B){const z=new Float64Array(16);if(B)for(let q=0;q<B.length;q++)z[q]=B[q];return z}const s=new Uint8Array(32);s[0]=9;const h=n(),u=n([1]),g=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),b=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),_=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),M=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),A=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function I(B,z){for(let q=0;q<16;q++)B[q]=z[q]|0}function D(B){let z=1;for(let q=0;q<16;q++){let S=B[q]+z+65535;z=Math.floor(S/65536),B[q]=S-z*65536}B[0]+=z-1+37*(z-1)}function N(B,z,q){const S=~(q-1);for(let F=0;F<16;F++){const W=S&(B[F]^z[F]);B[F]^=W,z[F]^=W}}function U(B,z){const q=n(),S=n();for(let F=0;F<16;F++)S[F]=z[F];D(S),D(S),D(S);for(let F=0;F<2;F++){q[0]=S[0]-65517;for(let te=1;te<15;te++)q[te]=S[te]-65535-(q[te-1]>>16&1),q[te-1]&=65535;q[15]=S[15]-32767-(q[14]>>16&1);const W=q[15]>>16&1;q[14]&=65535,N(S,q,1-W)}for(let F=0;F<16;F++)B[2*F]=S[F]&255,B[2*F+1]=S[F]>>8}function k(B,z){let q=0;for(let S=0;S<32;S++)q|=B[S]^z[S];return(1&q-1>>>8)-1}function T(B,z){const q=new Uint8Array(32),S=new Uint8Array(32);return U(q,B),U(S,z),k(q,S)}function K(B){const z=new Uint8Array(32);return U(z,B),z[0]&1}function R(B,z){for(let q=0;q<16;q++)B[q]=z[2*q]+(z[2*q+1]<<8);B[15]&=32767}function C(B,z,q){for(let S=0;S<16;S++)B[S]=z[S]+q[S]}function $(B,z,q){for(let S=0;S<16;S++)B[S]=z[S]-q[S]}function E(B,z,q){let S,F,W=0,te=0,fe=0,ie=0,Ce=0,ye=0,oe=0,ze=0,ge=0,re=0,Ne=0,ce=0,ee=0,Ie=0,se=0,Y=0,Pe=0,ve=0,Q=0,Le=0,me=0,ne=0,$e=0,we=0,xe=0,Ze=0,qe=0,_e=0,tt=0,Ue=0,Ee=0,Be=q[0],Se=q[1],he=q[2],ke=q[3],De=q[4],ae=q[5],Ve=q[6],Re=q[7],de=q[8],Ge=q[9],Te=q[10],ue=q[11],Ke=q[12],Me=q[13],pe=q[14],We=q[15];S=z[0],W+=S*Be,te+=S*Se,fe+=S*he,ie+=S*ke,Ce+=S*De,ye+=S*ae,oe+=S*Ve,ze+=S*Re,ge+=S*de,re+=S*Ge,Ne+=S*Te,ce+=S*ue,ee+=S*Ke,Ie+=S*Me,se+=S*pe,Y+=S*We,S=z[1],te+=S*Be,fe+=S*Se,ie+=S*he,Ce+=S*ke,ye+=S*De,oe+=S*ae,ze+=S*Ve,ge+=S*Re,re+=S*de,Ne+=S*Ge,ce+=S*Te,ee+=S*ue,Ie+=S*Ke,se+=S*Me,Y+=S*pe,Pe+=S*We,S=z[2],fe+=S*Be,ie+=S*Se,Ce+=S*he,ye+=S*ke,oe+=S*De,ze+=S*ae,ge+=S*Ve,re+=S*Re,Ne+=S*de,ce+=S*Ge,ee+=S*Te,Ie+=S*ue,se+=S*Ke,Y+=S*Me,Pe+=S*pe,ve+=S*We,S=z[3],ie+=S*Be,Ce+=S*Se,ye+=S*he,oe+=S*ke,ze+=S*De,ge+=S*ae,re+=S*Ve,Ne+=S*Re,ce+=S*de,ee+=S*Ge,Ie+=S*Te,se+=S*ue,Y+=S*Ke,Pe+=S*Me,ve+=S*pe,Q+=S*We,S=z[4],Ce+=S*Be,ye+=S*Se,oe+=S*he,ze+=S*ke,ge+=S*De,re+=S*ae,Ne+=S*Ve,ce+=S*Re,ee+=S*de,Ie+=S*Ge,se+=S*Te,Y+=S*ue,Pe+=S*Ke,ve+=S*Me,Q+=S*pe,Le+=S*We,S=z[5],ye+=S*Be,oe+=S*Se,ze+=S*he,ge+=S*ke,re+=S*De,Ne+=S*ae,ce+=S*Ve,ee+=S*Re,Ie+=S*de,se+=S*Ge,Y+=S*Te,Pe+=S*ue,ve+=S*Ke,Q+=S*Me,Le+=S*pe,me+=S*We,S=z[6],oe+=S*Be,ze+=S*Se,ge+=S*he,re+=S*ke,Ne+=S*De,ce+=S*ae,ee+=S*Ve,Ie+=S*Re,se+=S*de,Y+=S*Ge,Pe+=S*Te,ve+=S*ue,Q+=S*Ke,Le+=S*Me,me+=S*pe,ne+=S*We,S=z[7],ze+=S*Be,ge+=S*Se,re+=S*he,Ne+=S*ke,ce+=S*De,ee+=S*ae,Ie+=S*Ve,se+=S*Re,Y+=S*de,Pe+=S*Ge,ve+=S*Te,Q+=S*ue,Le+=S*Ke,me+=S*Me,ne+=S*pe,$e+=S*We,S=z[8],ge+=S*Be,re+=S*Se,Ne+=S*he,ce+=S*ke,ee+=S*De,Ie+=S*ae,se+=S*Ve,Y+=S*Re,Pe+=S*de,ve+=S*Ge,Q+=S*Te,Le+=S*ue,me+=S*Ke,ne+=S*Me,$e+=S*pe,we+=S*We,S=z[9],re+=S*Be,Ne+=S*Se,ce+=S*he,ee+=S*ke,Ie+=S*De,se+=S*ae,Y+=S*Ve,Pe+=S*Re,ve+=S*de,Q+=S*Ge,Le+=S*Te,me+=S*ue,ne+=S*Ke,$e+=S*Me,we+=S*pe,xe+=S*We,S=z[10],Ne+=S*Be,ce+=S*Se,ee+=S*he,Ie+=S*ke,se+=S*De,Y+=S*ae,Pe+=S*Ve,ve+=S*Re,Q+=S*de,Le+=S*Ge,me+=S*Te,ne+=S*ue,$e+=S*Ke,we+=S*Me,xe+=S*pe,Ze+=S*We,S=z[11],ce+=S*Be,ee+=S*Se,Ie+=S*he,se+=S*ke,Y+=S*De,Pe+=S*ae,ve+=S*Ve,Q+=S*Re,Le+=S*de,me+=S*Ge,ne+=S*Te,$e+=S*ue,we+=S*Ke,xe+=S*Me,Ze+=S*pe,qe+=S*We,S=z[12],ee+=S*Be,Ie+=S*Se,se+=S*he,Y+=S*ke,Pe+=S*De,ve+=S*ae,Q+=S*Ve,Le+=S*Re,me+=S*de,ne+=S*Ge,$e+=S*Te,we+=S*ue,xe+=S*Ke,Ze+=S*Me,qe+=S*pe,_e+=S*We,S=z[13],Ie+=S*Be,se+=S*Se,Y+=S*he,Pe+=S*ke,ve+=S*De,Q+=S*ae,Le+=S*Ve,me+=S*Re,ne+=S*de,$e+=S*Ge,we+=S*Te,xe+=S*ue,Ze+=S*Ke,qe+=S*Me,_e+=S*pe,tt+=S*We,S=z[14],se+=S*Be,Y+=S*Se,Pe+=S*he,ve+=S*ke,Q+=S*De,Le+=S*ae,me+=S*Ve,ne+=S*Re,$e+=S*de,we+=S*Ge,xe+=S*Te,Ze+=S*ue,qe+=S*Ke,_e+=S*Me,tt+=S*pe,Ue+=S*We,S=z[15],Y+=S*Be,Pe+=S*Se,ve+=S*he,Q+=S*ke,Le+=S*De,me+=S*ae,ne+=S*Ve,$e+=S*Re,we+=S*de,xe+=S*Ge,Ze+=S*Te,qe+=S*ue,_e+=S*Ke,tt+=S*Me,Ue+=S*pe,Ee+=S*We,W+=38*Pe,te+=38*ve,fe+=38*Q,ie+=38*Le,Ce+=38*me,ye+=38*ne,oe+=38*$e,ze+=38*we,ge+=38*xe,re+=38*Ze,Ne+=38*qe,ce+=38*_e,ee+=38*tt,Ie+=38*Ue,se+=38*Ee,F=1,S=W+F+65535,F=Math.floor(S/65536),W=S-F*65536,S=te+F+65535,F=Math.floor(S/65536),te=S-F*65536,S=fe+F+65535,F=Math.floor(S/65536),fe=S-F*65536,S=ie+F+65535,F=Math.floor(S/65536),ie=S-F*65536,S=Ce+F+65535,F=Math.floor(S/65536),Ce=S-F*65536,S=ye+F+65535,F=Math.floor(S/65536),ye=S-F*65536,S=oe+F+65535,F=Math.floor(S/65536),oe=S-F*65536,S=ze+F+65535,F=Math.floor(S/65536),ze=S-F*65536,S=ge+F+65535,F=Math.floor(S/65536),ge=S-F*65536,S=re+F+65535,F=Math.floor(S/65536),re=S-F*65536,S=Ne+F+65535,F=Math.floor(S/65536),Ne=S-F*65536,S=ce+F+65535,F=Math.floor(S/65536),ce=S-F*65536,S=ee+F+65535,F=Math.floor(S/65536),ee=S-F*65536,S=Ie+F+65535,F=Math.floor(S/65536),Ie=S-F*65536,S=se+F+65535,F=Math.floor(S/65536),se=S-F*65536,S=Y+F+65535,F=Math.floor(S/65536),Y=S-F*65536,W+=F-1+37*(F-1),F=1,S=W+F+65535,F=Math.floor(S/65536),W=S-F*65536,S=te+F+65535,F=Math.floor(S/65536),te=S-F*65536,S=fe+F+65535,F=Math.floor(S/65536),fe=S-F*65536,S=ie+F+65535,F=Math.floor(S/65536),ie=S-F*65536,S=Ce+F+65535,F=Math.floor(S/65536),Ce=S-F*65536,S=ye+F+65535,F=Math.floor(S/65536),ye=S-F*65536,S=oe+F+65535,F=Math.floor(S/65536),oe=S-F*65536,S=ze+F+65535,F=Math.floor(S/65536),ze=S-F*65536,S=ge+F+65535,F=Math.floor(S/65536),ge=S-F*65536,S=re+F+65535,F=Math.floor(S/65536),re=S-F*65536,S=Ne+F+65535,F=Math.floor(S/65536),Ne=S-F*65536,S=ce+F+65535,F=Math.floor(S/65536),ce=S-F*65536,S=ee+F+65535,F=Math.floor(S/65536),ee=S-F*65536,S=Ie+F+65535,F=Math.floor(S/65536),Ie=S-F*65536,S=se+F+65535,F=Math.floor(S/65536),se=S-F*65536,S=Y+F+65535,F=Math.floor(S/65536),Y=S-F*65536,W+=F-1+37*(F-1),B[0]=W,B[1]=te,B[2]=fe,B[3]=ie,B[4]=Ce,B[5]=ye,B[6]=oe,B[7]=ze,B[8]=ge,B[9]=re,B[10]=Ne,B[11]=ce,B[12]=ee,B[13]=Ie,B[14]=se,B[15]=Y}function O(B,z){E(B,z,z)}function J(B,z){const q=n();let S;for(S=0;S<16;S++)q[S]=z[S];for(S=253;S>=0;S--)O(q,q),S!==2&&S!==4&&E(q,q,z);for(S=0;S<16;S++)B[S]=q[S]}function Z(B,z){const q=n();let S;for(S=0;S<16;S++)q[S]=z[S];for(S=250;S>=0;S--)O(q,q),S!==1&&E(q,q,z);for(S=0;S<16;S++)B[S]=q[S]}function P(B,z){const q=n(),S=n(),F=n(),W=n(),te=n(),fe=n(),ie=n(),Ce=n(),ye=n();$(q,B[1],B[0]),$(ye,z[1],z[0]),E(q,q,ye),C(S,B[0],B[1]),C(ye,z[0],z[1]),E(S,S,ye),E(F,B[3],z[3]),E(F,F,b),E(W,B[2],z[2]),C(W,W,W),$(te,S,q),$(fe,W,F),C(ie,W,F),C(Ce,S,q),E(B[0],te,fe),E(B[1],Ce,ie),E(B[2],ie,fe),E(B[3],te,Ce)}function w(B,z,q){for(let S=0;S<4;S++)N(B[S],z[S],q)}function c(B,z){const q=n(),S=n(),F=n();J(F,z[2]),E(q,z[0],F),E(S,z[1],F),U(B,S),B[31]^=K(q)<<7}function a(B,z,q){I(B[0],h),I(B[1],u),I(B[2],u),I(B[3],h);for(let S=255;S>=0;--S){const F=q[S/8|0]>>(S&7)&1;w(B,z,F),P(z,B),P(B,B),w(B,z,F)}}function o(B,z){const q=[n(),n(),n(),n()];I(q[0],_),I(q[1],M),I(q[2],u),E(q[3],_,M),a(B,q,z)}function d(B){if(B.length!==r.SEED_LENGTH)throw new Error(`ed25519: seed must be ${r.SEED_LENGTH} bytes`);const z=(0,t.hash)(B);z[0]&=248,z[31]&=127,z[31]|=64;const q=new Uint8Array(32),S=[n(),n(),n(),n()];o(S,z),c(q,S);const F=new Uint8Array(64);return F.set(B),F.set(q,32),{publicKey:q,secretKey:F}}r.generateKeyPairFromSeed=d;function v(B){const z=(0,e.randomBytes)(32,B),q=d(z);return(0,i.wipe)(z),q}r.generateKeyPair=v;function y(B){if(B.length!==r.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${r.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(B.subarray(32))}r.extractPublicKeyFromSecretKey=y;const m=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function l(B,z){let q,S,F,W;for(S=63;S>=32;--S){for(q=0,F=S-32,W=S-12;F<W;++F)z[F]+=q-16*z[S]*m[F-(S-32)],q=Math.floor((z[F]+128)/256),z[F]-=q*256;z[F]+=q,z[S]=0}for(q=0,F=0;F<32;F++)z[F]+=q-(z[31]>>4)*m[F],q=z[F]>>8,z[F]&=255;for(F=0;F<32;F++)z[F]-=q*m[F];for(S=0;S<32;S++)z[S+1]+=z[S]>>8,B[S]=z[S]&255}function p(B){const z=new Float64Array(64);for(let q=0;q<64;q++)z[q]=B[q];for(let q=0;q<64;q++)B[q]=0;l(B,z)}function f(B,z){const q=new Float64Array(64),S=[n(),n(),n(),n()],F=(0,t.hash)(B.subarray(0,32));F[0]&=248,F[31]&=127,F[31]|=64;const W=new Uint8Array(64);W.set(F.subarray(32),32);const te=new t.SHA512;te.update(W.subarray(32)),te.update(z);const fe=te.digest();te.clean(),p(fe),o(S,fe),c(W,S),te.reset(),te.update(W.subarray(0,32)),te.update(B.subarray(32)),te.update(z);const ie=te.digest();p(ie);for(let Ce=0;Ce<32;Ce++)q[Ce]=fe[Ce];for(let Ce=0;Ce<32;Ce++)for(let ye=0;ye<32;ye++)q[Ce+ye]+=ie[Ce]*F[ye];return l(W.subarray(32),q),W}r.sign=f;function x(B,z){const q=n(),S=n(),F=n(),W=n(),te=n(),fe=n(),ie=n();return I(B[2],u),R(B[1],z),O(F,B[1]),E(W,F,g),$(F,F,B[2]),C(W,B[2],W),O(te,W),O(fe,te),E(ie,fe,te),E(q,ie,F),E(q,q,W),Z(q,q),E(q,q,F),E(q,q,W),E(q,q,W),E(B[0],q,W),O(S,B[0]),E(S,S,W),T(S,F)&&E(B[0],B[0],A),O(S,B[0]),E(S,S,W),T(S,F)?-1:(K(B[0])===z[31]>>7&&$(B[0],h,B[0]),E(B[3],B[0],B[1]),0)}function H(B,z,q){const S=new Uint8Array(32),F=[n(),n(),n(),n()],W=[n(),n(),n(),n()];if(q.length!==r.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${r.SIGNATURE_LENGTH} bytes`);if(x(W,B))return!1;const te=new t.SHA512;te.update(q.subarray(0,32)),te.update(B),te.update(z);const fe=te.digest();return p(fe),a(F,W,fe),o(W,q.subarray(32)),P(F,W),c(S,F),!k(q,S)}r.verify=H;function j(B){let z=[n(),n(),n(),n()];if(x(z,B))throw new Error("Ed25519: invalid public key");let q=n(),S=n(),F=z[1];C(q,u,F),$(S,u,F),J(S,S),E(q,q,S);let W=new Uint8Array(32);return U(W,q),W}r.convertPublicKeyToX25519=j;function G(B){const z=(0,t.hash)(B.subarray(0,32));z[0]&=248,z[31]&=127,z[31]|=64;const q=new Uint8Array(z.subarray(0,32));return(0,i.wipe)(z),q}r.convertSecretKeyToX25519=G})(So);const mp="EdDSA",yp="JWT",Rs=".",Qs="base64url",Cc="utf8",Lc="utf8",wp=":",_p="did",xp="key",Cf="base58btc",Mp="z",Ep="K36",Sp=32;function Io(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function $c(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Io(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function Ip(r,e){e||(e=r.reduce((n,s)=>n+s.length,0));const t=$c(e);let i=0;for(const n of r)t.set(n,i),i+=n.length;return Io(t)}function Ap(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var n=0;n<r.length;n++){var s=r.charAt(n),h=s.charCodeAt(0);if(t[h]!==255)throw new TypeError(s+" is ambiguous");t[h]=n}var u=r.length,g=r.charAt(0),b=Math.log(u)/Math.log(256),_=Math.log(256)/Math.log(u);function M(D){if(D instanceof Uint8Array||(ArrayBuffer.isView(D)?D=new Uint8Array(D.buffer,D.byteOffset,D.byteLength):Array.isArray(D)&&(D=Uint8Array.from(D))),!(D instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(D.length===0)return"";for(var N=0,U=0,k=0,T=D.length;k!==T&&D[k]===0;)k++,N++;for(var K=(T-k)*_+1>>>0,R=new Uint8Array(K);k!==T;){for(var C=D[k],$=0,E=K-1;(C!==0||$<U)&&E!==-1;E--,$++)C+=256*R[E]>>>0,R[E]=C%u>>>0,C=C/u>>>0;if(C!==0)throw new Error("Non-zero carry");U=$,k++}for(var O=K-U;O!==K&&R[O]===0;)O++;for(var J=g.repeat(N);O<K;++O)J+=r.charAt(R[O]);return J}function A(D){if(typeof D!="string")throw new TypeError("Expected String");if(D.length===0)return new Uint8Array;var N=0;if(D[N]!==" "){for(var U=0,k=0;D[N]===g;)U++,N++;for(var T=(D.length-N)*b+1>>>0,K=new Uint8Array(T);D[N];){var R=t[D.charCodeAt(N)];if(R===255)return;for(var C=0,$=T-1;(R!==0||C<k)&&$!==-1;$--,C++)R+=u*K[$]>>>0,K[$]=R%256>>>0,R=R/256>>>0;if(R!==0)throw new Error("Non-zero carry");k=C,N++}if(D[N]!==" "){for(var E=T-k;E!==T&&K[E]===0;)E++;for(var O=new Uint8Array(U+(T-E)),J=U;E!==T;)O[J++]=K[E++];return O}}}function I(D){var N=A(D);if(N)return N;throw new Error(`Non-${e} character`)}return{encode:M,decodeUnsafe:A,decode:I}}var Dp=Ap,Pp=Dp;const Op=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},Np=r=>new TextEncoder().encode(r),Rp=r=>new TextDecoder().decode(r);class Tp{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Cp{constructor(e,t,i){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Fc(this,e)}}class Lp{constructor(e){this.decoders=e}or(e){return Fc(this,e)}decode(e){const t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Fc=(r,e)=>new Lp({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class $p{constructor(e,t,i,n){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=n,this.encoder=new Tp(e,t,i),this.decoder=new Cp(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ea=({name:r,prefix:e,encode:t,decode:i})=>new $p(r,e,t,i),Jn=({prefix:r,name:e,alphabet:t})=>{const{encode:i,decode:n}=Pp(t,e);return ea({prefix:r,name:e,encode:i,decode:s=>Op(n(s))})},Fp=(r,e,t,i)=>{const n={};for(let _=0;_<e.length;++_)n[e[_]]=_;let s=r.length;for(;r[s-1]==="=";)--s;const h=new Uint8Array(s*t/8|0);let u=0,g=0,b=0;for(let _=0;_<s;++_){const M=n[r[_]];if(M===void 0)throw new SyntaxError(`Non-${i} character`);g=g<<t|M,u+=t,u>=8&&(u-=8,h[b++]=255&g>>u)}if(u>=t||255&g<<8-u)throw new SyntaxError("Unexpected end of data");return h},qp=(r,e,t)=>{const i=e[e.length-1]==="=",n=(1<<t)-1;let s="",h=0,u=0;for(let g=0;g<r.length;++g)for(u=u<<8|r[g],h+=8;h>t;)h-=t,s+=e[n&u>>h];if(h&&(s+=e[n&u<<t-h]),i)for(;s.length*t&7;)s+="=";return s},Dt=({name:r,prefix:e,bitsPerChar:t,alphabet:i})=>ea({prefix:e,name:r,encode(n){return qp(n,i,t)},decode(n){return Fp(n,i,t,r)}}),Up=ea({prefix:"\0",name:"identity",encode:r=>Rp(r),decode:r=>Np(r)}),zp=Object.freeze(Object.defineProperty({__proto__:null,identity:Up},Symbol.toStringTag,{value:"Module"})),Bp=Dt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),kp=Object.freeze(Object.defineProperty({__proto__:null,base2:Bp},Symbol.toStringTag,{value:"Module"})),Kp=Dt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),jp=Object.freeze(Object.defineProperty({__proto__:null,base8:Kp},Symbol.toStringTag,{value:"Module"})),Hp=Jn({prefix:"9",name:"base10",alphabet:"0123456789"}),Vp=Object.freeze(Object.defineProperty({__proto__:null,base10:Hp},Symbol.toStringTag,{value:"Module"})),Gp=Dt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Wp=Dt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Jp=Object.freeze(Object.defineProperty({__proto__:null,base16:Gp,base16upper:Wp},Symbol.toStringTag,{value:"Module"})),Yp=Dt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Xp=Dt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Zp=Dt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Qp=Dt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),e1=Dt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),t1=Dt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),r1=Dt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),i1=Dt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),n1=Dt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),s1=Object.freeze(Object.defineProperty({__proto__:null,base32:Yp,base32hex:e1,base32hexpad:r1,base32hexpadupper:i1,base32hexupper:t1,base32pad:Zp,base32padupper:Qp,base32upper:Xp,base32z:n1},Symbol.toStringTag,{value:"Module"})),a1=Jn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),o1=Jn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),f1=Object.freeze(Object.defineProperty({__proto__:null,base36:a1,base36upper:o1},Symbol.toStringTag,{value:"Module"})),h1=Jn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),c1=Jn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),u1=Object.freeze(Object.defineProperty({__proto__:null,base58btc:h1,base58flickr:c1},Symbol.toStringTag,{value:"Module"})),l1=Dt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),d1=Dt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),p1=Dt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),v1=Dt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),g1=Object.freeze(Object.defineProperty({__proto__:null,base64:l1,base64pad:d1,base64url:p1,base64urlpad:v1},Symbol.toStringTag,{value:"Module"})),qc=Array.from(""),b1=qc.reduce((r,e,t)=>(r[t]=e,r),[]),m1=qc.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function y1(r){return r.reduce((e,t)=>(e+=b1[t],e),"")}function w1(r){const e=[];for(const t of r){const i=m1[t.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(i)}return new Uint8Array(e)}const _1=ea({prefix:"",name:"base256emoji",encode:y1,decode:w1}),x1=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:_1},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const Ts={...zp,...kp,...jp,...Vp,...Jp,...s1,...f1,...u1,...g1,...x1};function Uc(r,e,t,i){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:i}}}const Lf=Uc("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Ia=Uc("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=$c(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),zc={utf8:Lf,"utf-8":Lf,hex:Ts.base16,latin1:Ia,ascii:Ia,binary:Ia,...Ts};function ta(r,e="utf8"){const t=zc[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}function ln(r,e="utf8"){const t=zc[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Io(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}function $f(r){return sn(ta(ln(r,Qs),Cc))}function Cs(r){return ta(ln(Li(r),Cc),Qs)}function Bc(r){const e=ln(Ep,Cf),t=Mp+ta(Ip([e,r]),Cf);return[_p,xp,t].join(wp)}function M1(r){return ta(r,Qs)}function E1(r){return ln(r,Qs)}function S1(r){return ln([Cs(r.header),Cs(r.payload)].join(Rs),Lc)}function I1(r){return[Cs(r.header),Cs(r.payload),M1(r.signature)].join(Rs)}function no(r){const e=r.split(Rs),t=$f(e[0]),i=$f(e[1]),n=E1(e[2]),s=ln(e.slice(0,2).join(Rs),Lc);return{header:t,payload:i,signature:n,data:s}}function Ff(r=bi.randomBytes(Sp)){return So.generateKeyPairFromSeed(r)}async function A1(r,e,t,i,n=be.fromMiliseconds(Date.now())){const s={alg:mp,typ:yp},h=Bc(i.publicKey),u=n+t,g={iss:h,sub:r,aud:e,iat:n,exp:u},b=S1({header:s,payload:g}),_=So.sign(i.secretKey,b);return I1({header:s,payload:g,signature:_})}var qf=function(r,e,t){if(t||arguments.length===2)for(var i=0,n=e.length,s;i<n;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return r.concat(s||Array.prototype.slice.call(e))},D1=function(){function r(e,t,i){this.name=e,this.version=t,this.os=i,this.type="browser"}return r}(),P1=function(){function r(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return r}(),O1=function(){function r(e,t,i,n){this.name=e,this.version=t,this.os=i,this.bot=n,this.type="bot-device"}return r}(),N1=function(){function r(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return r}(),R1=function(){function r(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return r}(),T1=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,C1=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Uf=3,L1=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",T1]],zf=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function $1(r){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new R1:typeof navigator<"u"?q1(navigator.userAgent):z1()}function F1(r){return r!==""&&L1.reduce(function(e,t){var i=t[0],n=t[1];if(e)return e;var s=n.exec(r);return!!s&&[i,s]},!1)}function q1(r){var e=F1(r);if(!e)return null;var t=e[0],i=e[1];if(t==="searchbot")return new N1;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<Uf&&(n=qf(qf([],n,!0),B1(Uf-n.length),!0)):n=[];var s=n.join("."),h=U1(r),u=C1.exec(r);return u&&u[1]?new O1(t,s,h,u[1]):new D1(t,s,h)}function U1(r){for(var e=0,t=zf.length;e<t;e++){var i=zf[e],n=i[0],s=i[1],h=s.exec(r);if(h)return n}return null}function z1(){var r=typeof process<"u"&&process.version;return r?new P1(process.version.slice(1)):null}function B1(r){for(var e=[],t=0;t<r;t++)e.push("0");return e}var at={};Object.defineProperty(at,"__esModule",{value:!0});at.getLocalStorage=at.getLocalStorageOrThrow=at.getCrypto=at.getCryptoOrThrow=kc=at.getLocation=at.getLocationOrThrow=Ao=at.getNavigator=at.getNavigatorOrThrow=Yn=at.getDocument=at.getDocumentOrThrow=at.getFromWindowOrThrow=at.getFromWindow=void 0;function Bi(r){let e;return typeof window<"u"&&typeof window[r]<"u"&&(e=window[r]),e}at.getFromWindow=Bi;function dn(r){const e=Bi(r);if(!e)throw new Error(`${r} is not defined in Window`);return e}at.getFromWindowOrThrow=dn;function k1(){return dn("document")}at.getDocumentOrThrow=k1;function K1(){return Bi("document")}var Yn=at.getDocument=K1;function j1(){return dn("navigator")}at.getNavigatorOrThrow=j1;function H1(){return Bi("navigator")}var Ao=at.getNavigator=H1;function V1(){return dn("location")}at.getLocationOrThrow=V1;function G1(){return Bi("location")}var kc=at.getLocation=G1;function W1(){return dn("crypto")}at.getCryptoOrThrow=W1;function J1(){return Bi("crypto")}at.getCrypto=J1;function Y1(){return dn("localStorage")}at.getLocalStorageOrThrow=Y1;function X1(){return Bi("localStorage")}at.getLocalStorage=X1;var Do={};Object.defineProperty(Do,"__esModule",{value:!0});var Kc=Do.getWindowMetadata=void 0;const Bf=at;function Z1(){let r,e;try{r=Bf.getDocumentOrThrow(),e=Bf.getLocationOrThrow()}catch{return null}function t(){const M=r.getElementsByTagName("link"),A=[];for(let I=0;I<M.length;I++){const D=M[I],N=D.getAttribute("rel");if(N&&N.toLowerCase().indexOf("icon")>-1){const U=D.getAttribute("href");if(U)if(U.toLowerCase().indexOf("https:")===-1&&U.toLowerCase().indexOf("http:")===-1&&U.indexOf("//")!==0){let k=e.protocol+"//"+e.host;if(U.indexOf("/")===0)k+=U;else{const T=e.pathname.split("/");T.pop();const K=T.join("/");k+=K+"/"+U}A.push(k)}else if(U.indexOf("//")===0){const k=e.protocol+U;A.push(k)}else A.push(U)}}return A}function i(...M){const A=r.getElementsByTagName("meta");for(let I=0;I<A.length;I++){const D=A[I],N=["itemprop","property","name"].map(U=>D.getAttribute(U)).filter(U=>U?M.includes(U):!1);if(N.length&&N){const U=D.getAttribute("content");if(U)return U}}return""}function n(){let M=i("name","og:site_name","og:title","twitter:title");return M||(M=r.title),M}function s(){return i("description","og:description","twitter:description","keywords")}const h=n(),u=s(),g=e.origin,b=t();return{description:u,url:g,icons:b,name:h}}Kc=Do.getWindowMetadata=Z1;var Kn={},Q1=function(r,e){for(var t={},i=Object.keys(r),n=Array.isArray(e),s=0;s<i.length;s++){var h=i[s],u=r[h];(n?e.indexOf(h)!==-1:e(h,u,r))&&(t[h]=u)}return t};(function(r){const e=U0,t=z0,i=q0,n=Q1,s=T=>T==null,h=Symbol("encodeFragmentIdentifier");function u(T){switch(T.arrayFormat){case"index":return K=>(R,C)=>{const $=R.length;return C===void 0||T.skipNull&&C===null||T.skipEmptyString&&C===""?R:C===null?[...R,[_(K,T),"[",$,"]"].join("")]:[...R,[_(K,T),"[",_($,T),"]=",_(C,T)].join("")]};case"bracket":return K=>(R,C)=>C===void 0||T.skipNull&&C===null||T.skipEmptyString&&C===""?R:C===null?[...R,[_(K,T),"[]"].join("")]:[...R,[_(K,T),"[]=",_(C,T)].join("")];case"colon-list-separator":return K=>(R,C)=>C===void 0||T.skipNull&&C===null||T.skipEmptyString&&C===""?R:C===null?[...R,[_(K,T),":list="].join("")]:[...R,[_(K,T),":list=",_(C,T)].join("")];case"comma":case"separator":case"bracket-separator":{const K=T.arrayFormat==="bracket-separator"?"[]=":"=";return R=>(C,$)=>$===void 0||T.skipNull&&$===null||T.skipEmptyString&&$===""?C:($=$===null?"":$,C.length===0?[[_(R,T),K,_($,T)].join("")]:[[C,_($,T)].join(T.arrayFormatSeparator)])}default:return K=>(R,C)=>C===void 0||T.skipNull&&C===null||T.skipEmptyString&&C===""?R:C===null?[...R,_(K,T)]:[...R,[_(K,T),"=",_(C,T)].join("")]}}function g(T){let K;switch(T.arrayFormat){case"index":return(R,C,$)=>{if(K=/\[(\d*)\]$/.exec(R),R=R.replace(/\[\d*\]$/,""),!K){$[R]=C;return}$[R]===void 0&&($[R]={}),$[R][K[1]]=C};case"bracket":return(R,C,$)=>{if(K=/(\[\])$/.exec(R),R=R.replace(/\[\]$/,""),!K){$[R]=C;return}if($[R]===void 0){$[R]=[C];return}$[R]=[].concat($[R],C)};case"colon-list-separator":return(R,C,$)=>{if(K=/(:list)$/.exec(R),R=R.replace(/:list$/,""),!K){$[R]=C;return}if($[R]===void 0){$[R]=[C];return}$[R]=[].concat($[R],C)};case"comma":case"separator":return(R,C,$)=>{const E=typeof C=="string"&&C.includes(T.arrayFormatSeparator),O=typeof C=="string"&&!E&&M(C,T).includes(T.arrayFormatSeparator);C=O?M(C,T):C;const J=E||O?C.split(T.arrayFormatSeparator).map(Z=>M(Z,T)):C===null?C:M(C,T);$[R]=J};case"bracket-separator":return(R,C,$)=>{const E=/(\[\])$/.test(R);if(R=R.replace(/\[\]$/,""),!E){$[R]=C&&M(C,T);return}const O=C===null?[]:C.split(T.arrayFormatSeparator).map(J=>M(J,T));if($[R]===void 0){$[R]=O;return}$[R]=[].concat($[R],O)};default:return(R,C,$)=>{if($[R]===void 0){$[R]=C;return}$[R]=[].concat($[R],C)}}}function b(T){if(typeof T!="string"||T.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function _(T,K){return K.encode?K.strict?e(T):encodeURIComponent(T):T}function M(T,K){return K.decode?t(T):T}function A(T){return Array.isArray(T)?T.sort():typeof T=="object"?A(Object.keys(T)).sort((K,R)=>Number(K)-Number(R)).map(K=>T[K]):T}function I(T){const K=T.indexOf("#");return K!==-1&&(T=T.slice(0,K)),T}function D(T){let K="";const R=T.indexOf("#");return R!==-1&&(K=T.slice(R)),K}function N(T){T=I(T);const K=T.indexOf("?");return K===-1?"":T.slice(K+1)}function U(T,K){return K.parseNumbers&&!Number.isNaN(Number(T))&&typeof T=="string"&&T.trim()!==""?T=Number(T):K.parseBooleans&&T!==null&&(T.toLowerCase()==="true"||T.toLowerCase()==="false")&&(T=T.toLowerCase()==="true"),T}function k(T,K){K=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},K),b(K.arrayFormatSeparator);const R=g(K),C=Object.create(null);if(typeof T!="string"||(T=T.trim().replace(/^[?#&]/,""),!T))return C;for(const $ of T.split("&")){if($==="")continue;let[E,O]=i(K.decode?$.replace(/\+/g," "):$,"=");O=O===void 0?null:["comma","separator","bracket-separator"].includes(K.arrayFormat)?O:M(O,K),R(M(E,K),O,C)}for(const $ of Object.keys(C)){const E=C[$];if(typeof E=="object"&&E!==null)for(const O of Object.keys(E))E[O]=U(E[O],K);else C[$]=U(E,K)}return K.sort===!1?C:(K.sort===!0?Object.keys(C).sort():Object.keys(C).sort(K.sort)).reduce(($,E)=>{const O=C[E];return O&&typeof O=="object"&&!Array.isArray(O)?$[E]=A(O):$[E]=O,$},Object.create(null))}r.extract=N,r.parse=k,r.stringify=(T,K)=>{if(!T)return"";K=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},K),b(K.arrayFormatSeparator);const R=O=>K.skipNull&&s(T[O])||K.skipEmptyString&&T[O]==="",C=u(K),$={};for(const O of Object.keys(T))R(O)||($[O]=T[O]);const E=Object.keys($);return K.sort!==!1&&E.sort(K.sort),E.map(O=>{const J=T[O];return J===void 0?"":J===null?_(O,K):Array.isArray(J)?J.length===0&&K.arrayFormat==="bracket-separator"?_(O,K)+"[]":J.reduce(C(O),[]).join("&"):_(O,K)+"="+_(J,K)}).filter(O=>O.length>0).join("&")},r.parseUrl=(T,K)=>{K=Object.assign({decode:!0},K);const[R,C]=i(T,"#");return Object.assign({url:R.split("?")[0]||"",query:k(N(T),K)},K&&K.parseFragmentIdentifier&&C?{fragmentIdentifier:M(C,K)}:{})},r.stringifyUrl=(T,K)=>{K=Object.assign({encode:!0,strict:!0,[h]:!0},K);const R=I(T.url).split("?")[0]||"",C=r.extract(T.url),$=r.parse(C,{sort:!1}),E=Object.assign($,T.query);let O=r.stringify(E,K);O&&(O=`?${O}`);let J=D(T.url);return T.fragmentIdentifier&&(J=`#${K[h]?_(T.fragmentIdentifier,K):T.fragmentIdentifier}`),`${R}${O}${J}`},r.pick=(T,K,R)=>{R=Object.assign({parseFragmentIdentifier:!0,[h]:!1},R);const{url:C,query:$,fragmentIdentifier:E}=r.parseUrl(T,R);return r.stringifyUrl({url:C,query:n($,K),fragmentIdentifier:E},R)},r.exclude=(T,K,R)=>{const C=Array.isArray(K)?$=>!K.includes($):($,E)=>!K($,E);return r.pick(T,C,R)}})(Kn);const ev="logger/5.7.0";let kf=!1,Kf=!1;const _s={debug:1,default:2,info:2,warning:3,error:4,off:5};let jf=_s.default,Aa=null;function tv(){try{const r=[];if(["NFD","NFC","NFKD","NFKC"].forEach(e=>{try{if("test".normalize(e)!=="test")throw new Error("bad normalize")}catch{r.push(e)}}),r.length)throw new Error("missing "+r.join(", "));if("".normalize("NFD")!=="e")throw new Error("broken implementation")}catch(r){return r.message}return null}const Hf=tv();var so;(function(r){r.DEBUG="DEBUG",r.INFO="INFO",r.WARNING="WARNING",r.ERROR="ERROR",r.OFF="OFF"})(so||(so={}));var Or;(function(r){r.UNKNOWN_ERROR="UNKNOWN_ERROR",r.NOT_IMPLEMENTED="NOT_IMPLEMENTED",r.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",r.NETWORK_ERROR="NETWORK_ERROR",r.SERVER_ERROR="SERVER_ERROR",r.TIMEOUT="TIMEOUT",r.BUFFER_OVERRUN="BUFFER_OVERRUN",r.NUMERIC_FAULT="NUMERIC_FAULT",r.MISSING_NEW="MISSING_NEW",r.INVALID_ARGUMENT="INVALID_ARGUMENT",r.MISSING_ARGUMENT="MISSING_ARGUMENT",r.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",r.CALL_EXCEPTION="CALL_EXCEPTION",r.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",r.NONCE_EXPIRED="NONCE_EXPIRED",r.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",r.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",r.TRANSACTION_REPLACED="TRANSACTION_REPLACED",r.ACTION_REJECTED="ACTION_REJECTED"})(Or||(Or={}));const Vf="0123456789abcdef";class ht{constructor(e){Object.defineProperty(this,"version",{enumerable:!0,value:e,writable:!1})}_log(e,t){const i=e.toLowerCase();_s[i]==null&&this.throwArgumentError("invalid log level name","logLevel",e),!(jf>_s[i])&&console.log.apply(console,t)}debug(...e){this._log(ht.levels.DEBUG,e)}info(...e){this._log(ht.levels.INFO,e)}warn(...e){this._log(ht.levels.WARNING,e)}makeError(e,t,i){if(Kf)return this.makeError("censored error",t,{});t||(t=ht.errors.UNKNOWN_ERROR),i||(i={});const n=[];Object.keys(i).forEach(g=>{const b=i[g];try{if(b instanceof Uint8Array){let _="";for(let M=0;M<b.length;M++)_+=Vf[b[M]>>4],_+=Vf[b[M]&15];n.push(g+"=Uint8Array(0x"+_+")")}else n.push(g+"="+JSON.stringify(b))}catch{n.push(g+"="+JSON.stringify(i[g].toString()))}}),n.push(`code=${t}`),n.push(`version=${this.version}`);const s=e;let h="";switch(t){case Or.NUMERIC_FAULT:{h="NUMERIC_FAULT";const g=e;switch(g){case"overflow":case"underflow":case"division-by-zero":h+="-"+g;break;case"negative-power":case"negative-width":h+="-unsupported";break;case"unbound-bitwise-result":h+="-unbound-result";break}break}case Or.CALL_EXCEPTION:case Or.INSUFFICIENT_FUNDS:case Or.MISSING_NEW:case Or.NONCE_EXPIRED:case Or.REPLACEMENT_UNDERPRICED:case Or.TRANSACTION_REPLACED:case Or.UNPREDICTABLE_GAS_LIMIT:h=t;break}h&&(e+=" [ See: https://links.ethers.org/v5-errors-"+h+" ]"),n.length&&(e+=" ("+n.join(", ")+")");const u=new Error(e);return u.reason=s,u.code=t,Object.keys(i).forEach(function(g){u[g]=i[g]}),u}throwError(e,t,i){throw this.makeError(e,t,i)}throwArgumentError(e,t,i){return this.throwError(e,ht.errors.INVALID_ARGUMENT,{argument:t,value:i})}assert(e,t,i,n){e||this.throwError(t,i,n)}assertArgument(e,t,i,n){e||this.throwArgumentError(t,i,n)}checkNormalize(e){Hf&&this.throwError("platform missing String.prototype.normalize",ht.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:Hf})}checkSafeUint53(e,t){typeof e=="number"&&(t==null&&(t="value not safe"),(e<0||e>=9007199254740991)&&this.throwError(t,ht.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:e}),e%1&&this.throwError(t,ht.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:e}))}checkArgumentCount(e,t,i){i?i=": "+i:i="",e<t&&this.throwError("missing argument"+i,ht.errors.MISSING_ARGUMENT,{count:e,expectedCount:t}),e>t&&this.throwError("too many arguments"+i,ht.errors.UNEXPECTED_ARGUMENT,{count:e,expectedCount:t})}checkNew(e,t){(e===Object||e==null)&&this.throwError("missing new",ht.errors.MISSING_NEW,{name:t.name})}checkAbstract(e,t){e===t?this.throwError("cannot instantiate abstract class "+JSON.stringify(t.name)+" directly; use a sub-class",ht.errors.UNSUPPORTED_OPERATION,{name:e.name,operation:"new"}):(e===Object||e==null)&&this.throwError("missing new",ht.errors.MISSING_NEW,{name:t.name})}static globalLogger(){return Aa||(Aa=new ht(ev)),Aa}static setCensorship(e,t){if(!e&&t&&this.globalLogger().throwError("cannot permanently disable censorship",ht.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),kf){if(!e)return;this.globalLogger().throwError("error censorship permanent",ht.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}Kf=!!e,kf=!!t}static setLogLevel(e){const t=_s[e.toLowerCase()];if(t==null){ht.globalLogger().warn("invalid log level - "+e);return}jf=t}static from(e){return new ht(e)}}ht.errors=Or;ht.levels=so;const rv="bytes/5.7.0",pt=new ht(rv);function jc(r){return!!r.toHexString}function tn(r){return r.slice||(r.slice=function(){const e=Array.prototype.slice.call(arguments);return tn(new Uint8Array(Array.prototype.slice.apply(r,e)))}),r}function iv(r){return zr(r)&&!(r.length%2)||Po(r)}function Gf(r){return typeof r=="number"&&r==r&&r%1===0}function Po(r){if(r==null)return!1;if(r.constructor===Uint8Array)return!0;if(typeof r=="string"||!Gf(r.length)||r.length<0)return!1;for(let e=0;e<r.length;e++){const t=r[e];if(!Gf(t)||t<0||t>=256)return!1}return!0}function bt(r,e){if(e||(e={}),typeof r=="number"){pt.checkSafeUint53(r,"invalid arrayify value");const t=[];for(;r;)t.unshift(r&255),r=parseInt(String(r/256));return t.length===0&&t.push(0),tn(new Uint8Array(t))}if(e.allowMissingPrefix&&typeof r=="string"&&r.substring(0,2)!=="0x"&&(r="0x"+r),jc(r)&&(r=r.toHexString()),zr(r)){let t=r.substring(2);t.length%2&&(e.hexPad==="left"?t="0"+t:e.hexPad==="right"?t+="0":pt.throwArgumentError("hex data is odd-length","value",r));const i=[];for(let n=0;n<t.length;n+=2)i.push(parseInt(t.substring(n,n+2),16));return tn(new Uint8Array(i))}return Po(r)?tn(new Uint8Array(r)):pt.throwArgumentError("invalid arrayify value","value",r)}function nv(r){const e=r.map(n=>bt(n)),t=e.reduce((n,s)=>n+s.length,0),i=new Uint8Array(t);return e.reduce((n,s)=>(i.set(s,n),n+s.length),0),tn(i)}function sv(r,e){r=bt(r),r.length>e&&pt.throwArgumentError("value out of range","value",arguments[0]);const t=new Uint8Array(e);return t.set(r,e-r.length),tn(t)}function zr(r,e){return!(typeof r!="string"||!r.match(/^0x[0-9A-Fa-f]*$/)||e&&r.length!==2+2*e)}const Da="0123456789abcdef";function fr(r,e){if(e||(e={}),typeof r=="number"){pt.checkSafeUint53(r,"invalid hexlify value");let t="";for(;r;)t=Da[r&15]+t,r=Math.floor(r/16);return t.length?(t.length%2&&(t="0"+t),"0x"+t):"0x00"}if(typeof r=="bigint")return r=r.toString(16),r.length%2?"0x0"+r:"0x"+r;if(e.allowMissingPrefix&&typeof r=="string"&&r.substring(0,2)!=="0x"&&(r="0x"+r),jc(r))return r.toHexString();if(zr(r))return r.length%2&&(e.hexPad==="left"?r="0x0"+r.substring(2):e.hexPad==="right"?r+="0":pt.throwArgumentError("hex data is odd-length","value",r)),r.toLowerCase();if(Po(r)){let t="0x";for(let i=0;i<r.length;i++){let n=r[i];t+=Da[(n&240)>>4]+Da[n&15]}return t}return pt.throwArgumentError("invalid hexlify value","value",r)}function av(r){if(typeof r!="string")r=fr(r);else if(!zr(r)||r.length%2)return null;return(r.length-2)/2}function Wf(r,e,t){return typeof r!="string"?r=fr(r):(!zr(r)||r.length%2)&&pt.throwArgumentError("invalid hexData","value",r),e=2+2*e,"0x"+r.substring(e)}function rn(r,e){for(typeof r!="string"?r=fr(r):zr(r)||pt.throwArgumentError("invalid hex string","value",r),r.length>2*e+2&&pt.throwArgumentError("value out of range","value",arguments[1]);r.length<2*e+2;)r="0x0"+r.substring(2);return r}function Hc(r){const e={r:"0x",s:"0x",_vs:"0x",recoveryParam:0,v:0,yParityAndS:"0x",compact:"0x"};if(iv(r)){let t=bt(r);t.length===64?(e.v=27+(t[32]>>7),t[32]&=127,e.r=fr(t.slice(0,32)),e.s=fr(t.slice(32,64))):t.length===65?(e.r=fr(t.slice(0,32)),e.s=fr(t.slice(32,64)),e.v=t[64]):pt.throwArgumentError("invalid signature string","signature",r),e.v<27&&(e.v===0||e.v===1?e.v+=27:pt.throwArgumentError("signature invalid v byte","signature",r)),e.recoveryParam=1-e.v%2,e.recoveryParam&&(t[32]|=128),e._vs=fr(t.slice(32,64))}else{if(e.r=r.r,e.s=r.s,e.v=r.v,e.recoveryParam=r.recoveryParam,e._vs=r._vs,e._vs!=null){const n=sv(bt(e._vs),32);e._vs=fr(n);const s=n[0]>=128?1:0;e.recoveryParam==null?e.recoveryParam=s:e.recoveryParam!==s&&pt.throwArgumentError("signature recoveryParam mismatch _vs","signature",r),n[0]&=127;const h=fr(n);e.s==null?e.s=h:e.s!==h&&pt.throwArgumentError("signature v mismatch _vs","signature",r)}if(e.recoveryParam==null)e.v==null?pt.throwArgumentError("signature missing v and recoveryParam","signature",r):e.v===0||e.v===1?e.recoveryParam=e.v:e.recoveryParam=1-e.v%2;else if(e.v==null)e.v=27+e.recoveryParam;else{const n=e.v===0||e.v===1?e.v:1-e.v%2;e.recoveryParam!==n&&pt.throwArgumentError("signature recoveryParam mismatch v","signature",r)}e.r==null||!zr(e.r)?pt.throwArgumentError("signature missing or invalid r","signature",r):e.r=rn(e.r,32),e.s==null||!zr(e.s)?pt.throwArgumentError("signature missing or invalid s","signature",r):e.s=rn(e.s,32);const t=bt(e.s);t[0]>=128&&pt.throwArgumentError("signature s out of range","signature",r),e.recoveryParam&&(t[0]|=128);const i=fr(t);e._vs&&(zr(e._vs)||pt.throwArgumentError("signature invalid _vs","signature",r),e._vs=rn(e._vs,32)),e._vs==null?e._vs=i:e._vs!==i&&pt.throwArgumentError("signature _vs mismatch v and s","signature",r)}return e.yParityAndS=e._vs,e.compact=e.r+e.yParityAndS.substring(2),e}function Oo(r){return"0x"+B0.keccak_256(bt(r))}var No={exports:{}};No.exports;(function(r){(function(e,t){function i(c,a){if(!c)throw new Error(a||"Assertion failed")}function n(c,a){c.super_=a;var o=function(){};o.prototype=a.prototype,c.prototype=new o,c.prototype.constructor=c}function s(c,a,o){if(s.isBN(c))return c;this.negative=0,this.words=null,this.length=0,this.red=null,c!==null&&((a==="le"||a==="be")&&(o=a,a=10),this._init(c||0,a||10,o||"be"))}typeof e=="object"?e.exports=s:t.BN=s,s.BN=s,s.wordSize=26;var h;try{typeof window<"u"&&typeof window.Buffer<"u"?h=window.Buffer:h=Vn.Buffer}catch{}s.isBN=function(a){return a instanceof s?!0:a!==null&&typeof a=="object"&&a.constructor.wordSize===s.wordSize&&Array.isArray(a.words)},s.max=function(a,o){return a.cmp(o)>0?a:o},s.min=function(a,o){return a.cmp(o)<0?a:o},s.prototype._init=function(a,o,d){if(typeof a=="number")return this._initNumber(a,o,d);if(typeof a=="object")return this._initArray(a,o,d);o==="hex"&&(o=16),i(o===(o|0)&&o>=2&&o<=36),a=a.toString().replace(/\s+/g,"");var v=0;a[0]==="-"&&(v++,this.negative=1),v<a.length&&(o===16?this._parseHex(a,v,d):(this._parseBase(a,o,v),d==="le"&&this._initArray(this.toArray(),o,d)))},s.prototype._initNumber=function(a,o,d){a<0&&(this.negative=1,a=-a),a<67108864?(this.words=[a&67108863],this.length=1):a<4503599627370496?(this.words=[a&67108863,a/67108864&67108863],this.length=2):(i(a<9007199254740992),this.words=[a&67108863,a/67108864&67108863,1],this.length=3),d==="le"&&this._initArray(this.toArray(),o,d)},s.prototype._initArray=function(a,o,d){if(i(typeof a.length=="number"),a.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(a.length/3),this.words=new Array(this.length);for(var v=0;v<this.length;v++)this.words[v]=0;var y,m,l=0;if(d==="be")for(v=a.length-1,y=0;v>=0;v-=3)m=a[v]|a[v-1]<<8|a[v-2]<<16,this.words[y]|=m<<l&67108863,this.words[y+1]=m>>>26-l&67108863,l+=24,l>=26&&(l-=26,y++);else if(d==="le")for(v=0,y=0;v<a.length;v+=3)m=a[v]|a[v+1]<<8|a[v+2]<<16,this.words[y]|=m<<l&67108863,this.words[y+1]=m>>>26-l&67108863,l+=24,l>=26&&(l-=26,y++);return this._strip()};function u(c,a){var o=c.charCodeAt(a);if(o>=48&&o<=57)return o-48;if(o>=65&&o<=70)return o-55;if(o>=97&&o<=102)return o-87;i(!1,"Invalid character in "+c)}function g(c,a,o){var d=u(c,o);return o-1>=a&&(d|=u(c,o-1)<<4),d}s.prototype._parseHex=function(a,o,d){this.length=Math.ceil((a.length-o)/6),this.words=new Array(this.length);for(var v=0;v<this.length;v++)this.words[v]=0;var y=0,m=0,l;if(d==="be")for(v=a.length-1;v>=o;v-=2)l=g(a,o,v)<<y,this.words[m]|=l&67108863,y>=18?(y-=18,m+=1,this.words[m]|=l>>>26):y+=8;else{var p=a.length-o;for(v=p%2===0?o+1:o;v<a.length;v+=2)l=g(a,o,v)<<y,this.words[m]|=l&67108863,y>=18?(y-=18,m+=1,this.words[m]|=l>>>26):y+=8}this._strip()};function b(c,a,o,d){for(var v=0,y=0,m=Math.min(c.length,o),l=a;l<m;l++){var p=c.charCodeAt(l)-48;v*=d,p>=49?y=p-49+10:p>=17?y=p-17+10:y=p,i(p>=0&&y<d,"Invalid character"),v+=y}return v}s.prototype._parseBase=function(a,o,d){this.words=[0],this.length=1;for(var v=0,y=1;y<=67108863;y*=o)v++;v--,y=y/o|0;for(var m=a.length-d,l=m%v,p=Math.min(m,m-l)+d,f=0,x=d;x<p;x+=v)f=b(a,x,x+v,o),this.imuln(y),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f);if(l!==0){var H=1;for(f=b(a,x,a.length,o),x=0;x<l;x++)H*=o;this.imuln(H),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f)}this._strip()},s.prototype.copy=function(a){a.words=new Array(this.length);for(var o=0;o<this.length;o++)a.words[o]=this.words[o];a.length=this.length,a.negative=this.negative,a.red=this.red};function _(c,a){c.words=a.words,c.length=a.length,c.negative=a.negative,c.red=a.red}if(s.prototype._move=function(a){_(a,this)},s.prototype.clone=function(){var a=new s(null);return this.copy(a),a},s.prototype._expand=function(a){for(;this.length<a;)this.words[this.length++]=0;return this},s.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},s.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{s.prototype[Symbol.for("nodejs.util.inspect.custom")]=M}catch{s.prototype.inspect=M}else s.prototype.inspect=M;function M(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var A=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],I=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],D=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(a,o){a=a||10,o=o|0||1;var d;if(a===16||a==="hex"){d="";for(var v=0,y=0,m=0;m<this.length;m++){var l=this.words[m],p=((l<<v|y)&16777215).toString(16);y=l>>>24-v&16777215,v+=2,v>=26&&(v-=26,m--),y!==0||m!==this.length-1?d=A[6-p.length]+p+d:d=p+d}for(y!==0&&(d=y.toString(16)+d);d.length%o!==0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}if(a===(a|0)&&a>=2&&a<=36){var f=I[a],x=D[a];d="";var H=this.clone();for(H.negative=0;!H.isZero();){var j=H.modrn(x).toString(a);H=H.idivn(x),H.isZero()?d=j+d:d=A[f-j.length]+j+d}for(this.isZero()&&(d="0"+d);d.length%o!==0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}i(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var a=this.words[0];return this.length===2?a+=this.words[1]*67108864:this.length===3&&this.words[2]===1?a+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-a:a},s.prototype.toJSON=function(){return this.toString(16,2)},h&&(s.prototype.toBuffer=function(a,o){return this.toArrayLike(h,a,o)}),s.prototype.toArray=function(a,o){return this.toArrayLike(Array,a,o)};var N=function(a,o){return a.allocUnsafe?a.allocUnsafe(o):new a(o)};s.prototype.toArrayLike=function(a,o,d){this._strip();var v=this.byteLength(),y=d||Math.max(1,v);i(v<=y,"byte array longer than desired length"),i(y>0,"Requested array length <= 0");var m=N(a,y),l=o==="le"?"LE":"BE";return this["_toArrayLike"+l](m,v),m},s.prototype._toArrayLikeLE=function(a,o){for(var d=0,v=0,y=0,m=0;y<this.length;y++){var l=this.words[y]<<m|v;a[d++]=l&255,d<a.length&&(a[d++]=l>>8&255),d<a.length&&(a[d++]=l>>16&255),m===6?(d<a.length&&(a[d++]=l>>24&255),v=0,m=0):(v=l>>>24,m+=2)}if(d<a.length)for(a[d++]=v;d<a.length;)a[d++]=0},s.prototype._toArrayLikeBE=function(a,o){for(var d=a.length-1,v=0,y=0,m=0;y<this.length;y++){var l=this.words[y]<<m|v;a[d--]=l&255,d>=0&&(a[d--]=l>>8&255),d>=0&&(a[d--]=l>>16&255),m===6?(d>=0&&(a[d--]=l>>24&255),v=0,m=0):(v=l>>>24,m+=2)}if(d>=0)for(a[d--]=v;d>=0;)a[d--]=0},Math.clz32?s.prototype._countBits=function(a){return 32-Math.clz32(a)}:s.prototype._countBits=function(a){var o=a,d=0;return o>=4096&&(d+=13,o>>>=13),o>=64&&(d+=7,o>>>=7),o>=8&&(d+=4,o>>>=4),o>=2&&(d+=2,o>>>=2),d+o},s.prototype._zeroBits=function(a){if(a===0)return 26;var o=a,d=0;return o&8191||(d+=13,o>>>=13),o&127||(d+=7,o>>>=7),o&15||(d+=4,o>>>=4),o&3||(d+=2,o>>>=2),o&1||d++,d},s.prototype.bitLength=function(){var a=this.words[this.length-1],o=this._countBits(a);return(this.length-1)*26+o};function U(c){for(var a=new Array(c.bitLength()),o=0;o<a.length;o++){var d=o/26|0,v=o%26;a[o]=c.words[d]>>>v&1}return a}s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var a=0,o=0;o<this.length;o++){var d=this._zeroBits(this.words[o]);if(a+=d,d!==26)break}return a},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(a){return this.negative!==0?this.abs().inotn(a).iaddn(1):this.clone()},s.prototype.fromTwos=function(a){return this.testn(a-1)?this.notn(a).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return this.negative!==0},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(a){for(;this.length<a.length;)this.words[this.length++]=0;for(var o=0;o<a.length;o++)this.words[o]=this.words[o]|a.words[o];return this._strip()},s.prototype.ior=function(a){return i((this.negative|a.negative)===0),this.iuor(a)},s.prototype.or=function(a){return this.length>a.length?this.clone().ior(a):a.clone().ior(this)},s.prototype.uor=function(a){return this.length>a.length?this.clone().iuor(a):a.clone().iuor(this)},s.prototype.iuand=function(a){var o;this.length>a.length?o=a:o=this;for(var d=0;d<o.length;d++)this.words[d]=this.words[d]&a.words[d];return this.length=o.length,this._strip()},s.prototype.iand=function(a){return i((this.negative|a.negative)===0),this.iuand(a)},s.prototype.and=function(a){return this.length>a.length?this.clone().iand(a):a.clone().iand(this)},s.prototype.uand=function(a){return this.length>a.length?this.clone().iuand(a):a.clone().iuand(this)},s.prototype.iuxor=function(a){var o,d;this.length>a.length?(o=this,d=a):(o=a,d=this);for(var v=0;v<d.length;v++)this.words[v]=o.words[v]^d.words[v];if(this!==o)for(;v<o.length;v++)this.words[v]=o.words[v];return this.length=o.length,this._strip()},s.prototype.ixor=function(a){return i((this.negative|a.negative)===0),this.iuxor(a)},s.prototype.xor=function(a){return this.length>a.length?this.clone().ixor(a):a.clone().ixor(this)},s.prototype.uxor=function(a){return this.length>a.length?this.clone().iuxor(a):a.clone().iuxor(this)},s.prototype.inotn=function(a){i(typeof a=="number"&&a>=0);var o=Math.ceil(a/26)|0,d=a%26;this._expand(o),d>0&&o--;for(var v=0;v<o;v++)this.words[v]=~this.words[v]&67108863;return d>0&&(this.words[v]=~this.words[v]&67108863>>26-d),this._strip()},s.prototype.notn=function(a){return this.clone().inotn(a)},s.prototype.setn=function(a,o){i(typeof a=="number"&&a>=0);var d=a/26|0,v=a%26;return this._expand(d+1),o?this.words[d]=this.words[d]|1<<v:this.words[d]=this.words[d]&~(1<<v),this._strip()},s.prototype.iadd=function(a){var o;if(this.negative!==0&&a.negative===0)return this.negative=0,o=this.isub(a),this.negative^=1,this._normSign();if(this.negative===0&&a.negative!==0)return a.negative=0,o=this.isub(a),a.negative=1,o._normSign();var d,v;this.length>a.length?(d=this,v=a):(d=a,v=this);for(var y=0,m=0;m<v.length;m++)o=(d.words[m]|0)+(v.words[m]|0)+y,this.words[m]=o&67108863,y=o>>>26;for(;y!==0&&m<d.length;m++)o=(d.words[m]|0)+y,this.words[m]=o&67108863,y=o>>>26;if(this.length=d.length,y!==0)this.words[this.length]=y,this.length++;else if(d!==this)for(;m<d.length;m++)this.words[m]=d.words[m];return this},s.prototype.add=function(a){var o;return a.negative!==0&&this.negative===0?(a.negative=0,o=this.sub(a),a.negative^=1,o):a.negative===0&&this.negative!==0?(this.negative=0,o=a.sub(this),this.negative=1,o):this.length>a.length?this.clone().iadd(a):a.clone().iadd(this)},s.prototype.isub=function(a){if(a.negative!==0){a.negative=0;var o=this.iadd(a);return a.negative=1,o._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(a),this.negative=1,this._normSign();var d=this.cmp(a);if(d===0)return this.negative=0,this.length=1,this.words[0]=0,this;var v,y;d>0?(v=this,y=a):(v=a,y=this);for(var m=0,l=0;l<y.length;l++)o=(v.words[l]|0)-(y.words[l]|0)+m,m=o>>26,this.words[l]=o&67108863;for(;m!==0&&l<v.length;l++)o=(v.words[l]|0)+m,m=o>>26,this.words[l]=o&67108863;if(m===0&&l<v.length&&v!==this)for(;l<v.length;l++)this.words[l]=v.words[l];return this.length=Math.max(this.length,l),v!==this&&(this.negative=1),this._strip()},s.prototype.sub=function(a){return this.clone().isub(a)};function k(c,a,o){o.negative=a.negative^c.negative;var d=c.length+a.length|0;o.length=d,d=d-1|0;var v=c.words[0]|0,y=a.words[0]|0,m=v*y,l=m&67108863,p=m/67108864|0;o.words[0]=l;for(var f=1;f<d;f++){for(var x=p>>>26,H=p&67108863,j=Math.min(f,a.length-1),G=Math.max(0,f-c.length+1);G<=j;G++){var B=f-G|0;v=c.words[B]|0,y=a.words[G]|0,m=v*y+H,x+=m/67108864|0,H=m&67108863}o.words[f]=H|0,p=x|0}return p!==0?o.words[f]=p|0:o.length--,o._strip()}var T=function(a,o,d){var v=a.words,y=o.words,m=d.words,l=0,p,f,x,H=v[0]|0,j=H&8191,G=H>>>13,B=v[1]|0,z=B&8191,q=B>>>13,S=v[2]|0,F=S&8191,W=S>>>13,te=v[3]|0,fe=te&8191,ie=te>>>13,Ce=v[4]|0,ye=Ce&8191,oe=Ce>>>13,ze=v[5]|0,ge=ze&8191,re=ze>>>13,Ne=v[6]|0,ce=Ne&8191,ee=Ne>>>13,Ie=v[7]|0,se=Ie&8191,Y=Ie>>>13,Pe=v[8]|0,ve=Pe&8191,Q=Pe>>>13,Le=v[9]|0,me=Le&8191,ne=Le>>>13,$e=y[0]|0,we=$e&8191,xe=$e>>>13,Ze=y[1]|0,qe=Ze&8191,_e=Ze>>>13,tt=y[2]|0,Ue=tt&8191,Ee=tt>>>13,Be=y[3]|0,Se=Be&8191,he=Be>>>13,ke=y[4]|0,De=ke&8191,ae=ke>>>13,Ve=y[5]|0,Re=Ve&8191,de=Ve>>>13,Ge=y[6]|0,Te=Ge&8191,ue=Ge>>>13,Ke=y[7]|0,Me=Ke&8191,pe=Ke>>>13,We=y[8]|0,He=We&8191,Oe=We>>>13,rt=y[9]|0,Fe=rt&8191,je=rt>>>13;d.negative=a.negative^o.negative,d.length=19,p=Math.imul(j,we),f=Math.imul(j,xe),f=f+Math.imul(G,we)|0,x=Math.imul(G,xe);var Gt=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(Gt>>>26)|0,Gt&=67108863,p=Math.imul(z,we),f=Math.imul(z,xe),f=f+Math.imul(q,we)|0,x=Math.imul(q,xe),p=p+Math.imul(j,qe)|0,f=f+Math.imul(j,_e)|0,f=f+Math.imul(G,qe)|0,x=x+Math.imul(G,_e)|0;var Wt=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(Wt>>>26)|0,Wt&=67108863,p=Math.imul(F,we),f=Math.imul(F,xe),f=f+Math.imul(W,we)|0,x=Math.imul(W,xe),p=p+Math.imul(z,qe)|0,f=f+Math.imul(z,_e)|0,f=f+Math.imul(q,qe)|0,x=x+Math.imul(q,_e)|0,p=p+Math.imul(j,Ue)|0,f=f+Math.imul(j,Ee)|0,f=f+Math.imul(G,Ue)|0,x=x+Math.imul(G,Ee)|0;var Jt=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(Jt>>>26)|0,Jt&=67108863,p=Math.imul(fe,we),f=Math.imul(fe,xe),f=f+Math.imul(ie,we)|0,x=Math.imul(ie,xe),p=p+Math.imul(F,qe)|0,f=f+Math.imul(F,_e)|0,f=f+Math.imul(W,qe)|0,x=x+Math.imul(W,_e)|0,p=p+Math.imul(z,Ue)|0,f=f+Math.imul(z,Ee)|0,f=f+Math.imul(q,Ue)|0,x=x+Math.imul(q,Ee)|0,p=p+Math.imul(j,Se)|0,f=f+Math.imul(j,he)|0,f=f+Math.imul(G,Se)|0,x=x+Math.imul(G,he)|0;var Yt=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(Yt>>>26)|0,Yt&=67108863,p=Math.imul(ye,we),f=Math.imul(ye,xe),f=f+Math.imul(oe,we)|0,x=Math.imul(oe,xe),p=p+Math.imul(fe,qe)|0,f=f+Math.imul(fe,_e)|0,f=f+Math.imul(ie,qe)|0,x=x+Math.imul(ie,_e)|0,p=p+Math.imul(F,Ue)|0,f=f+Math.imul(F,Ee)|0,f=f+Math.imul(W,Ue)|0,x=x+Math.imul(W,Ee)|0,p=p+Math.imul(z,Se)|0,f=f+Math.imul(z,he)|0,f=f+Math.imul(q,Se)|0,x=x+Math.imul(q,he)|0,p=p+Math.imul(j,De)|0,f=f+Math.imul(j,ae)|0,f=f+Math.imul(G,De)|0,x=x+Math.imul(G,ae)|0;var mt=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(mt>>>26)|0,mt&=67108863,p=Math.imul(ge,we),f=Math.imul(ge,xe),f=f+Math.imul(re,we)|0,x=Math.imul(re,xe),p=p+Math.imul(ye,qe)|0,f=f+Math.imul(ye,_e)|0,f=f+Math.imul(oe,qe)|0,x=x+Math.imul(oe,_e)|0,p=p+Math.imul(fe,Ue)|0,f=f+Math.imul(fe,Ee)|0,f=f+Math.imul(ie,Ue)|0,x=x+Math.imul(ie,Ee)|0,p=p+Math.imul(F,Se)|0,f=f+Math.imul(F,he)|0,f=f+Math.imul(W,Se)|0,x=x+Math.imul(W,he)|0,p=p+Math.imul(z,De)|0,f=f+Math.imul(z,ae)|0,f=f+Math.imul(q,De)|0,x=x+Math.imul(q,ae)|0,p=p+Math.imul(j,Re)|0,f=f+Math.imul(j,de)|0,f=f+Math.imul(G,Re)|0,x=x+Math.imul(G,de)|0;var Xt=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(Xt>>>26)|0,Xt&=67108863,p=Math.imul(ce,we),f=Math.imul(ce,xe),f=f+Math.imul(ee,we)|0,x=Math.imul(ee,xe),p=p+Math.imul(ge,qe)|0,f=f+Math.imul(ge,_e)|0,f=f+Math.imul(re,qe)|0,x=x+Math.imul(re,_e)|0,p=p+Math.imul(ye,Ue)|0,f=f+Math.imul(ye,Ee)|0,f=f+Math.imul(oe,Ue)|0,x=x+Math.imul(oe,Ee)|0,p=p+Math.imul(fe,Se)|0,f=f+Math.imul(fe,he)|0,f=f+Math.imul(ie,Se)|0,x=x+Math.imul(ie,he)|0,p=p+Math.imul(F,De)|0,f=f+Math.imul(F,ae)|0,f=f+Math.imul(W,De)|0,x=x+Math.imul(W,ae)|0,p=p+Math.imul(z,Re)|0,f=f+Math.imul(z,de)|0,f=f+Math.imul(q,Re)|0,x=x+Math.imul(q,de)|0,p=p+Math.imul(j,Te)|0,f=f+Math.imul(j,ue)|0,f=f+Math.imul(G,Te)|0,x=x+Math.imul(G,ue)|0;var Zt=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(Zt>>>26)|0,Zt&=67108863,p=Math.imul(se,we),f=Math.imul(se,xe),f=f+Math.imul(Y,we)|0,x=Math.imul(Y,xe),p=p+Math.imul(ce,qe)|0,f=f+Math.imul(ce,_e)|0,f=f+Math.imul(ee,qe)|0,x=x+Math.imul(ee,_e)|0,p=p+Math.imul(ge,Ue)|0,f=f+Math.imul(ge,Ee)|0,f=f+Math.imul(re,Ue)|0,x=x+Math.imul(re,Ee)|0,p=p+Math.imul(ye,Se)|0,f=f+Math.imul(ye,he)|0,f=f+Math.imul(oe,Se)|0,x=x+Math.imul(oe,he)|0,p=p+Math.imul(fe,De)|0,f=f+Math.imul(fe,ae)|0,f=f+Math.imul(ie,De)|0,x=x+Math.imul(ie,ae)|0,p=p+Math.imul(F,Re)|0,f=f+Math.imul(F,de)|0,f=f+Math.imul(W,Re)|0,x=x+Math.imul(W,de)|0,p=p+Math.imul(z,Te)|0,f=f+Math.imul(z,ue)|0,f=f+Math.imul(q,Te)|0,x=x+Math.imul(q,ue)|0,p=p+Math.imul(j,Me)|0,f=f+Math.imul(j,pe)|0,f=f+Math.imul(G,Me)|0,x=x+Math.imul(G,pe)|0;var Qt=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,p=Math.imul(ve,we),f=Math.imul(ve,xe),f=f+Math.imul(Q,we)|0,x=Math.imul(Q,xe),p=p+Math.imul(se,qe)|0,f=f+Math.imul(se,_e)|0,f=f+Math.imul(Y,qe)|0,x=x+Math.imul(Y,_e)|0,p=p+Math.imul(ce,Ue)|0,f=f+Math.imul(ce,Ee)|0,f=f+Math.imul(ee,Ue)|0,x=x+Math.imul(ee,Ee)|0,p=p+Math.imul(ge,Se)|0,f=f+Math.imul(ge,he)|0,f=f+Math.imul(re,Se)|0,x=x+Math.imul(re,he)|0,p=p+Math.imul(ye,De)|0,f=f+Math.imul(ye,ae)|0,f=f+Math.imul(oe,De)|0,x=x+Math.imul(oe,ae)|0,p=p+Math.imul(fe,Re)|0,f=f+Math.imul(fe,de)|0,f=f+Math.imul(ie,Re)|0,x=x+Math.imul(ie,de)|0,p=p+Math.imul(F,Te)|0,f=f+Math.imul(F,ue)|0,f=f+Math.imul(W,Te)|0,x=x+Math.imul(W,ue)|0,p=p+Math.imul(z,Me)|0,f=f+Math.imul(z,pe)|0,f=f+Math.imul(q,Me)|0,x=x+Math.imul(q,pe)|0,p=p+Math.imul(j,He)|0,f=f+Math.imul(j,Oe)|0,f=f+Math.imul(G,He)|0,x=x+Math.imul(G,Oe)|0;var er=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(er>>>26)|0,er&=67108863,p=Math.imul(me,we),f=Math.imul(me,xe),f=f+Math.imul(ne,we)|0,x=Math.imul(ne,xe),p=p+Math.imul(ve,qe)|0,f=f+Math.imul(ve,_e)|0,f=f+Math.imul(Q,qe)|0,x=x+Math.imul(Q,_e)|0,p=p+Math.imul(se,Ue)|0,f=f+Math.imul(se,Ee)|0,f=f+Math.imul(Y,Ue)|0,x=x+Math.imul(Y,Ee)|0,p=p+Math.imul(ce,Se)|0,f=f+Math.imul(ce,he)|0,f=f+Math.imul(ee,Se)|0,x=x+Math.imul(ee,he)|0,p=p+Math.imul(ge,De)|0,f=f+Math.imul(ge,ae)|0,f=f+Math.imul(re,De)|0,x=x+Math.imul(re,ae)|0,p=p+Math.imul(ye,Re)|0,f=f+Math.imul(ye,de)|0,f=f+Math.imul(oe,Re)|0,x=x+Math.imul(oe,de)|0,p=p+Math.imul(fe,Te)|0,f=f+Math.imul(fe,ue)|0,f=f+Math.imul(ie,Te)|0,x=x+Math.imul(ie,ue)|0,p=p+Math.imul(F,Me)|0,f=f+Math.imul(F,pe)|0,f=f+Math.imul(W,Me)|0,x=x+Math.imul(W,pe)|0,p=p+Math.imul(z,He)|0,f=f+Math.imul(z,Oe)|0,f=f+Math.imul(q,He)|0,x=x+Math.imul(q,Oe)|0,p=p+Math.imul(j,Fe)|0,f=f+Math.imul(j,je)|0,f=f+Math.imul(G,Fe)|0,x=x+Math.imul(G,je)|0;var tr=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(tr>>>26)|0,tr&=67108863,p=Math.imul(me,qe),f=Math.imul(me,_e),f=f+Math.imul(ne,qe)|0,x=Math.imul(ne,_e),p=p+Math.imul(ve,Ue)|0,f=f+Math.imul(ve,Ee)|0,f=f+Math.imul(Q,Ue)|0,x=x+Math.imul(Q,Ee)|0,p=p+Math.imul(se,Se)|0,f=f+Math.imul(se,he)|0,f=f+Math.imul(Y,Se)|0,x=x+Math.imul(Y,he)|0,p=p+Math.imul(ce,De)|0,f=f+Math.imul(ce,ae)|0,f=f+Math.imul(ee,De)|0,x=x+Math.imul(ee,ae)|0,p=p+Math.imul(ge,Re)|0,f=f+Math.imul(ge,de)|0,f=f+Math.imul(re,Re)|0,x=x+Math.imul(re,de)|0,p=p+Math.imul(ye,Te)|0,f=f+Math.imul(ye,ue)|0,f=f+Math.imul(oe,Te)|0,x=x+Math.imul(oe,ue)|0,p=p+Math.imul(fe,Me)|0,f=f+Math.imul(fe,pe)|0,f=f+Math.imul(ie,Me)|0,x=x+Math.imul(ie,pe)|0,p=p+Math.imul(F,He)|0,f=f+Math.imul(F,Oe)|0,f=f+Math.imul(W,He)|0,x=x+Math.imul(W,Oe)|0,p=p+Math.imul(z,Fe)|0,f=f+Math.imul(z,je)|0,f=f+Math.imul(q,Fe)|0,x=x+Math.imul(q,je)|0;var Rt=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,p=Math.imul(me,Ue),f=Math.imul(me,Ee),f=f+Math.imul(ne,Ue)|0,x=Math.imul(ne,Ee),p=p+Math.imul(ve,Se)|0,f=f+Math.imul(ve,he)|0,f=f+Math.imul(Q,Se)|0,x=x+Math.imul(Q,he)|0,p=p+Math.imul(se,De)|0,f=f+Math.imul(se,ae)|0,f=f+Math.imul(Y,De)|0,x=x+Math.imul(Y,ae)|0,p=p+Math.imul(ce,Re)|0,f=f+Math.imul(ce,de)|0,f=f+Math.imul(ee,Re)|0,x=x+Math.imul(ee,de)|0,p=p+Math.imul(ge,Te)|0,f=f+Math.imul(ge,ue)|0,f=f+Math.imul(re,Te)|0,x=x+Math.imul(re,ue)|0,p=p+Math.imul(ye,Me)|0,f=f+Math.imul(ye,pe)|0,f=f+Math.imul(oe,Me)|0,x=x+Math.imul(oe,pe)|0,p=p+Math.imul(fe,He)|0,f=f+Math.imul(fe,Oe)|0,f=f+Math.imul(ie,He)|0,x=x+Math.imul(ie,Oe)|0,p=p+Math.imul(F,Fe)|0,f=f+Math.imul(F,je)|0,f=f+Math.imul(W,Fe)|0,x=x+Math.imul(W,je)|0;var rr=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(rr>>>26)|0,rr&=67108863,p=Math.imul(me,Se),f=Math.imul(me,he),f=f+Math.imul(ne,Se)|0,x=Math.imul(ne,he),p=p+Math.imul(ve,De)|0,f=f+Math.imul(ve,ae)|0,f=f+Math.imul(Q,De)|0,x=x+Math.imul(Q,ae)|0,p=p+Math.imul(se,Re)|0,f=f+Math.imul(se,de)|0,f=f+Math.imul(Y,Re)|0,x=x+Math.imul(Y,de)|0,p=p+Math.imul(ce,Te)|0,f=f+Math.imul(ce,ue)|0,f=f+Math.imul(ee,Te)|0,x=x+Math.imul(ee,ue)|0,p=p+Math.imul(ge,Me)|0,f=f+Math.imul(ge,pe)|0,f=f+Math.imul(re,Me)|0,x=x+Math.imul(re,pe)|0,p=p+Math.imul(ye,He)|0,f=f+Math.imul(ye,Oe)|0,f=f+Math.imul(oe,He)|0,x=x+Math.imul(oe,Oe)|0,p=p+Math.imul(fe,Fe)|0,f=f+Math.imul(fe,je)|0,f=f+Math.imul(ie,Fe)|0,x=x+Math.imul(ie,je)|0;var ir=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(ir>>>26)|0,ir&=67108863,p=Math.imul(me,De),f=Math.imul(me,ae),f=f+Math.imul(ne,De)|0,x=Math.imul(ne,ae),p=p+Math.imul(ve,Re)|0,f=f+Math.imul(ve,de)|0,f=f+Math.imul(Q,Re)|0,x=x+Math.imul(Q,de)|0,p=p+Math.imul(se,Te)|0,f=f+Math.imul(se,ue)|0,f=f+Math.imul(Y,Te)|0,x=x+Math.imul(Y,ue)|0,p=p+Math.imul(ce,Me)|0,f=f+Math.imul(ce,pe)|0,f=f+Math.imul(ee,Me)|0,x=x+Math.imul(ee,pe)|0,p=p+Math.imul(ge,He)|0,f=f+Math.imul(ge,Oe)|0,f=f+Math.imul(re,He)|0,x=x+Math.imul(re,Oe)|0,p=p+Math.imul(ye,Fe)|0,f=f+Math.imul(ye,je)|0,f=f+Math.imul(oe,Fe)|0,x=x+Math.imul(oe,je)|0;var gt=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(gt>>>26)|0,gt&=67108863,p=Math.imul(me,Re),f=Math.imul(me,de),f=f+Math.imul(ne,Re)|0,x=Math.imul(ne,de),p=p+Math.imul(ve,Te)|0,f=f+Math.imul(ve,ue)|0,f=f+Math.imul(Q,Te)|0,x=x+Math.imul(Q,ue)|0,p=p+Math.imul(se,Me)|0,f=f+Math.imul(se,pe)|0,f=f+Math.imul(Y,Me)|0,x=x+Math.imul(Y,pe)|0,p=p+Math.imul(ce,He)|0,f=f+Math.imul(ce,Oe)|0,f=f+Math.imul(ee,He)|0,x=x+Math.imul(ee,Oe)|0,p=p+Math.imul(ge,Fe)|0,f=f+Math.imul(ge,je)|0,f=f+Math.imul(re,Fe)|0,x=x+Math.imul(re,je)|0;var nr=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(nr>>>26)|0,nr&=67108863,p=Math.imul(me,Te),f=Math.imul(me,ue),f=f+Math.imul(ne,Te)|0,x=Math.imul(ne,ue),p=p+Math.imul(ve,Me)|0,f=f+Math.imul(ve,pe)|0,f=f+Math.imul(Q,Me)|0,x=x+Math.imul(Q,pe)|0,p=p+Math.imul(se,He)|0,f=f+Math.imul(se,Oe)|0,f=f+Math.imul(Y,He)|0,x=x+Math.imul(Y,Oe)|0,p=p+Math.imul(ce,Fe)|0,f=f+Math.imul(ce,je)|0,f=f+Math.imul(ee,Fe)|0,x=x+Math.imul(ee,je)|0;var sr=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(sr>>>26)|0,sr&=67108863,p=Math.imul(me,Me),f=Math.imul(me,pe),f=f+Math.imul(ne,Me)|0,x=Math.imul(ne,pe),p=p+Math.imul(ve,He)|0,f=f+Math.imul(ve,Oe)|0,f=f+Math.imul(Q,He)|0,x=x+Math.imul(Q,Oe)|0,p=p+Math.imul(se,Fe)|0,f=f+Math.imul(se,je)|0,f=f+Math.imul(Y,Fe)|0,x=x+Math.imul(Y,je)|0;var ar=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(ar>>>26)|0,ar&=67108863,p=Math.imul(me,He),f=Math.imul(me,Oe),f=f+Math.imul(ne,He)|0,x=Math.imul(ne,Oe),p=p+Math.imul(ve,Fe)|0,f=f+Math.imul(ve,je)|0,f=f+Math.imul(Q,Fe)|0,x=x+Math.imul(Q,je)|0;var Yr=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(Yr>>>26)|0,Yr&=67108863,p=Math.imul(me,Fe),f=Math.imul(me,je),f=f+Math.imul(ne,Fe)|0,x=Math.imul(ne,je);var Xr=(l+p|0)+((f&8191)<<13)|0;return l=(x+(f>>>13)|0)+(Xr>>>26)|0,Xr&=67108863,m[0]=Gt,m[1]=Wt,m[2]=Jt,m[3]=Yt,m[4]=mt,m[5]=Xt,m[6]=Zt,m[7]=Qt,m[8]=er,m[9]=tr,m[10]=Rt,m[11]=rr,m[12]=ir,m[13]=gt,m[14]=nr,m[15]=sr,m[16]=ar,m[17]=Yr,m[18]=Xr,l!==0&&(m[19]=l,d.length++),d};Math.imul||(T=k);function K(c,a,o){o.negative=a.negative^c.negative,o.length=c.length+a.length;for(var d=0,v=0,y=0;y<o.length-1;y++){var m=v;v=0;for(var l=d&67108863,p=Math.min(y,a.length-1),f=Math.max(0,y-c.length+1);f<=p;f++){var x=y-f,H=c.words[x]|0,j=a.words[f]|0,G=H*j,B=G&67108863;m=m+(G/67108864|0)|0,B=B+l|0,l=B&67108863,m=m+(B>>>26)|0,v+=m>>>26,m&=67108863}o.words[y]=l,d=m,m=v}return d!==0?o.words[y]=d:o.length--,o._strip()}function R(c,a,o){return K(c,a,o)}s.prototype.mulTo=function(a,o){var d,v=this.length+a.length;return this.length===10&&a.length===10?d=T(this,a,o):v<63?d=k(this,a,o):v<1024?d=K(this,a,o):d=R(this,a,o),d},s.prototype.mul=function(a){var o=new s(null);return o.words=new Array(this.length+a.length),this.mulTo(a,o)},s.prototype.mulf=function(a){var o=new s(null);return o.words=new Array(this.length+a.length),R(this,a,o)},s.prototype.imul=function(a){return this.clone().mulTo(a,this)},s.prototype.imuln=function(a){var o=a<0;o&&(a=-a),i(typeof a=="number"),i(a<67108864);for(var d=0,v=0;v<this.length;v++){var y=(this.words[v]|0)*a,m=(y&67108863)+(d&67108863);d>>=26,d+=y/67108864|0,d+=m>>>26,this.words[v]=m&67108863}return d!==0&&(this.words[v]=d,this.length++),o?this.ineg():this},s.prototype.muln=function(a){return this.clone().imuln(a)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(a){var o=U(a);if(o.length===0)return new s(1);for(var d=this,v=0;v<o.length&&o[v]===0;v++,d=d.sqr());if(++v<o.length)for(var y=d.sqr();v<o.length;v++,y=y.sqr())o[v]!==0&&(d=d.mul(y));return d},s.prototype.iushln=function(a){i(typeof a=="number"&&a>=0);var o=a%26,d=(a-o)/26,v=67108863>>>26-o<<26-o,y;if(o!==0){var m=0;for(y=0;y<this.length;y++){var l=this.words[y]&v,p=(this.words[y]|0)-l<<o;this.words[y]=p|m,m=l>>>26-o}m&&(this.words[y]=m,this.length++)}if(d!==0){for(y=this.length-1;y>=0;y--)this.words[y+d]=this.words[y];for(y=0;y<d;y++)this.words[y]=0;this.length+=d}return this._strip()},s.prototype.ishln=function(a){return i(this.negative===0),this.iushln(a)},s.prototype.iushrn=function(a,o,d){i(typeof a=="number"&&a>=0);var v;o?v=(o-o%26)/26:v=0;var y=a%26,m=Math.min((a-y)/26,this.length),l=67108863^67108863>>>y<<y,p=d;if(v-=m,v=Math.max(0,v),p){for(var f=0;f<m;f++)p.words[f]=this.words[f];p.length=m}if(m!==0)if(this.length>m)for(this.length-=m,f=0;f<this.length;f++)this.words[f]=this.words[f+m];else this.words[0]=0,this.length=1;var x=0;for(f=this.length-1;f>=0&&(x!==0||f>=v);f--){var H=this.words[f]|0;this.words[f]=x<<26-y|H>>>y,x=H&l}return p&&x!==0&&(p.words[p.length++]=x),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},s.prototype.ishrn=function(a,o,d){return i(this.negative===0),this.iushrn(a,o,d)},s.prototype.shln=function(a){return this.clone().ishln(a)},s.prototype.ushln=function(a){return this.clone().iushln(a)},s.prototype.shrn=function(a){return this.clone().ishrn(a)},s.prototype.ushrn=function(a){return this.clone().iushrn(a)},s.prototype.testn=function(a){i(typeof a=="number"&&a>=0);var o=a%26,d=(a-o)/26,v=1<<o;if(this.length<=d)return!1;var y=this.words[d];return!!(y&v)},s.prototype.imaskn=function(a){i(typeof a=="number"&&a>=0);var o=a%26,d=(a-o)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=d)return this;if(o!==0&&d++,this.length=Math.min(d,this.length),o!==0){var v=67108863^67108863>>>o<<o;this.words[this.length-1]&=v}return this._strip()},s.prototype.maskn=function(a){return this.clone().imaskn(a)},s.prototype.iaddn=function(a){return i(typeof a=="number"),i(a<67108864),a<0?this.isubn(-a):this.negative!==0?this.length===1&&(this.words[0]|0)<=a?(this.words[0]=a-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(a),this.negative=1,this):this._iaddn(a)},s.prototype._iaddn=function(a){this.words[0]+=a;for(var o=0;o<this.length&&this.words[o]>=67108864;o++)this.words[o]-=67108864,o===this.length-1?this.words[o+1]=1:this.words[o+1]++;return this.length=Math.max(this.length,o+1),this},s.prototype.isubn=function(a){if(i(typeof a=="number"),i(a<67108864),a<0)return this.iaddn(-a);if(this.negative!==0)return this.negative=0,this.iaddn(a),this.negative=1,this;if(this.words[0]-=a,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var o=0;o<this.length&&this.words[o]<0;o++)this.words[o]+=67108864,this.words[o+1]-=1;return this._strip()},s.prototype.addn=function(a){return this.clone().iaddn(a)},s.prototype.subn=function(a){return this.clone().isubn(a)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(a,o,d){var v=a.length+d,y;this._expand(v);var m,l=0;for(y=0;y<a.length;y++){m=(this.words[y+d]|0)+l;var p=(a.words[y]|0)*o;m-=p&67108863,l=(m>>26)-(p/67108864|0),this.words[y+d]=m&67108863}for(;y<this.length-d;y++)m=(this.words[y+d]|0)+l,l=m>>26,this.words[y+d]=m&67108863;if(l===0)return this._strip();for(i(l===-1),l=0,y=0;y<this.length;y++)m=-(this.words[y]|0)+l,l=m>>26,this.words[y]=m&67108863;return this.negative=1,this._strip()},s.prototype._wordDiv=function(a,o){var d=this.length-a.length,v=this.clone(),y=a,m=y.words[y.length-1]|0,l=this._countBits(m);d=26-l,d!==0&&(y=y.ushln(d),v.iushln(d),m=y.words[y.length-1]|0);var p=v.length-y.length,f;if(o!=="mod"){f=new s(null),f.length=p+1,f.words=new Array(f.length);for(var x=0;x<f.length;x++)f.words[x]=0}var H=v.clone()._ishlnsubmul(y,1,p);H.negative===0&&(v=H,f&&(f.words[p]=1));for(var j=p-1;j>=0;j--){var G=(v.words[y.length+j]|0)*67108864+(v.words[y.length+j-1]|0);for(G=Math.min(G/m|0,67108863),v._ishlnsubmul(y,G,j);v.negative!==0;)G--,v.negative=0,v._ishlnsubmul(y,1,j),v.isZero()||(v.negative^=1);f&&(f.words[j]=G)}return f&&f._strip(),v._strip(),o!=="div"&&d!==0&&v.iushrn(d),{div:f||null,mod:v}},s.prototype.divmod=function(a,o,d){if(i(!a.isZero()),this.isZero())return{div:new s(0),mod:new s(0)};var v,y,m;return this.negative!==0&&a.negative===0?(m=this.neg().divmod(a,o),o!=="mod"&&(v=m.div.neg()),o!=="div"&&(y=m.mod.neg(),d&&y.negative!==0&&y.iadd(a)),{div:v,mod:y}):this.negative===0&&a.negative!==0?(m=this.divmod(a.neg(),o),o!=="mod"&&(v=m.div.neg()),{div:v,mod:m.mod}):this.negative&a.negative?(m=this.neg().divmod(a.neg(),o),o!=="div"&&(y=m.mod.neg(),d&&y.negative!==0&&y.isub(a)),{div:m.div,mod:y}):a.length>this.length||this.cmp(a)<0?{div:new s(0),mod:this}:a.length===1?o==="div"?{div:this.divn(a.words[0]),mod:null}:o==="mod"?{div:null,mod:new s(this.modrn(a.words[0]))}:{div:this.divn(a.words[0]),mod:new s(this.modrn(a.words[0]))}:this._wordDiv(a,o)},s.prototype.div=function(a){return this.divmod(a,"div",!1).div},s.prototype.mod=function(a){return this.divmod(a,"mod",!1).mod},s.prototype.umod=function(a){return this.divmod(a,"mod",!0).mod},s.prototype.divRound=function(a){var o=this.divmod(a);if(o.mod.isZero())return o.div;var d=o.div.negative!==0?o.mod.isub(a):o.mod,v=a.ushrn(1),y=a.andln(1),m=d.cmp(v);return m<0||y===1&&m===0?o.div:o.div.negative!==0?o.div.isubn(1):o.div.iaddn(1)},s.prototype.modrn=function(a){var o=a<0;o&&(a=-a),i(a<=67108863);for(var d=(1<<26)%a,v=0,y=this.length-1;y>=0;y--)v=(d*v+(this.words[y]|0))%a;return o?-v:v},s.prototype.modn=function(a){return this.modrn(a)},s.prototype.idivn=function(a){var o=a<0;o&&(a=-a),i(a<=67108863);for(var d=0,v=this.length-1;v>=0;v--){var y=(this.words[v]|0)+d*67108864;this.words[v]=y/a|0,d=y%a}return this._strip(),o?this.ineg():this},s.prototype.divn=function(a){return this.clone().idivn(a)},s.prototype.egcd=function(a){i(a.negative===0),i(!a.isZero());var o=this,d=a.clone();o.negative!==0?o=o.umod(a):o=o.clone();for(var v=new s(1),y=new s(0),m=new s(0),l=new s(1),p=0;o.isEven()&&d.isEven();)o.iushrn(1),d.iushrn(1),++p;for(var f=d.clone(),x=o.clone();!o.isZero();){for(var H=0,j=1;!(o.words[0]&j)&&H<26;++H,j<<=1);if(H>0)for(o.iushrn(H);H-- >0;)(v.isOdd()||y.isOdd())&&(v.iadd(f),y.isub(x)),v.iushrn(1),y.iushrn(1);for(var G=0,B=1;!(d.words[0]&B)&&G<26;++G,B<<=1);if(G>0)for(d.iushrn(G);G-- >0;)(m.isOdd()||l.isOdd())&&(m.iadd(f),l.isub(x)),m.iushrn(1),l.iushrn(1);o.cmp(d)>=0?(o.isub(d),v.isub(m),y.isub(l)):(d.isub(o),m.isub(v),l.isub(y))}return{a:m,b:l,gcd:d.iushln(p)}},s.prototype._invmp=function(a){i(a.negative===0),i(!a.isZero());var o=this,d=a.clone();o.negative!==0?o=o.umod(a):o=o.clone();for(var v=new s(1),y=new s(0),m=d.clone();o.cmpn(1)>0&&d.cmpn(1)>0;){for(var l=0,p=1;!(o.words[0]&p)&&l<26;++l,p<<=1);if(l>0)for(o.iushrn(l);l-- >0;)v.isOdd()&&v.iadd(m),v.iushrn(1);for(var f=0,x=1;!(d.words[0]&x)&&f<26;++f,x<<=1);if(f>0)for(d.iushrn(f);f-- >0;)y.isOdd()&&y.iadd(m),y.iushrn(1);o.cmp(d)>=0?(o.isub(d),v.isub(y)):(d.isub(o),y.isub(v))}var H;return o.cmpn(1)===0?H=v:H=y,H.cmpn(0)<0&&H.iadd(a),H},s.prototype.gcd=function(a){if(this.isZero())return a.abs();if(a.isZero())return this.abs();var o=this.clone(),d=a.clone();o.negative=0,d.negative=0;for(var v=0;o.isEven()&&d.isEven();v++)o.iushrn(1),d.iushrn(1);do{for(;o.isEven();)o.iushrn(1);for(;d.isEven();)d.iushrn(1);var y=o.cmp(d);if(y<0){var m=o;o=d,d=m}else if(y===0||d.cmpn(1)===0)break;o.isub(d)}while(!0);return d.iushln(v)},s.prototype.invm=function(a){return this.egcd(a).a.umod(a)},s.prototype.isEven=function(){return(this.words[0]&1)===0},s.prototype.isOdd=function(){return(this.words[0]&1)===1},s.prototype.andln=function(a){return this.words[0]&a},s.prototype.bincn=function(a){i(typeof a=="number");var o=a%26,d=(a-o)/26,v=1<<o;if(this.length<=d)return this._expand(d+1),this.words[d]|=v,this;for(var y=v,m=d;y!==0&&m<this.length;m++){var l=this.words[m]|0;l+=y,y=l>>>26,l&=67108863,this.words[m]=l}return y!==0&&(this.words[m]=y,this.length++),this},s.prototype.isZero=function(){return this.length===1&&this.words[0]===0},s.prototype.cmpn=function(a){var o=a<0;if(this.negative!==0&&!o)return-1;if(this.negative===0&&o)return 1;this._strip();var d;if(this.length>1)d=1;else{o&&(a=-a),i(a<=67108863,"Number is too big");var v=this.words[0]|0;d=v===a?0:v<a?-1:1}return this.negative!==0?-d|0:d},s.prototype.cmp=function(a){if(this.negative!==0&&a.negative===0)return-1;if(this.negative===0&&a.negative!==0)return 1;var o=this.ucmp(a);return this.negative!==0?-o|0:o},s.prototype.ucmp=function(a){if(this.length>a.length)return 1;if(this.length<a.length)return-1;for(var o=0,d=this.length-1;d>=0;d--){var v=this.words[d]|0,y=a.words[d]|0;if(v!==y){v<y?o=-1:v>y&&(o=1);break}}return o},s.prototype.gtn=function(a){return this.cmpn(a)===1},s.prototype.gt=function(a){return this.cmp(a)===1},s.prototype.gten=function(a){return this.cmpn(a)>=0},s.prototype.gte=function(a){return this.cmp(a)>=0},s.prototype.ltn=function(a){return this.cmpn(a)===-1},s.prototype.lt=function(a){return this.cmp(a)===-1},s.prototype.lten=function(a){return this.cmpn(a)<=0},s.prototype.lte=function(a){return this.cmp(a)<=0},s.prototype.eqn=function(a){return this.cmpn(a)===0},s.prototype.eq=function(a){return this.cmp(a)===0},s.red=function(a){return new P(a)},s.prototype.toRed=function(a){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),a.convertTo(this)._forceRed(a)},s.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(a){return this.red=a,this},s.prototype.forceRed=function(a){return i(!this.red,"Already a number in reduction context"),this._forceRed(a)},s.prototype.redAdd=function(a){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,a)},s.prototype.redIAdd=function(a){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,a)},s.prototype.redSub=function(a){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,a)},s.prototype.redISub=function(a){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,a)},s.prototype.redShl=function(a){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,a)},s.prototype.redMul=function(a){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.mul(this,a)},s.prototype.redIMul=function(a){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.imul(this,a)},s.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(a){return i(this.red&&!a.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,a)};var C={k256:null,p224:null,p192:null,p25519:null};function $(c,a){this.name=c,this.p=new s(a,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}$.prototype._tmp=function(){var a=new s(null);return a.words=new Array(Math.ceil(this.n/13)),a},$.prototype.ireduce=function(a){var o=a,d;do this.split(o,this.tmp),o=this.imulK(o),o=o.iadd(this.tmp),d=o.bitLength();while(d>this.n);var v=d<this.n?-1:o.ucmp(this.p);return v===0?(o.words[0]=0,o.length=1):v>0?o.isub(this.p):o.strip!==void 0?o.strip():o._strip(),o},$.prototype.split=function(a,o){a.iushrn(this.n,0,o)},$.prototype.imulK=function(a){return a.imul(this.k)};function E(){$.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(E,$),E.prototype.split=function(a,o){for(var d=4194303,v=Math.min(a.length,9),y=0;y<v;y++)o.words[y]=a.words[y];if(o.length=v,a.length<=9){a.words[0]=0,a.length=1;return}var m=a.words[9];for(o.words[o.length++]=m&d,y=10;y<a.length;y++){var l=a.words[y]|0;a.words[y-10]=(l&d)<<4|m>>>22,m=l}m>>>=22,a.words[y-10]=m,m===0&&a.length>10?a.length-=10:a.length-=9},E.prototype.imulK=function(a){a.words[a.length]=0,a.words[a.length+1]=0,a.length+=2;for(var o=0,d=0;d<a.length;d++){var v=a.words[d]|0;o+=v*977,a.words[d]=o&67108863,o=v*64+(o/67108864|0)}return a.words[a.length-1]===0&&(a.length--,a.words[a.length-1]===0&&a.length--),a};function O(){$.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(O,$);function J(){$.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(J,$);function Z(){$.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(Z,$),Z.prototype.imulK=function(a){for(var o=0,d=0;d<a.length;d++){var v=(a.words[d]|0)*19+o,y=v&67108863;v>>>=26,a.words[d]=y,o=v}return o!==0&&(a.words[a.length++]=o),a},s._prime=function(a){if(C[a])return C[a];var o;if(a==="k256")o=new E;else if(a==="p224")o=new O;else if(a==="p192")o=new J;else if(a==="p25519")o=new Z;else throw new Error("Unknown prime "+a);return C[a]=o,o};function P(c){if(typeof c=="string"){var a=s._prime(c);this.m=a.p,this.prime=a}else i(c.gtn(1),"modulus must be greater than 1"),this.m=c,this.prime=null}P.prototype._verify1=function(a){i(a.negative===0,"red works only with positives"),i(a.red,"red works only with red numbers")},P.prototype._verify2=function(a,o){i((a.negative|o.negative)===0,"red works only with positives"),i(a.red&&a.red===o.red,"red works only with red numbers")},P.prototype.imod=function(a){return this.prime?this.prime.ireduce(a)._forceRed(this):(_(a,a.umod(this.m)._forceRed(this)),a)},P.prototype.neg=function(a){return a.isZero()?a.clone():this.m.sub(a)._forceRed(this)},P.prototype.add=function(a,o){this._verify2(a,o);var d=a.add(o);return d.cmp(this.m)>=0&&d.isub(this.m),d._forceRed(this)},P.prototype.iadd=function(a,o){this._verify2(a,o);var d=a.iadd(o);return d.cmp(this.m)>=0&&d.isub(this.m),d},P.prototype.sub=function(a,o){this._verify2(a,o);var d=a.sub(o);return d.cmpn(0)<0&&d.iadd(this.m),d._forceRed(this)},P.prototype.isub=function(a,o){this._verify2(a,o);var d=a.isub(o);return d.cmpn(0)<0&&d.iadd(this.m),d},P.prototype.shl=function(a,o){return this._verify1(a),this.imod(a.ushln(o))},P.prototype.imul=function(a,o){return this._verify2(a,o),this.imod(a.imul(o))},P.prototype.mul=function(a,o){return this._verify2(a,o),this.imod(a.mul(o))},P.prototype.isqr=function(a){return this.imul(a,a.clone())},P.prototype.sqr=function(a){return this.mul(a,a)},P.prototype.sqrt=function(a){if(a.isZero())return a.clone();var o=this.m.andln(3);if(i(o%2===1),o===3){var d=this.m.add(new s(1)).iushrn(2);return this.pow(a,d)}for(var v=this.m.subn(1),y=0;!v.isZero()&&v.andln(1)===0;)y++,v.iushrn(1);i(!v.isZero());var m=new s(1).toRed(this),l=m.redNeg(),p=this.m.subn(1).iushrn(1),f=this.m.bitLength();for(f=new s(2*f*f).toRed(this);this.pow(f,p).cmp(l)!==0;)f.redIAdd(l);for(var x=this.pow(f,v),H=this.pow(a,v.addn(1).iushrn(1)),j=this.pow(a,v),G=y;j.cmp(m)!==0;){for(var B=j,z=0;B.cmp(m)!==0;z++)B=B.redSqr();i(z<G);var q=this.pow(x,new s(1).iushln(G-z-1));H=H.redMul(q),x=q.redSqr(),j=j.redMul(x),G=z}return H},P.prototype.invm=function(a){var o=a._invmp(this.m);return o.negative!==0?(o.negative=0,this.imod(o).redNeg()):this.imod(o)},P.prototype.pow=function(a,o){if(o.isZero())return new s(1).toRed(this);if(o.cmpn(1)===0)return a.clone();var d=4,v=new Array(1<<d);v[0]=new s(1).toRed(this),v[1]=a;for(var y=2;y<v.length;y++)v[y]=this.mul(v[y-1],a);var m=v[0],l=0,p=0,f=o.bitLength()%26;for(f===0&&(f=26),y=o.length-1;y>=0;y--){for(var x=o.words[y],H=f-1;H>=0;H--){var j=x>>H&1;if(m!==v[0]&&(m=this.sqr(m)),j===0&&l===0){p=0;continue}l<<=1,l|=j,p++,!(p!==d&&(y!==0||H!==0))&&(m=this.mul(m,v[l]),p=0,l=0)}f=26}return m},P.prototype.convertTo=function(a){var o=a.umod(this.m);return o===a?o.clone():o},P.prototype.convertFrom=function(a){var o=a.clone();return o.red=null,o},s.mont=function(a){return new w(a)};function w(c){P.call(this,c),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(w,P),w.prototype.convertTo=function(a){return this.imod(a.ushln(this.shift))},w.prototype.convertFrom=function(a){var o=this.imod(a.mul(this.rinv));return o.red=null,o},w.prototype.imul=function(a,o){if(a.isZero()||o.isZero())return a.words[0]=0,a.length=1,a;var d=a.imul(o),v=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),y=d.isub(v).iushrn(this.shift),m=y;return y.cmp(this.m)>=0?m=y.isub(this.m):y.cmpn(0)<0&&(m=y.iadd(this.m)),m._forceRed(this)},w.prototype.mul=function(a,o){if(a.isZero()||o.isZero())return new s(0)._forceRed(this);var d=a.mul(o),v=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),y=d.isub(v).iushrn(this.shift),m=y;return y.cmp(this.m)>=0?m=y.isub(this.m):y.cmpn(0)<0&&(m=y.iadd(this.m)),m._forceRed(this)},w.prototype.invm=function(a){var o=this.imod(a._invmp(this.m).mul(this.r2));return o._forceRed(this)}})(r,Oi)})(No);var ov=No.exports;const fv=cn(ov);var hv=fv.BN;function cv(r){return new hv(r,36).toString(16)}const uv="strings/5.7.0",lv=new ht(uv);var Ls;(function(r){r.current="",r.NFC="NFC",r.NFD="NFD",r.NFKC="NFKC",r.NFKD="NFKD"})(Ls||(Ls={}));var Jf;(function(r){r.UNEXPECTED_CONTINUE="unexpected continuation byte",r.BAD_PREFIX="bad codepoint prefix",r.OVERRUN="string overrun",r.MISSING_CONTINUE="missing continuation byte",r.OUT_OF_RANGE="out of UTF-8 range",r.UTF16_SURROGATE="UTF-16 surrogate",r.OVERLONG="overlong representation"})(Jf||(Jf={}));function Pa(r,e=Ls.current){e!=Ls.current&&(lv.checkNormalize(),r=r.normalize(e));let t=[];for(let i=0;i<r.length;i++){const n=r.charCodeAt(i);if(n<128)t.push(n);else if(n<2048)t.push(n>>6|192),t.push(n&63|128);else if((n&64512)==55296){i++;const s=r.charCodeAt(i);if(i>=r.length||(s&64512)!==56320)throw new Error("invalid utf-8 string");const h=65536+((n&1023)<<10)+(s&1023);t.push(h>>18|240),t.push(h>>12&63|128),t.push(h>>6&63|128),t.push(h&63|128)}else t.push(n>>12|224),t.push(n>>6&63|128),t.push(n&63|128)}return bt(t)}const dv=`Ethereum Signed Message:
`;function Vc(r){return typeof r=="string"&&(r=Pa(r)),Oo(nv([Pa(dv),Pa(String(r.length)),r]))}const pv="address/5.7.0",$n=new ht(pv);function Yf(r){zr(r,20)||$n.throwArgumentError("invalid address","address",r),r=r.toLowerCase();const e=r.substring(2).split(""),t=new Uint8Array(40);for(let n=0;n<40;n++)t[n]=e[n].charCodeAt(0);const i=bt(Oo(t));for(let n=0;n<40;n+=2)i[n>>1]>>4>=8&&(e[n]=e[n].toUpperCase()),(i[n>>1]&15)>=8&&(e[n+1]=e[n+1].toUpperCase());return"0x"+e.join("")}const vv=9007199254740991;function gv(r){return Math.log10?Math.log10(r):Math.log(r)/Math.LN10}const Ro={};for(let r=0;r<10;r++)Ro[String(r)]=String(r);for(let r=0;r<26;r++)Ro[String.fromCharCode(65+r)]=String(10+r);const Xf=Math.floor(gv(vv));function bv(r){r=r.toUpperCase(),r=r.substring(4)+r.substring(0,2)+"00";let e=r.split("").map(i=>Ro[i]).join("");for(;e.length>=Xf;){let i=e.substring(0,Xf);e=parseInt(i,10)%97+e.substring(i.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}function mv(r){let e=null;if(typeof r!="string"&&$n.throwArgumentError("invalid address","address",r),r.match(/^(0x)?[0-9a-fA-F]{40}$/))r.substring(0,2)!=="0x"&&(r="0x"+r),e=Yf(r),r.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&e!==r&&$n.throwArgumentError("bad address checksum","address",r);else if(r.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){for(r.substring(2,4)!==bv(r)&&$n.throwArgumentError("bad icap checksum","address",r),e=cv(r.substring(4));e.length<40;)e="0"+e;e=Yf("0x"+e)}else $n.throwArgumentError("invalid address","address",r);return e}function An(r,e,t){Object.defineProperty(r,e,{enumerable:!0,value:t,writable:!1})}var To={exports:{}};To.exports;(function(r){(function(e,t){function i(c,a){if(!c)throw new Error(a||"Assertion failed")}function n(c,a){c.super_=a;var o=function(){};o.prototype=a.prototype,c.prototype=new o,c.prototype.constructor=c}function s(c,a,o){if(s.isBN(c))return c;this.negative=0,this.words=null,this.length=0,this.red=null,c!==null&&((a==="le"||a==="be")&&(o=a,a=10),this._init(c||0,a||10,o||"be"))}typeof e=="object"?e.exports=s:t.BN=s,s.BN=s,s.wordSize=26;var h;try{typeof window<"u"&&typeof window.Buffer<"u"?h=window.Buffer:h=Vn.Buffer}catch{}s.isBN=function(a){return a instanceof s?!0:a!==null&&typeof a=="object"&&a.constructor.wordSize===s.wordSize&&Array.isArray(a.words)},s.max=function(a,o){return a.cmp(o)>0?a:o},s.min=function(a,o){return a.cmp(o)<0?a:o},s.prototype._init=function(a,o,d){if(typeof a=="number")return this._initNumber(a,o,d);if(typeof a=="object")return this._initArray(a,o,d);o==="hex"&&(o=16),i(o===(o|0)&&o>=2&&o<=36),a=a.toString().replace(/\s+/g,"");var v=0;a[0]==="-"&&(v++,this.negative=1),v<a.length&&(o===16?this._parseHex(a,v,d):(this._parseBase(a,o,v),d==="le"&&this._initArray(this.toArray(),o,d)))},s.prototype._initNumber=function(a,o,d){a<0&&(this.negative=1,a=-a),a<67108864?(this.words=[a&67108863],this.length=1):a<4503599627370496?(this.words=[a&67108863,a/67108864&67108863],this.length=2):(i(a<9007199254740992),this.words=[a&67108863,a/67108864&67108863,1],this.length=3),d==="le"&&this._initArray(this.toArray(),o,d)},s.prototype._initArray=function(a,o,d){if(i(typeof a.length=="number"),a.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(a.length/3),this.words=new Array(this.length);for(var v=0;v<this.length;v++)this.words[v]=0;var y,m,l=0;if(d==="be")for(v=a.length-1,y=0;v>=0;v-=3)m=a[v]|a[v-1]<<8|a[v-2]<<16,this.words[y]|=m<<l&67108863,this.words[y+1]=m>>>26-l&67108863,l+=24,l>=26&&(l-=26,y++);else if(d==="le")for(v=0,y=0;v<a.length;v+=3)m=a[v]|a[v+1]<<8|a[v+2]<<16,this.words[y]|=m<<l&67108863,this.words[y+1]=m>>>26-l&67108863,l+=24,l>=26&&(l-=26,y++);return this._strip()};function u(c,a){var o=c.charCodeAt(a);if(o>=48&&o<=57)return o-48;if(o>=65&&o<=70)return o-55;if(o>=97&&o<=102)return o-87;i(!1,"Invalid character in "+c)}function g(c,a,o){var d=u(c,o);return o-1>=a&&(d|=u(c,o-1)<<4),d}s.prototype._parseHex=function(a,o,d){this.length=Math.ceil((a.length-o)/6),this.words=new Array(this.length);for(var v=0;v<this.length;v++)this.words[v]=0;var y=0,m=0,l;if(d==="be")for(v=a.length-1;v>=o;v-=2)l=g(a,o,v)<<y,this.words[m]|=l&67108863,y>=18?(y-=18,m+=1,this.words[m]|=l>>>26):y+=8;else{var p=a.length-o;for(v=p%2===0?o+1:o;v<a.length;v+=2)l=g(a,o,v)<<y,this.words[m]|=l&67108863,y>=18?(y-=18,m+=1,this.words[m]|=l>>>26):y+=8}this._strip()};function b(c,a,o,d){for(var v=0,y=0,m=Math.min(c.length,o),l=a;l<m;l++){var p=c.charCodeAt(l)-48;v*=d,p>=49?y=p-49+10:p>=17?y=p-17+10:y=p,i(p>=0&&y<d,"Invalid character"),v+=y}return v}s.prototype._parseBase=function(a,o,d){this.words=[0],this.length=1;for(var v=0,y=1;y<=67108863;y*=o)v++;v--,y=y/o|0;for(var m=a.length-d,l=m%v,p=Math.min(m,m-l)+d,f=0,x=d;x<p;x+=v)f=b(a,x,x+v,o),this.imuln(y),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f);if(l!==0){var H=1;for(f=b(a,x,a.length,o),x=0;x<l;x++)H*=o;this.imuln(H),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f)}this._strip()},s.prototype.copy=function(a){a.words=new Array(this.length);for(var o=0;o<this.length;o++)a.words[o]=this.words[o];a.length=this.length,a.negative=this.negative,a.red=this.red};function _(c,a){c.words=a.words,c.length=a.length,c.negative=a.negative,c.red=a.red}if(s.prototype._move=function(a){_(a,this)},s.prototype.clone=function(){var a=new s(null);return this.copy(a),a},s.prototype._expand=function(a){for(;this.length<a;)this.words[this.length++]=0;return this},s.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},s.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{s.prototype[Symbol.for("nodejs.util.inspect.custom")]=M}catch{s.prototype.inspect=M}else s.prototype.inspect=M;function M(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var A=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],I=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],D=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(a,o){a=a||10,o=o|0||1;var d;if(a===16||a==="hex"){d="";for(var v=0,y=0,m=0;m<this.length;m++){var l=this.words[m],p=((l<<v|y)&16777215).toString(16);y=l>>>24-v&16777215,v+=2,v>=26&&(v-=26,m--),y!==0||m!==this.length-1?d=A[6-p.length]+p+d:d=p+d}for(y!==0&&(d=y.toString(16)+d);d.length%o!==0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}if(a===(a|0)&&a>=2&&a<=36){var f=I[a],x=D[a];d="";var H=this.clone();for(H.negative=0;!H.isZero();){var j=H.modrn(x).toString(a);H=H.idivn(x),H.isZero()?d=j+d:d=A[f-j.length]+j+d}for(this.isZero()&&(d="0"+d);d.length%o!==0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}i(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var a=this.words[0];return this.length===2?a+=this.words[1]*67108864:this.length===3&&this.words[2]===1?a+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-a:a},s.prototype.toJSON=function(){return this.toString(16,2)},h&&(s.prototype.toBuffer=function(a,o){return this.toArrayLike(h,a,o)}),s.prototype.toArray=function(a,o){return this.toArrayLike(Array,a,o)};var N=function(a,o){return a.allocUnsafe?a.allocUnsafe(o):new a(o)};s.prototype.toArrayLike=function(a,o,d){this._strip();var v=this.byteLength(),y=d||Math.max(1,v);i(v<=y,"byte array longer than desired length"),i(y>0,"Requested array length <= 0");var m=N(a,y),l=o==="le"?"LE":"BE";return this["_toArrayLike"+l](m,v),m},s.prototype._toArrayLikeLE=function(a,o){for(var d=0,v=0,y=0,m=0;y<this.length;y++){var l=this.words[y]<<m|v;a[d++]=l&255,d<a.length&&(a[d++]=l>>8&255),d<a.length&&(a[d++]=l>>16&255),m===6?(d<a.length&&(a[d++]=l>>24&255),v=0,m=0):(v=l>>>24,m+=2)}if(d<a.length)for(a[d++]=v;d<a.length;)a[d++]=0},s.prototype._toArrayLikeBE=function(a,o){for(var d=a.length-1,v=0,y=0,m=0;y<this.length;y++){var l=this.words[y]<<m|v;a[d--]=l&255,d>=0&&(a[d--]=l>>8&255),d>=0&&(a[d--]=l>>16&255),m===6?(d>=0&&(a[d--]=l>>24&255),v=0,m=0):(v=l>>>24,m+=2)}if(d>=0)for(a[d--]=v;d>=0;)a[d--]=0},Math.clz32?s.prototype._countBits=function(a){return 32-Math.clz32(a)}:s.prototype._countBits=function(a){var o=a,d=0;return o>=4096&&(d+=13,o>>>=13),o>=64&&(d+=7,o>>>=7),o>=8&&(d+=4,o>>>=4),o>=2&&(d+=2,o>>>=2),d+o},s.prototype._zeroBits=function(a){if(a===0)return 26;var o=a,d=0;return o&8191||(d+=13,o>>>=13),o&127||(d+=7,o>>>=7),o&15||(d+=4,o>>>=4),o&3||(d+=2,o>>>=2),o&1||d++,d},s.prototype.bitLength=function(){var a=this.words[this.length-1],o=this._countBits(a);return(this.length-1)*26+o};function U(c){for(var a=new Array(c.bitLength()),o=0;o<a.length;o++){var d=o/26|0,v=o%26;a[o]=c.words[d]>>>v&1}return a}s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var a=0,o=0;o<this.length;o++){var d=this._zeroBits(this.words[o]);if(a+=d,d!==26)break}return a},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(a){return this.negative!==0?this.abs().inotn(a).iaddn(1):this.clone()},s.prototype.fromTwos=function(a){return this.testn(a-1)?this.notn(a).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return this.negative!==0},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(a){for(;this.length<a.length;)this.words[this.length++]=0;for(var o=0;o<a.length;o++)this.words[o]=this.words[o]|a.words[o];return this._strip()},s.prototype.ior=function(a){return i((this.negative|a.negative)===0),this.iuor(a)},s.prototype.or=function(a){return this.length>a.length?this.clone().ior(a):a.clone().ior(this)},s.prototype.uor=function(a){return this.length>a.length?this.clone().iuor(a):a.clone().iuor(this)},s.prototype.iuand=function(a){var o;this.length>a.length?o=a:o=this;for(var d=0;d<o.length;d++)this.words[d]=this.words[d]&a.words[d];return this.length=o.length,this._strip()},s.prototype.iand=function(a){return i((this.negative|a.negative)===0),this.iuand(a)},s.prototype.and=function(a){return this.length>a.length?this.clone().iand(a):a.clone().iand(this)},s.prototype.uand=function(a){return this.length>a.length?this.clone().iuand(a):a.clone().iuand(this)},s.prototype.iuxor=function(a){var o,d;this.length>a.length?(o=this,d=a):(o=a,d=this);for(var v=0;v<d.length;v++)this.words[v]=o.words[v]^d.words[v];if(this!==o)for(;v<o.length;v++)this.words[v]=o.words[v];return this.length=o.length,this._strip()},s.prototype.ixor=function(a){return i((this.negative|a.negative)===0),this.iuxor(a)},s.prototype.xor=function(a){return this.length>a.length?this.clone().ixor(a):a.clone().ixor(this)},s.prototype.uxor=function(a){return this.length>a.length?this.clone().iuxor(a):a.clone().iuxor(this)},s.prototype.inotn=function(a){i(typeof a=="number"&&a>=0);var o=Math.ceil(a/26)|0,d=a%26;this._expand(o),d>0&&o--;for(var v=0;v<o;v++)this.words[v]=~this.words[v]&67108863;return d>0&&(this.words[v]=~this.words[v]&67108863>>26-d),this._strip()},s.prototype.notn=function(a){return this.clone().inotn(a)},s.prototype.setn=function(a,o){i(typeof a=="number"&&a>=0);var d=a/26|0,v=a%26;return this._expand(d+1),o?this.words[d]=this.words[d]|1<<v:this.words[d]=this.words[d]&~(1<<v),this._strip()},s.prototype.iadd=function(a){var o;if(this.negative!==0&&a.negative===0)return this.negative=0,o=this.isub(a),this.negative^=1,this._normSign();if(this.negative===0&&a.negative!==0)return a.negative=0,o=this.isub(a),a.negative=1,o._normSign();var d,v;this.length>a.length?(d=this,v=a):(d=a,v=this);for(var y=0,m=0;m<v.length;m++)o=(d.words[m]|0)+(v.words[m]|0)+y,this.words[m]=o&67108863,y=o>>>26;for(;y!==0&&m<d.length;m++)o=(d.words[m]|0)+y,this.words[m]=o&67108863,y=o>>>26;if(this.length=d.length,y!==0)this.words[this.length]=y,this.length++;else if(d!==this)for(;m<d.length;m++)this.words[m]=d.words[m];return this},s.prototype.add=function(a){var o;return a.negative!==0&&this.negative===0?(a.negative=0,o=this.sub(a),a.negative^=1,o):a.negative===0&&this.negative!==0?(this.negative=0,o=a.sub(this),this.negative=1,o):this.length>a.length?this.clone().iadd(a):a.clone().iadd(this)},s.prototype.isub=function(a){if(a.negative!==0){a.negative=0;var o=this.iadd(a);return a.negative=1,o._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(a),this.negative=1,this._normSign();var d=this.cmp(a);if(d===0)return this.negative=0,this.length=1,this.words[0]=0,this;var v,y;d>0?(v=this,y=a):(v=a,y=this);for(var m=0,l=0;l<y.length;l++)o=(v.words[l]|0)-(y.words[l]|0)+m,m=o>>26,this.words[l]=o&67108863;for(;m!==0&&l<v.length;l++)o=(v.words[l]|0)+m,m=o>>26,this.words[l]=o&67108863;if(m===0&&l<v.length&&v!==this)for(;l<v.length;l++)this.words[l]=v.words[l];return this.length=Math.max(this.length,l),v!==this&&(this.negative=1),this._strip()},s.prototype.sub=function(a){return this.clone().isub(a)};function k(c,a,o){o.negative=a.negative^c.negative;var d=c.length+a.length|0;o.length=d,d=d-1|0;var v=c.words[0]|0,y=a.words[0]|0,m=v*y,l=m&67108863,p=m/67108864|0;o.words[0]=l;for(var f=1;f<d;f++){for(var x=p>>>26,H=p&67108863,j=Math.min(f,a.length-1),G=Math.max(0,f-c.length+1);G<=j;G++){var B=f-G|0;v=c.words[B]|0,y=a.words[G]|0,m=v*y+H,x+=m/67108864|0,H=m&67108863}o.words[f]=H|0,p=x|0}return p!==0?o.words[f]=p|0:o.length--,o._strip()}var T=function(a,o,d){var v=a.words,y=o.words,m=d.words,l=0,p,f,x,H=v[0]|0,j=H&8191,G=H>>>13,B=v[1]|0,z=B&8191,q=B>>>13,S=v[2]|0,F=S&8191,W=S>>>13,te=v[3]|0,fe=te&8191,ie=te>>>13,Ce=v[4]|0,ye=Ce&8191,oe=Ce>>>13,ze=v[5]|0,ge=ze&8191,re=ze>>>13,Ne=v[6]|0,ce=Ne&8191,ee=Ne>>>13,Ie=v[7]|0,se=Ie&8191,Y=Ie>>>13,Pe=v[8]|0,ve=Pe&8191,Q=Pe>>>13,Le=v[9]|0,me=Le&8191,ne=Le>>>13,$e=y[0]|0,we=$e&8191,xe=$e>>>13,Ze=y[1]|0,qe=Ze&8191,_e=Ze>>>13,tt=y[2]|0,Ue=tt&8191,Ee=tt>>>13,Be=y[3]|0,Se=Be&8191,he=Be>>>13,ke=y[4]|0,De=ke&8191,ae=ke>>>13,Ve=y[5]|0,Re=Ve&8191,de=Ve>>>13,Ge=y[6]|0,Te=Ge&8191,ue=Ge>>>13,Ke=y[7]|0,Me=Ke&8191,pe=Ke>>>13,We=y[8]|0,He=We&8191,Oe=We>>>13,rt=y[9]|0,Fe=rt&8191,je=rt>>>13;d.negative=a.negative^o.negative,d.length=19,p=Math.imul(j,we),f=Math.imul(j,xe),f=f+Math.imul(G,we)|0,x=Math.imul(G,xe);var Gt=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(Gt>>>26)|0,Gt&=67108863,p=Math.imul(z,we),f=Math.imul(z,xe),f=f+Math.imul(q,we)|0,x=Math.imul(q,xe),p=p+Math.imul(j,qe)|0,f=f+Math.imul(j,_e)|0,f=f+Math.imul(G,qe)|0,x=x+Math.imul(G,_e)|0;var Wt=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(Wt>>>26)|0,Wt&=67108863,p=Math.imul(F,we),f=Math.imul(F,xe),f=f+Math.imul(W,we)|0,x=Math.imul(W,xe),p=p+Math.imul(z,qe)|0,f=f+Math.imul(z,_e)|0,f=f+Math.imul(q,qe)|0,x=x+Math.imul(q,_e)|0,p=p+Math.imul(j,Ue)|0,f=f+Math.imul(j,Ee)|0,f=f+Math.imul(G,Ue)|0,x=x+Math.imul(G,Ee)|0;var Jt=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(Jt>>>26)|0,Jt&=67108863,p=Math.imul(fe,we),f=Math.imul(fe,xe),f=f+Math.imul(ie,we)|0,x=Math.imul(ie,xe),p=p+Math.imul(F,qe)|0,f=f+Math.imul(F,_e)|0,f=f+Math.imul(W,qe)|0,x=x+Math.imul(W,_e)|0,p=p+Math.imul(z,Ue)|0,f=f+Math.imul(z,Ee)|0,f=f+Math.imul(q,Ue)|0,x=x+Math.imul(q,Ee)|0,p=p+Math.imul(j,Se)|0,f=f+Math.imul(j,he)|0,f=f+Math.imul(G,Se)|0,x=x+Math.imul(G,he)|0;var Yt=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(Yt>>>26)|0,Yt&=67108863,p=Math.imul(ye,we),f=Math.imul(ye,xe),f=f+Math.imul(oe,we)|0,x=Math.imul(oe,xe),p=p+Math.imul(fe,qe)|0,f=f+Math.imul(fe,_e)|0,f=f+Math.imul(ie,qe)|0,x=x+Math.imul(ie,_e)|0,p=p+Math.imul(F,Ue)|0,f=f+Math.imul(F,Ee)|0,f=f+Math.imul(W,Ue)|0,x=x+Math.imul(W,Ee)|0,p=p+Math.imul(z,Se)|0,f=f+Math.imul(z,he)|0,f=f+Math.imul(q,Se)|0,x=x+Math.imul(q,he)|0,p=p+Math.imul(j,De)|0,f=f+Math.imul(j,ae)|0,f=f+Math.imul(G,De)|0,x=x+Math.imul(G,ae)|0;var mt=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(mt>>>26)|0,mt&=67108863,p=Math.imul(ge,we),f=Math.imul(ge,xe),f=f+Math.imul(re,we)|0,x=Math.imul(re,xe),p=p+Math.imul(ye,qe)|0,f=f+Math.imul(ye,_e)|0,f=f+Math.imul(oe,qe)|0,x=x+Math.imul(oe,_e)|0,p=p+Math.imul(fe,Ue)|0,f=f+Math.imul(fe,Ee)|0,f=f+Math.imul(ie,Ue)|0,x=x+Math.imul(ie,Ee)|0,p=p+Math.imul(F,Se)|0,f=f+Math.imul(F,he)|0,f=f+Math.imul(W,Se)|0,x=x+Math.imul(W,he)|0,p=p+Math.imul(z,De)|0,f=f+Math.imul(z,ae)|0,f=f+Math.imul(q,De)|0,x=x+Math.imul(q,ae)|0,p=p+Math.imul(j,Re)|0,f=f+Math.imul(j,de)|0,f=f+Math.imul(G,Re)|0,x=x+Math.imul(G,de)|0;var Xt=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(Xt>>>26)|0,Xt&=67108863,p=Math.imul(ce,we),f=Math.imul(ce,xe),f=f+Math.imul(ee,we)|0,x=Math.imul(ee,xe),p=p+Math.imul(ge,qe)|0,f=f+Math.imul(ge,_e)|0,f=f+Math.imul(re,qe)|0,x=x+Math.imul(re,_e)|0,p=p+Math.imul(ye,Ue)|0,f=f+Math.imul(ye,Ee)|0,f=f+Math.imul(oe,Ue)|0,x=x+Math.imul(oe,Ee)|0,p=p+Math.imul(fe,Se)|0,f=f+Math.imul(fe,he)|0,f=f+Math.imul(ie,Se)|0,x=x+Math.imul(ie,he)|0,p=p+Math.imul(F,De)|0,f=f+Math.imul(F,ae)|0,f=f+Math.imul(W,De)|0,x=x+Math.imul(W,ae)|0,p=p+Math.imul(z,Re)|0,f=f+Math.imul(z,de)|0,f=f+Math.imul(q,Re)|0,x=x+Math.imul(q,de)|0,p=p+Math.imul(j,Te)|0,f=f+Math.imul(j,ue)|0,f=f+Math.imul(G,Te)|0,x=x+Math.imul(G,ue)|0;var Zt=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(Zt>>>26)|0,Zt&=67108863,p=Math.imul(se,we),f=Math.imul(se,xe),f=f+Math.imul(Y,we)|0,x=Math.imul(Y,xe),p=p+Math.imul(ce,qe)|0,f=f+Math.imul(ce,_e)|0,f=f+Math.imul(ee,qe)|0,x=x+Math.imul(ee,_e)|0,p=p+Math.imul(ge,Ue)|0,f=f+Math.imul(ge,Ee)|0,f=f+Math.imul(re,Ue)|0,x=x+Math.imul(re,Ee)|0,p=p+Math.imul(ye,Se)|0,f=f+Math.imul(ye,he)|0,f=f+Math.imul(oe,Se)|0,x=x+Math.imul(oe,he)|0,p=p+Math.imul(fe,De)|0,f=f+Math.imul(fe,ae)|0,f=f+Math.imul(ie,De)|0,x=x+Math.imul(ie,ae)|0,p=p+Math.imul(F,Re)|0,f=f+Math.imul(F,de)|0,f=f+Math.imul(W,Re)|0,x=x+Math.imul(W,de)|0,p=p+Math.imul(z,Te)|0,f=f+Math.imul(z,ue)|0,f=f+Math.imul(q,Te)|0,x=x+Math.imul(q,ue)|0,p=p+Math.imul(j,Me)|0,f=f+Math.imul(j,pe)|0,f=f+Math.imul(G,Me)|0,x=x+Math.imul(G,pe)|0;var Qt=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,p=Math.imul(ve,we),f=Math.imul(ve,xe),f=f+Math.imul(Q,we)|0,x=Math.imul(Q,xe),p=p+Math.imul(se,qe)|0,f=f+Math.imul(se,_e)|0,f=f+Math.imul(Y,qe)|0,x=x+Math.imul(Y,_e)|0,p=p+Math.imul(ce,Ue)|0,f=f+Math.imul(ce,Ee)|0,f=f+Math.imul(ee,Ue)|0,x=x+Math.imul(ee,Ee)|0,p=p+Math.imul(ge,Se)|0,f=f+Math.imul(ge,he)|0,f=f+Math.imul(re,Se)|0,x=x+Math.imul(re,he)|0,p=p+Math.imul(ye,De)|0,f=f+Math.imul(ye,ae)|0,f=f+Math.imul(oe,De)|0,x=x+Math.imul(oe,ae)|0,p=p+Math.imul(fe,Re)|0,f=f+Math.imul(fe,de)|0,f=f+Math.imul(ie,Re)|0,x=x+Math.imul(ie,de)|0,p=p+Math.imul(F,Te)|0,f=f+Math.imul(F,ue)|0,f=f+Math.imul(W,Te)|0,x=x+Math.imul(W,ue)|0,p=p+Math.imul(z,Me)|0,f=f+Math.imul(z,pe)|0,f=f+Math.imul(q,Me)|0,x=x+Math.imul(q,pe)|0,p=p+Math.imul(j,He)|0,f=f+Math.imul(j,Oe)|0,f=f+Math.imul(G,He)|0,x=x+Math.imul(G,Oe)|0;var er=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(er>>>26)|0,er&=67108863,p=Math.imul(me,we),f=Math.imul(me,xe),f=f+Math.imul(ne,we)|0,x=Math.imul(ne,xe),p=p+Math.imul(ve,qe)|0,f=f+Math.imul(ve,_e)|0,f=f+Math.imul(Q,qe)|0,x=x+Math.imul(Q,_e)|0,p=p+Math.imul(se,Ue)|0,f=f+Math.imul(se,Ee)|0,f=f+Math.imul(Y,Ue)|0,x=x+Math.imul(Y,Ee)|0,p=p+Math.imul(ce,Se)|0,f=f+Math.imul(ce,he)|0,f=f+Math.imul(ee,Se)|0,x=x+Math.imul(ee,he)|0,p=p+Math.imul(ge,De)|0,f=f+Math.imul(ge,ae)|0,f=f+Math.imul(re,De)|0,x=x+Math.imul(re,ae)|0,p=p+Math.imul(ye,Re)|0,f=f+Math.imul(ye,de)|0,f=f+Math.imul(oe,Re)|0,x=x+Math.imul(oe,de)|0,p=p+Math.imul(fe,Te)|0,f=f+Math.imul(fe,ue)|0,f=f+Math.imul(ie,Te)|0,x=x+Math.imul(ie,ue)|0,p=p+Math.imul(F,Me)|0,f=f+Math.imul(F,pe)|0,f=f+Math.imul(W,Me)|0,x=x+Math.imul(W,pe)|0,p=p+Math.imul(z,He)|0,f=f+Math.imul(z,Oe)|0,f=f+Math.imul(q,He)|0,x=x+Math.imul(q,Oe)|0,p=p+Math.imul(j,Fe)|0,f=f+Math.imul(j,je)|0,f=f+Math.imul(G,Fe)|0,x=x+Math.imul(G,je)|0;var tr=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(tr>>>26)|0,tr&=67108863,p=Math.imul(me,qe),f=Math.imul(me,_e),f=f+Math.imul(ne,qe)|0,x=Math.imul(ne,_e),p=p+Math.imul(ve,Ue)|0,f=f+Math.imul(ve,Ee)|0,f=f+Math.imul(Q,Ue)|0,x=x+Math.imul(Q,Ee)|0,p=p+Math.imul(se,Se)|0,f=f+Math.imul(se,he)|0,f=f+Math.imul(Y,Se)|0,x=x+Math.imul(Y,he)|0,p=p+Math.imul(ce,De)|0,f=f+Math.imul(ce,ae)|0,f=f+Math.imul(ee,De)|0,x=x+Math.imul(ee,ae)|0,p=p+Math.imul(ge,Re)|0,f=f+Math.imul(ge,de)|0,f=f+Math.imul(re,Re)|0,x=x+Math.imul(re,de)|0,p=p+Math.imul(ye,Te)|0,f=f+Math.imul(ye,ue)|0,f=f+Math.imul(oe,Te)|0,x=x+Math.imul(oe,ue)|0,p=p+Math.imul(fe,Me)|0,f=f+Math.imul(fe,pe)|0,f=f+Math.imul(ie,Me)|0,x=x+Math.imul(ie,pe)|0,p=p+Math.imul(F,He)|0,f=f+Math.imul(F,Oe)|0,f=f+Math.imul(W,He)|0,x=x+Math.imul(W,Oe)|0,p=p+Math.imul(z,Fe)|0,f=f+Math.imul(z,je)|0,f=f+Math.imul(q,Fe)|0,x=x+Math.imul(q,je)|0;var Rt=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,p=Math.imul(me,Ue),f=Math.imul(me,Ee),f=f+Math.imul(ne,Ue)|0,x=Math.imul(ne,Ee),p=p+Math.imul(ve,Se)|0,f=f+Math.imul(ve,he)|0,f=f+Math.imul(Q,Se)|0,x=x+Math.imul(Q,he)|0,p=p+Math.imul(se,De)|0,f=f+Math.imul(se,ae)|0,f=f+Math.imul(Y,De)|0,x=x+Math.imul(Y,ae)|0,p=p+Math.imul(ce,Re)|0,f=f+Math.imul(ce,de)|0,f=f+Math.imul(ee,Re)|0,x=x+Math.imul(ee,de)|0,p=p+Math.imul(ge,Te)|0,f=f+Math.imul(ge,ue)|0,f=f+Math.imul(re,Te)|0,x=x+Math.imul(re,ue)|0,p=p+Math.imul(ye,Me)|0,f=f+Math.imul(ye,pe)|0,f=f+Math.imul(oe,Me)|0,x=x+Math.imul(oe,pe)|0,p=p+Math.imul(fe,He)|0,f=f+Math.imul(fe,Oe)|0,f=f+Math.imul(ie,He)|0,x=x+Math.imul(ie,Oe)|0,p=p+Math.imul(F,Fe)|0,f=f+Math.imul(F,je)|0,f=f+Math.imul(W,Fe)|0,x=x+Math.imul(W,je)|0;var rr=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(rr>>>26)|0,rr&=67108863,p=Math.imul(me,Se),f=Math.imul(me,he),f=f+Math.imul(ne,Se)|0,x=Math.imul(ne,he),p=p+Math.imul(ve,De)|0,f=f+Math.imul(ve,ae)|0,f=f+Math.imul(Q,De)|0,x=x+Math.imul(Q,ae)|0,p=p+Math.imul(se,Re)|0,f=f+Math.imul(se,de)|0,f=f+Math.imul(Y,Re)|0,x=x+Math.imul(Y,de)|0,p=p+Math.imul(ce,Te)|0,f=f+Math.imul(ce,ue)|0,f=f+Math.imul(ee,Te)|0,x=x+Math.imul(ee,ue)|0,p=p+Math.imul(ge,Me)|0,f=f+Math.imul(ge,pe)|0,f=f+Math.imul(re,Me)|0,x=x+Math.imul(re,pe)|0,p=p+Math.imul(ye,He)|0,f=f+Math.imul(ye,Oe)|0,f=f+Math.imul(oe,He)|0,x=x+Math.imul(oe,Oe)|0,p=p+Math.imul(fe,Fe)|0,f=f+Math.imul(fe,je)|0,f=f+Math.imul(ie,Fe)|0,x=x+Math.imul(ie,je)|0;var ir=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(ir>>>26)|0,ir&=67108863,p=Math.imul(me,De),f=Math.imul(me,ae),f=f+Math.imul(ne,De)|0,x=Math.imul(ne,ae),p=p+Math.imul(ve,Re)|0,f=f+Math.imul(ve,de)|0,f=f+Math.imul(Q,Re)|0,x=x+Math.imul(Q,de)|0,p=p+Math.imul(se,Te)|0,f=f+Math.imul(se,ue)|0,f=f+Math.imul(Y,Te)|0,x=x+Math.imul(Y,ue)|0,p=p+Math.imul(ce,Me)|0,f=f+Math.imul(ce,pe)|0,f=f+Math.imul(ee,Me)|0,x=x+Math.imul(ee,pe)|0,p=p+Math.imul(ge,He)|0,f=f+Math.imul(ge,Oe)|0,f=f+Math.imul(re,He)|0,x=x+Math.imul(re,Oe)|0,p=p+Math.imul(ye,Fe)|0,f=f+Math.imul(ye,je)|0,f=f+Math.imul(oe,Fe)|0,x=x+Math.imul(oe,je)|0;var gt=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(gt>>>26)|0,gt&=67108863,p=Math.imul(me,Re),f=Math.imul(me,de),f=f+Math.imul(ne,Re)|0,x=Math.imul(ne,de),p=p+Math.imul(ve,Te)|0,f=f+Math.imul(ve,ue)|0,f=f+Math.imul(Q,Te)|0,x=x+Math.imul(Q,ue)|0,p=p+Math.imul(se,Me)|0,f=f+Math.imul(se,pe)|0,f=f+Math.imul(Y,Me)|0,x=x+Math.imul(Y,pe)|0,p=p+Math.imul(ce,He)|0,f=f+Math.imul(ce,Oe)|0,f=f+Math.imul(ee,He)|0,x=x+Math.imul(ee,Oe)|0,p=p+Math.imul(ge,Fe)|0,f=f+Math.imul(ge,je)|0,f=f+Math.imul(re,Fe)|0,x=x+Math.imul(re,je)|0;var nr=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(nr>>>26)|0,nr&=67108863,p=Math.imul(me,Te),f=Math.imul(me,ue),f=f+Math.imul(ne,Te)|0,x=Math.imul(ne,ue),p=p+Math.imul(ve,Me)|0,f=f+Math.imul(ve,pe)|0,f=f+Math.imul(Q,Me)|0,x=x+Math.imul(Q,pe)|0,p=p+Math.imul(se,He)|0,f=f+Math.imul(se,Oe)|0,f=f+Math.imul(Y,He)|0,x=x+Math.imul(Y,Oe)|0,p=p+Math.imul(ce,Fe)|0,f=f+Math.imul(ce,je)|0,f=f+Math.imul(ee,Fe)|0,x=x+Math.imul(ee,je)|0;var sr=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(sr>>>26)|0,sr&=67108863,p=Math.imul(me,Me),f=Math.imul(me,pe),f=f+Math.imul(ne,Me)|0,x=Math.imul(ne,pe),p=p+Math.imul(ve,He)|0,f=f+Math.imul(ve,Oe)|0,f=f+Math.imul(Q,He)|0,x=x+Math.imul(Q,Oe)|0,p=p+Math.imul(se,Fe)|0,f=f+Math.imul(se,je)|0,f=f+Math.imul(Y,Fe)|0,x=x+Math.imul(Y,je)|0;var ar=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(ar>>>26)|0,ar&=67108863,p=Math.imul(me,He),f=Math.imul(me,Oe),f=f+Math.imul(ne,He)|0,x=Math.imul(ne,Oe),p=p+Math.imul(ve,Fe)|0,f=f+Math.imul(ve,je)|0,f=f+Math.imul(Q,Fe)|0,x=x+Math.imul(Q,je)|0;var Yr=(l+p|0)+((f&8191)<<13)|0;l=(x+(f>>>13)|0)+(Yr>>>26)|0,Yr&=67108863,p=Math.imul(me,Fe),f=Math.imul(me,je),f=f+Math.imul(ne,Fe)|0,x=Math.imul(ne,je);var Xr=(l+p|0)+((f&8191)<<13)|0;return l=(x+(f>>>13)|0)+(Xr>>>26)|0,Xr&=67108863,m[0]=Gt,m[1]=Wt,m[2]=Jt,m[3]=Yt,m[4]=mt,m[5]=Xt,m[6]=Zt,m[7]=Qt,m[8]=er,m[9]=tr,m[10]=Rt,m[11]=rr,m[12]=ir,m[13]=gt,m[14]=nr,m[15]=sr,m[16]=ar,m[17]=Yr,m[18]=Xr,l!==0&&(m[19]=l,d.length++),d};Math.imul||(T=k);function K(c,a,o){o.negative=a.negative^c.negative,o.length=c.length+a.length;for(var d=0,v=0,y=0;y<o.length-1;y++){var m=v;v=0;for(var l=d&67108863,p=Math.min(y,a.length-1),f=Math.max(0,y-c.length+1);f<=p;f++){var x=y-f,H=c.words[x]|0,j=a.words[f]|0,G=H*j,B=G&67108863;m=m+(G/67108864|0)|0,B=B+l|0,l=B&67108863,m=m+(B>>>26)|0,v+=m>>>26,m&=67108863}o.words[y]=l,d=m,m=v}return d!==0?o.words[y]=d:o.length--,o._strip()}function R(c,a,o){return K(c,a,o)}s.prototype.mulTo=function(a,o){var d,v=this.length+a.length;return this.length===10&&a.length===10?d=T(this,a,o):v<63?d=k(this,a,o):v<1024?d=K(this,a,o):d=R(this,a,o),d},s.prototype.mul=function(a){var o=new s(null);return o.words=new Array(this.length+a.length),this.mulTo(a,o)},s.prototype.mulf=function(a){var o=new s(null);return o.words=new Array(this.length+a.length),R(this,a,o)},s.prototype.imul=function(a){return this.clone().mulTo(a,this)},s.prototype.imuln=function(a){var o=a<0;o&&(a=-a),i(typeof a=="number"),i(a<67108864);for(var d=0,v=0;v<this.length;v++){var y=(this.words[v]|0)*a,m=(y&67108863)+(d&67108863);d>>=26,d+=y/67108864|0,d+=m>>>26,this.words[v]=m&67108863}return d!==0&&(this.words[v]=d,this.length++),o?this.ineg():this},s.prototype.muln=function(a){return this.clone().imuln(a)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(a){var o=U(a);if(o.length===0)return new s(1);for(var d=this,v=0;v<o.length&&o[v]===0;v++,d=d.sqr());if(++v<o.length)for(var y=d.sqr();v<o.length;v++,y=y.sqr())o[v]!==0&&(d=d.mul(y));return d},s.prototype.iushln=function(a){i(typeof a=="number"&&a>=0);var o=a%26,d=(a-o)/26,v=67108863>>>26-o<<26-o,y;if(o!==0){var m=0;for(y=0;y<this.length;y++){var l=this.words[y]&v,p=(this.words[y]|0)-l<<o;this.words[y]=p|m,m=l>>>26-o}m&&(this.words[y]=m,this.length++)}if(d!==0){for(y=this.length-1;y>=0;y--)this.words[y+d]=this.words[y];for(y=0;y<d;y++)this.words[y]=0;this.length+=d}return this._strip()},s.prototype.ishln=function(a){return i(this.negative===0),this.iushln(a)},s.prototype.iushrn=function(a,o,d){i(typeof a=="number"&&a>=0);var v;o?v=(o-o%26)/26:v=0;var y=a%26,m=Math.min((a-y)/26,this.length),l=67108863^67108863>>>y<<y,p=d;if(v-=m,v=Math.max(0,v),p){for(var f=0;f<m;f++)p.words[f]=this.words[f];p.length=m}if(m!==0)if(this.length>m)for(this.length-=m,f=0;f<this.length;f++)this.words[f]=this.words[f+m];else this.words[0]=0,this.length=1;var x=0;for(f=this.length-1;f>=0&&(x!==0||f>=v);f--){var H=this.words[f]|0;this.words[f]=x<<26-y|H>>>y,x=H&l}return p&&x!==0&&(p.words[p.length++]=x),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},s.prototype.ishrn=function(a,o,d){return i(this.negative===0),this.iushrn(a,o,d)},s.prototype.shln=function(a){return this.clone().ishln(a)},s.prototype.ushln=function(a){return this.clone().iushln(a)},s.prototype.shrn=function(a){return this.clone().ishrn(a)},s.prototype.ushrn=function(a){return this.clone().iushrn(a)},s.prototype.testn=function(a){i(typeof a=="number"&&a>=0);var o=a%26,d=(a-o)/26,v=1<<o;if(this.length<=d)return!1;var y=this.words[d];return!!(y&v)},s.prototype.imaskn=function(a){i(typeof a=="number"&&a>=0);var o=a%26,d=(a-o)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=d)return this;if(o!==0&&d++,this.length=Math.min(d,this.length),o!==0){var v=67108863^67108863>>>o<<o;this.words[this.length-1]&=v}return this._strip()},s.prototype.maskn=function(a){return this.clone().imaskn(a)},s.prototype.iaddn=function(a){return i(typeof a=="number"),i(a<67108864),a<0?this.isubn(-a):this.negative!==0?this.length===1&&(this.words[0]|0)<=a?(this.words[0]=a-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(a),this.negative=1,this):this._iaddn(a)},s.prototype._iaddn=function(a){this.words[0]+=a;for(var o=0;o<this.length&&this.words[o]>=67108864;o++)this.words[o]-=67108864,o===this.length-1?this.words[o+1]=1:this.words[o+1]++;return this.length=Math.max(this.length,o+1),this},s.prototype.isubn=function(a){if(i(typeof a=="number"),i(a<67108864),a<0)return this.iaddn(-a);if(this.negative!==0)return this.negative=0,this.iaddn(a),this.negative=1,this;if(this.words[0]-=a,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var o=0;o<this.length&&this.words[o]<0;o++)this.words[o]+=67108864,this.words[o+1]-=1;return this._strip()},s.prototype.addn=function(a){return this.clone().iaddn(a)},s.prototype.subn=function(a){return this.clone().isubn(a)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(a,o,d){var v=a.length+d,y;this._expand(v);var m,l=0;for(y=0;y<a.length;y++){m=(this.words[y+d]|0)+l;var p=(a.words[y]|0)*o;m-=p&67108863,l=(m>>26)-(p/67108864|0),this.words[y+d]=m&67108863}for(;y<this.length-d;y++)m=(this.words[y+d]|0)+l,l=m>>26,this.words[y+d]=m&67108863;if(l===0)return this._strip();for(i(l===-1),l=0,y=0;y<this.length;y++)m=-(this.words[y]|0)+l,l=m>>26,this.words[y]=m&67108863;return this.negative=1,this._strip()},s.prototype._wordDiv=function(a,o){var d=this.length-a.length,v=this.clone(),y=a,m=y.words[y.length-1]|0,l=this._countBits(m);d=26-l,d!==0&&(y=y.ushln(d),v.iushln(d),m=y.words[y.length-1]|0);var p=v.length-y.length,f;if(o!=="mod"){f=new s(null),f.length=p+1,f.words=new Array(f.length);for(var x=0;x<f.length;x++)f.words[x]=0}var H=v.clone()._ishlnsubmul(y,1,p);H.negative===0&&(v=H,f&&(f.words[p]=1));for(var j=p-1;j>=0;j--){var G=(v.words[y.length+j]|0)*67108864+(v.words[y.length+j-1]|0);for(G=Math.min(G/m|0,67108863),v._ishlnsubmul(y,G,j);v.negative!==0;)G--,v.negative=0,v._ishlnsubmul(y,1,j),v.isZero()||(v.negative^=1);f&&(f.words[j]=G)}return f&&f._strip(),v._strip(),o!=="div"&&d!==0&&v.iushrn(d),{div:f||null,mod:v}},s.prototype.divmod=function(a,o,d){if(i(!a.isZero()),this.isZero())return{div:new s(0),mod:new s(0)};var v,y,m;return this.negative!==0&&a.negative===0?(m=this.neg().divmod(a,o),o!=="mod"&&(v=m.div.neg()),o!=="div"&&(y=m.mod.neg(),d&&y.negative!==0&&y.iadd(a)),{div:v,mod:y}):this.negative===0&&a.negative!==0?(m=this.divmod(a.neg(),o),o!=="mod"&&(v=m.div.neg()),{div:v,mod:m.mod}):this.negative&a.negative?(m=this.neg().divmod(a.neg(),o),o!=="div"&&(y=m.mod.neg(),d&&y.negative!==0&&y.isub(a)),{div:m.div,mod:y}):a.length>this.length||this.cmp(a)<0?{div:new s(0),mod:this}:a.length===1?o==="div"?{div:this.divn(a.words[0]),mod:null}:o==="mod"?{div:null,mod:new s(this.modrn(a.words[0]))}:{div:this.divn(a.words[0]),mod:new s(this.modrn(a.words[0]))}:this._wordDiv(a,o)},s.prototype.div=function(a){return this.divmod(a,"div",!1).div},s.prototype.mod=function(a){return this.divmod(a,"mod",!1).mod},s.prototype.umod=function(a){return this.divmod(a,"mod",!0).mod},s.prototype.divRound=function(a){var o=this.divmod(a);if(o.mod.isZero())return o.div;var d=o.div.negative!==0?o.mod.isub(a):o.mod,v=a.ushrn(1),y=a.andln(1),m=d.cmp(v);return m<0||y===1&&m===0?o.div:o.div.negative!==0?o.div.isubn(1):o.div.iaddn(1)},s.prototype.modrn=function(a){var o=a<0;o&&(a=-a),i(a<=67108863);for(var d=(1<<26)%a,v=0,y=this.length-1;y>=0;y--)v=(d*v+(this.words[y]|0))%a;return o?-v:v},s.prototype.modn=function(a){return this.modrn(a)},s.prototype.idivn=function(a){var o=a<0;o&&(a=-a),i(a<=67108863);for(var d=0,v=this.length-1;v>=0;v--){var y=(this.words[v]|0)+d*67108864;this.words[v]=y/a|0,d=y%a}return this._strip(),o?this.ineg():this},s.prototype.divn=function(a){return this.clone().idivn(a)},s.prototype.egcd=function(a){i(a.negative===0),i(!a.isZero());var o=this,d=a.clone();o.negative!==0?o=o.umod(a):o=o.clone();for(var v=new s(1),y=new s(0),m=new s(0),l=new s(1),p=0;o.isEven()&&d.isEven();)o.iushrn(1),d.iushrn(1),++p;for(var f=d.clone(),x=o.clone();!o.isZero();){for(var H=0,j=1;!(o.words[0]&j)&&H<26;++H,j<<=1);if(H>0)for(o.iushrn(H);H-- >0;)(v.isOdd()||y.isOdd())&&(v.iadd(f),y.isub(x)),v.iushrn(1),y.iushrn(1);for(var G=0,B=1;!(d.words[0]&B)&&G<26;++G,B<<=1);if(G>0)for(d.iushrn(G);G-- >0;)(m.isOdd()||l.isOdd())&&(m.iadd(f),l.isub(x)),m.iushrn(1),l.iushrn(1);o.cmp(d)>=0?(o.isub(d),v.isub(m),y.isub(l)):(d.isub(o),m.isub(v),l.isub(y))}return{a:m,b:l,gcd:d.iushln(p)}},s.prototype._invmp=function(a){i(a.negative===0),i(!a.isZero());var o=this,d=a.clone();o.negative!==0?o=o.umod(a):o=o.clone();for(var v=new s(1),y=new s(0),m=d.clone();o.cmpn(1)>0&&d.cmpn(1)>0;){for(var l=0,p=1;!(o.words[0]&p)&&l<26;++l,p<<=1);if(l>0)for(o.iushrn(l);l-- >0;)v.isOdd()&&v.iadd(m),v.iushrn(1);for(var f=0,x=1;!(d.words[0]&x)&&f<26;++f,x<<=1);if(f>0)for(d.iushrn(f);f-- >0;)y.isOdd()&&y.iadd(m),y.iushrn(1);o.cmp(d)>=0?(o.isub(d),v.isub(y)):(d.isub(o),y.isub(v))}var H;return o.cmpn(1)===0?H=v:H=y,H.cmpn(0)<0&&H.iadd(a),H},s.prototype.gcd=function(a){if(this.isZero())return a.abs();if(a.isZero())return this.abs();var o=this.clone(),d=a.clone();o.negative=0,d.negative=0;for(var v=0;o.isEven()&&d.isEven();v++)o.iushrn(1),d.iushrn(1);do{for(;o.isEven();)o.iushrn(1);for(;d.isEven();)d.iushrn(1);var y=o.cmp(d);if(y<0){var m=o;o=d,d=m}else if(y===0||d.cmpn(1)===0)break;o.isub(d)}while(!0);return d.iushln(v)},s.prototype.invm=function(a){return this.egcd(a).a.umod(a)},s.prototype.isEven=function(){return(this.words[0]&1)===0},s.prototype.isOdd=function(){return(this.words[0]&1)===1},s.prototype.andln=function(a){return this.words[0]&a},s.prototype.bincn=function(a){i(typeof a=="number");var o=a%26,d=(a-o)/26,v=1<<o;if(this.length<=d)return this._expand(d+1),this.words[d]|=v,this;for(var y=v,m=d;y!==0&&m<this.length;m++){var l=this.words[m]|0;l+=y,y=l>>>26,l&=67108863,this.words[m]=l}return y!==0&&(this.words[m]=y,this.length++),this},s.prototype.isZero=function(){return this.length===1&&this.words[0]===0},s.prototype.cmpn=function(a){var o=a<0;if(this.negative!==0&&!o)return-1;if(this.negative===0&&o)return 1;this._strip();var d;if(this.length>1)d=1;else{o&&(a=-a),i(a<=67108863,"Number is too big");var v=this.words[0]|0;d=v===a?0:v<a?-1:1}return this.negative!==0?-d|0:d},s.prototype.cmp=function(a){if(this.negative!==0&&a.negative===0)return-1;if(this.negative===0&&a.negative!==0)return 1;var o=this.ucmp(a);return this.negative!==0?-o|0:o},s.prototype.ucmp=function(a){if(this.length>a.length)return 1;if(this.length<a.length)return-1;for(var o=0,d=this.length-1;d>=0;d--){var v=this.words[d]|0,y=a.words[d]|0;if(v!==y){v<y?o=-1:v>y&&(o=1);break}}return o},s.prototype.gtn=function(a){return this.cmpn(a)===1},s.prototype.gt=function(a){return this.cmp(a)===1},s.prototype.gten=function(a){return this.cmpn(a)>=0},s.prototype.gte=function(a){return this.cmp(a)>=0},s.prototype.ltn=function(a){return this.cmpn(a)===-1},s.prototype.lt=function(a){return this.cmp(a)===-1},s.prototype.lten=function(a){return this.cmpn(a)<=0},s.prototype.lte=function(a){return this.cmp(a)<=0},s.prototype.eqn=function(a){return this.cmpn(a)===0},s.prototype.eq=function(a){return this.cmp(a)===0},s.red=function(a){return new P(a)},s.prototype.toRed=function(a){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),a.convertTo(this)._forceRed(a)},s.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(a){return this.red=a,this},s.prototype.forceRed=function(a){return i(!this.red,"Already a number in reduction context"),this._forceRed(a)},s.prototype.redAdd=function(a){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,a)},s.prototype.redIAdd=function(a){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,a)},s.prototype.redSub=function(a){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,a)},s.prototype.redISub=function(a){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,a)},s.prototype.redShl=function(a){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,a)},s.prototype.redMul=function(a){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.mul(this,a)},s.prototype.redIMul=function(a){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.imul(this,a)},s.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(a){return i(this.red&&!a.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,a)};var C={k256:null,p224:null,p192:null,p25519:null};function $(c,a){this.name=c,this.p=new s(a,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}$.prototype._tmp=function(){var a=new s(null);return a.words=new Array(Math.ceil(this.n/13)),a},$.prototype.ireduce=function(a){var o=a,d;do this.split(o,this.tmp),o=this.imulK(o),o=o.iadd(this.tmp),d=o.bitLength();while(d>this.n);var v=d<this.n?-1:o.ucmp(this.p);return v===0?(o.words[0]=0,o.length=1):v>0?o.isub(this.p):o.strip!==void 0?o.strip():o._strip(),o},$.prototype.split=function(a,o){a.iushrn(this.n,0,o)},$.prototype.imulK=function(a){return a.imul(this.k)};function E(){$.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(E,$),E.prototype.split=function(a,o){for(var d=4194303,v=Math.min(a.length,9),y=0;y<v;y++)o.words[y]=a.words[y];if(o.length=v,a.length<=9){a.words[0]=0,a.length=1;return}var m=a.words[9];for(o.words[o.length++]=m&d,y=10;y<a.length;y++){var l=a.words[y]|0;a.words[y-10]=(l&d)<<4|m>>>22,m=l}m>>>=22,a.words[y-10]=m,m===0&&a.length>10?a.length-=10:a.length-=9},E.prototype.imulK=function(a){a.words[a.length]=0,a.words[a.length+1]=0,a.length+=2;for(var o=0,d=0;d<a.length;d++){var v=a.words[d]|0;o+=v*977,a.words[d]=o&67108863,o=v*64+(o/67108864|0)}return a.words[a.length-1]===0&&(a.length--,a.words[a.length-1]===0&&a.length--),a};function O(){$.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(O,$);function J(){$.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(J,$);function Z(){$.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(Z,$),Z.prototype.imulK=function(a){for(var o=0,d=0;d<a.length;d++){var v=(a.words[d]|0)*19+o,y=v&67108863;v>>>=26,a.words[d]=y,o=v}return o!==0&&(a.words[a.length++]=o),a},s._prime=function(a){if(C[a])return C[a];var o;if(a==="k256")o=new E;else if(a==="p224")o=new O;else if(a==="p192")o=new J;else if(a==="p25519")o=new Z;else throw new Error("Unknown prime "+a);return C[a]=o,o};function P(c){if(typeof c=="string"){var a=s._prime(c);this.m=a.p,this.prime=a}else i(c.gtn(1),"modulus must be greater than 1"),this.m=c,this.prime=null}P.prototype._verify1=function(a){i(a.negative===0,"red works only with positives"),i(a.red,"red works only with red numbers")},P.prototype._verify2=function(a,o){i((a.negative|o.negative)===0,"red works only with positives"),i(a.red&&a.red===o.red,"red works only with red numbers")},P.prototype.imod=function(a){return this.prime?this.prime.ireduce(a)._forceRed(this):(_(a,a.umod(this.m)._forceRed(this)),a)},P.prototype.neg=function(a){return a.isZero()?a.clone():this.m.sub(a)._forceRed(this)},P.prototype.add=function(a,o){this._verify2(a,o);var d=a.add(o);return d.cmp(this.m)>=0&&d.isub(this.m),d._forceRed(this)},P.prototype.iadd=function(a,o){this._verify2(a,o);var d=a.iadd(o);return d.cmp(this.m)>=0&&d.isub(this.m),d},P.prototype.sub=function(a,o){this._verify2(a,o);var d=a.sub(o);return d.cmpn(0)<0&&d.iadd(this.m),d._forceRed(this)},P.prototype.isub=function(a,o){this._verify2(a,o);var d=a.isub(o);return d.cmpn(0)<0&&d.iadd(this.m),d},P.prototype.shl=function(a,o){return this._verify1(a),this.imod(a.ushln(o))},P.prototype.imul=function(a,o){return this._verify2(a,o),this.imod(a.imul(o))},P.prototype.mul=function(a,o){return this._verify2(a,o),this.imod(a.mul(o))},P.prototype.isqr=function(a){return this.imul(a,a.clone())},P.prototype.sqr=function(a){return this.mul(a,a)},P.prototype.sqrt=function(a){if(a.isZero())return a.clone();var o=this.m.andln(3);if(i(o%2===1),o===3){var d=this.m.add(new s(1)).iushrn(2);return this.pow(a,d)}for(var v=this.m.subn(1),y=0;!v.isZero()&&v.andln(1)===0;)y++,v.iushrn(1);i(!v.isZero());var m=new s(1).toRed(this),l=m.redNeg(),p=this.m.subn(1).iushrn(1),f=this.m.bitLength();for(f=new s(2*f*f).toRed(this);this.pow(f,p).cmp(l)!==0;)f.redIAdd(l);for(var x=this.pow(f,v),H=this.pow(a,v.addn(1).iushrn(1)),j=this.pow(a,v),G=y;j.cmp(m)!==0;){for(var B=j,z=0;B.cmp(m)!==0;z++)B=B.redSqr();i(z<G);var q=this.pow(x,new s(1).iushln(G-z-1));H=H.redMul(q),x=q.redSqr(),j=j.redMul(x),G=z}return H},P.prototype.invm=function(a){var o=a._invmp(this.m);return o.negative!==0?(o.negative=0,this.imod(o).redNeg()):this.imod(o)},P.prototype.pow=function(a,o){if(o.isZero())return new s(1).toRed(this);if(o.cmpn(1)===0)return a.clone();var d=4,v=new Array(1<<d);v[0]=new s(1).toRed(this),v[1]=a;for(var y=2;y<v.length;y++)v[y]=this.mul(v[y-1],a);var m=v[0],l=0,p=0,f=o.bitLength()%26;for(f===0&&(f=26),y=o.length-1;y>=0;y--){for(var x=o.words[y],H=f-1;H>=0;H--){var j=x>>H&1;if(m!==v[0]&&(m=this.sqr(m)),j===0&&l===0){p=0;continue}l<<=1,l|=j,p++,!(p!==d&&(y!==0||H!==0))&&(m=this.mul(m,v[l]),p=0,l=0)}f=26}return m},P.prototype.convertTo=function(a){var o=a.umod(this.m);return o===a?o.clone():o},P.prototype.convertFrom=function(a){var o=a.clone();return o.red=null,o},s.mont=function(a){return new w(a)};function w(c){P.call(this,c),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(w,P),w.prototype.convertTo=function(a){return this.imod(a.ushln(this.shift))},w.prototype.convertFrom=function(a){var o=this.imod(a.mul(this.rinv));return o.red=null,o},w.prototype.imul=function(a,o){if(a.isZero()||o.isZero())return a.words[0]=0,a.length=1,a;var d=a.imul(o),v=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),y=d.isub(v).iushrn(this.shift),m=y;return y.cmp(this.m)>=0?m=y.isub(this.m):y.cmpn(0)<0&&(m=y.iadd(this.m)),m._forceRed(this)},w.prototype.mul=function(a,o){if(a.isZero()||o.isZero())return new s(0)._forceRed(this);var d=a.mul(o),v=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),y=d.isub(v).iushrn(this.shift),m=y;return y.cmp(this.m)>=0?m=y.isub(this.m):y.cmpn(0)<0&&(m=y.iadd(this.m)),m._forceRed(this)},w.prototype.invm=function(a){var o=this.imod(a._invmp(this.m).mul(this.r2));return o._forceRed(this)}})(r,Oi)})(To);var yv=To.exports;const Je=cn(yv);var Xn={},et={},ki=Gc;function Gc(r,e){if(!r)throw new Error(e||"Assertion failed")}Gc.equal=function(e,t,i){if(e!=t)throw new Error(i||"Assertion failed: "+e+" != "+t)};var ao={exports:{}};typeof Object.create=="function"?ao.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:ao.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}};var ra=ao.exports,wv=ki,_v=ra;et.inherits=_v;function xv(r,e){return(r.charCodeAt(e)&64512)!==55296||e<0||e+1>=r.length?!1:(r.charCodeAt(e+1)&64512)===56320}function Mv(r,e){if(Array.isArray(r))return r.slice();if(!r)return[];var t=[];if(typeof r=="string")if(e){if(e==="hex")for(r=r.replace(/[^a-z0-9]+/ig,""),r.length%2!==0&&(r="0"+r),n=0;n<r.length;n+=2)t.push(parseInt(r[n]+r[n+1],16))}else for(var i=0,n=0;n<r.length;n++){var s=r.charCodeAt(n);s<128?t[i++]=s:s<2048?(t[i++]=s>>6|192,t[i++]=s&63|128):xv(r,n)?(s=65536+((s&1023)<<10)+(r.charCodeAt(++n)&1023),t[i++]=s>>18|240,t[i++]=s>>12&63|128,t[i++]=s>>6&63|128,t[i++]=s&63|128):(t[i++]=s>>12|224,t[i++]=s>>6&63|128,t[i++]=s&63|128)}else for(n=0;n<r.length;n++)t[n]=r[n]|0;return t}et.toArray=Mv;function Ev(r){for(var e="",t=0;t<r.length;t++)e+=Jc(r[t].toString(16));return e}et.toHex=Ev;function Wc(r){var e=r>>>24|r>>>8&65280|r<<8&16711680|(r&255)<<24;return e>>>0}et.htonl=Wc;function Sv(r,e){for(var t="",i=0;i<r.length;i++){var n=r[i];e==="little"&&(n=Wc(n)),t+=Yc(n.toString(16))}return t}et.toHex32=Sv;function Jc(r){return r.length===1?"0"+r:r}et.zero2=Jc;function Yc(r){return r.length===7?"0"+r:r.length===6?"00"+r:r.length===5?"000"+r:r.length===4?"0000"+r:r.length===3?"00000"+r:r.length===2?"000000"+r:r.length===1?"0000000"+r:r}et.zero8=Yc;function Iv(r,e,t,i){var n=t-e;wv(n%4===0);for(var s=new Array(n/4),h=0,u=e;h<s.length;h++,u+=4){var g;i==="big"?g=r[u]<<24|r[u+1]<<16|r[u+2]<<8|r[u+3]:g=r[u+3]<<24|r[u+2]<<16|r[u+1]<<8|r[u],s[h]=g>>>0}return s}et.join32=Iv;function Av(r,e){for(var t=new Array(r.length*4),i=0,n=0;i<r.length;i++,n+=4){var s=r[i];e==="big"?(t[n]=s>>>24,t[n+1]=s>>>16&255,t[n+2]=s>>>8&255,t[n+3]=s&255):(t[n+3]=s>>>24,t[n+2]=s>>>16&255,t[n+1]=s>>>8&255,t[n]=s&255)}return t}et.split32=Av;function Dv(r,e){return r>>>e|r<<32-e}et.rotr32=Dv;function Pv(r,e){return r<<e|r>>>32-e}et.rotl32=Pv;function Ov(r,e){return r+e>>>0}et.sum32=Ov;function Nv(r,e,t){return r+e+t>>>0}et.sum32_3=Nv;function Rv(r,e,t,i){return r+e+t+i>>>0}et.sum32_4=Rv;function Tv(r,e,t,i,n){return r+e+t+i+n>>>0}et.sum32_5=Tv;function Cv(r,e,t,i){var n=r[e],s=r[e+1],h=i+s>>>0,u=(h<i?1:0)+t+n;r[e]=u>>>0,r[e+1]=h}et.sum64=Cv;function Lv(r,e,t,i){var n=e+i>>>0,s=(n<e?1:0)+r+t;return s>>>0}et.sum64_hi=Lv;function $v(r,e,t,i){var n=e+i;return n>>>0}et.sum64_lo=$v;function Fv(r,e,t,i,n,s,h,u){var g=0,b=e;b=b+i>>>0,g+=b<e?1:0,b=b+s>>>0,g+=b<s?1:0,b=b+u>>>0,g+=b<u?1:0;var _=r+t+n+h+g;return _>>>0}et.sum64_4_hi=Fv;function qv(r,e,t,i,n,s,h,u){var g=e+i+s+u;return g>>>0}et.sum64_4_lo=qv;function Uv(r,e,t,i,n,s,h,u,g,b){var _=0,M=e;M=M+i>>>0,_+=M<e?1:0,M=M+s>>>0,_+=M<s?1:0,M=M+u>>>0,_+=M<u?1:0,M=M+b>>>0,_+=M<b?1:0;var A=r+t+n+h+g+_;return A>>>0}et.sum64_5_hi=Uv;function zv(r,e,t,i,n,s,h,u,g,b){var _=e+i+s+u+b;return _>>>0}et.sum64_5_lo=zv;function Bv(r,e,t){var i=e<<32-t|r>>>t;return i>>>0}et.rotr64_hi=Bv;function kv(r,e,t){var i=r<<32-t|e>>>t;return i>>>0}et.rotr64_lo=kv;function Kv(r,e,t){return r>>>t}et.shr64_hi=Kv;function jv(r,e,t){var i=r<<32-t|e>>>t;return i>>>0}et.shr64_lo=jv;var pn={},Zf=et,Hv=ki;function ia(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}pn.BlockHash=ia;ia.prototype.update=function(e,t){if(e=Zf.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var i=e.length%this._delta8;this.pending=e.slice(e.length-i,e.length),this.pending.length===0&&(this.pending=null),e=Zf.join32(e,0,e.length-i,this.endian);for(var n=0;n<e.length;n+=this._delta32)this._update(e,n,n+this._delta32)}return this};ia.prototype.digest=function(e){return this.update(this._pad()),Hv(this.pending===null),this._digest(e)};ia.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,i=t-(e+this.padLength)%t,n=new Array(i+this.padLength);n[0]=128;for(var s=1;s<i;s++)n[s]=0;if(e<<=3,this.endian==="big"){for(var h=8;h<this.padLength;h++)n[s++]=0;n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=e>>>24&255,n[s++]=e>>>16&255,n[s++]=e>>>8&255,n[s++]=e&255}else for(n[s++]=e&255,n[s++]=e>>>8&255,n[s++]=e>>>16&255,n[s++]=e>>>24&255,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,h=8;h<this.padLength;h++)n[s++]=0;return n};var vn={},Wr={},Vv=et,Br=Vv.rotr32;function Gv(r,e,t,i){if(r===0)return Xc(e,t,i);if(r===1||r===3)return Qc(e,t,i);if(r===2)return Zc(e,t,i)}Wr.ft_1=Gv;function Xc(r,e,t){return r&e^~r&t}Wr.ch32=Xc;function Zc(r,e,t){return r&e^r&t^e&t}Wr.maj32=Zc;function Qc(r,e,t){return r^e^t}Wr.p32=Qc;function Wv(r){return Br(r,2)^Br(r,13)^Br(r,22)}Wr.s0_256=Wv;function Jv(r){return Br(r,6)^Br(r,11)^Br(r,25)}Wr.s1_256=Jv;function Yv(r){return Br(r,7)^Br(r,18)^r>>>3}Wr.g0_256=Yv;function Xv(r){return Br(r,17)^Br(r,19)^r>>>10}Wr.g1_256=Xv;var an=et,Zv=pn,Qv=Wr,Oa=an.rotl32,Dn=an.sum32,eg=an.sum32_5,tg=Qv.ft_1,eu=Zv.BlockHash,rg=[1518500249,1859775393,2400959708,3395469782];function jr(){if(!(this instanceof jr))return new jr;eu.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}an.inherits(jr,eu);var ig=jr;jr.blockSize=512;jr.outSize=160;jr.hmacStrength=80;jr.padLength=64;jr.prototype._update=function(e,t){for(var i=this.W,n=0;n<16;n++)i[n]=e[t+n];for(;n<i.length;n++)i[n]=Oa(i[n-3]^i[n-8]^i[n-14]^i[n-16],1);var s=this.h[0],h=this.h[1],u=this.h[2],g=this.h[3],b=this.h[4];for(n=0;n<i.length;n++){var _=~~(n/20),M=eg(Oa(s,5),tg(_,h,u,g),b,i[n],rg[_]);b=g,g=u,u=Oa(h,30),h=s,s=M}this.h[0]=Dn(this.h[0],s),this.h[1]=Dn(this.h[1],h),this.h[2]=Dn(this.h[2],u),this.h[3]=Dn(this.h[3],g),this.h[4]=Dn(this.h[4],b)};jr.prototype._digest=function(e){return e==="hex"?an.toHex32(this.h,"big"):an.split32(this.h,"big")};var on=et,ng=pn,gn=Wr,sg=ki,Ir=on.sum32,ag=on.sum32_4,og=on.sum32_5,fg=gn.ch32,hg=gn.maj32,cg=gn.s0_256,ug=gn.s1_256,lg=gn.g0_256,dg=gn.g1_256,tu=ng.BlockHash,pg=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Hr(){if(!(this instanceof Hr))return new Hr;tu.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=pg,this.W=new Array(64)}on.inherits(Hr,tu);var ru=Hr;Hr.blockSize=512;Hr.outSize=256;Hr.hmacStrength=192;Hr.padLength=64;Hr.prototype._update=function(e,t){for(var i=this.W,n=0;n<16;n++)i[n]=e[t+n];for(;n<i.length;n++)i[n]=ag(dg(i[n-2]),i[n-7],lg(i[n-15]),i[n-16]);var s=this.h[0],h=this.h[1],u=this.h[2],g=this.h[3],b=this.h[4],_=this.h[5],M=this.h[6],A=this.h[7];for(sg(this.k.length===i.length),n=0;n<i.length;n++){var I=og(A,ug(b),fg(b,_,M),this.k[n],i[n]),D=Ir(cg(s),hg(s,h,u));A=M,M=_,_=b,b=Ir(g,I),g=u,u=h,h=s,s=Ir(I,D)}this.h[0]=Ir(this.h[0],s),this.h[1]=Ir(this.h[1],h),this.h[2]=Ir(this.h[2],u),this.h[3]=Ir(this.h[3],g),this.h[4]=Ir(this.h[4],b),this.h[5]=Ir(this.h[5],_),this.h[6]=Ir(this.h[6],M),this.h[7]=Ir(this.h[7],A)};Hr.prototype._digest=function(e){return e==="hex"?on.toHex32(this.h,"big"):on.split32(this.h,"big")};var oo=et,iu=ru;function si(){if(!(this instanceof si))return new si;iu.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}oo.inherits(si,iu);var vg=si;si.blockSize=512;si.outSize=224;si.hmacStrength=192;si.padLength=64;si.prototype._digest=function(e){return e==="hex"?oo.toHex32(this.h.slice(0,7),"big"):oo.split32(this.h.slice(0,7),"big")};var jt=et,gg=pn,bg=ki,kr=jt.rotr64_hi,Kr=jt.rotr64_lo,nu=jt.shr64_hi,su=jt.shr64_lo,ci=jt.sum64,Na=jt.sum64_hi,Ra=jt.sum64_lo,mg=jt.sum64_4_hi,yg=jt.sum64_4_lo,wg=jt.sum64_5_hi,_g=jt.sum64_5_lo,au=gg.BlockHash,xg=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Rr(){if(!(this instanceof Rr))return new Rr;au.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=xg,this.W=new Array(160)}jt.inherits(Rr,au);var ou=Rr;Rr.blockSize=1024;Rr.outSize=512;Rr.hmacStrength=192;Rr.padLength=128;Rr.prototype._prepareBlock=function(e,t){for(var i=this.W,n=0;n<32;n++)i[n]=e[t+n];for(;n<i.length;n+=2){var s=Tg(i[n-4],i[n-3]),h=Cg(i[n-4],i[n-3]),u=i[n-14],g=i[n-13],b=Ng(i[n-30],i[n-29]),_=Rg(i[n-30],i[n-29]),M=i[n-32],A=i[n-31];i[n]=mg(s,h,u,g,b,_,M,A),i[n+1]=yg(s,h,u,g,b,_,M,A)}};Rr.prototype._update=function(e,t){this._prepareBlock(e,t);var i=this.W,n=this.h[0],s=this.h[1],h=this.h[2],u=this.h[3],g=this.h[4],b=this.h[5],_=this.h[6],M=this.h[7],A=this.h[8],I=this.h[9],D=this.h[10],N=this.h[11],U=this.h[12],k=this.h[13],T=this.h[14],K=this.h[15];bg(this.k.length===i.length);for(var R=0;R<i.length;R+=2){var C=T,$=K,E=Pg(A,I),O=Og(A,I),J=Mg(A,I,D,N,U),Z=Eg(A,I,D,N,U,k),P=this.k[R],w=this.k[R+1],c=i[R],a=i[R+1],o=wg(C,$,E,O,J,Z,P,w,c,a),d=_g(C,$,E,O,J,Z,P,w,c,a);C=Ag(n,s),$=Dg(n,s),E=Sg(n,s,h,u,g),O=Ig(n,s,h,u,g,b);var v=Na(C,$,E,O),y=Ra(C,$,E,O);T=U,K=k,U=D,k=N,D=A,N=I,A=Na(_,M,o,d),I=Ra(M,M,o,d),_=g,M=b,g=h,b=u,h=n,u=s,n=Na(o,d,v,y),s=Ra(o,d,v,y)}ci(this.h,0,n,s),ci(this.h,2,h,u),ci(this.h,4,g,b),ci(this.h,6,_,M),ci(this.h,8,A,I),ci(this.h,10,D,N),ci(this.h,12,U,k),ci(this.h,14,T,K)};Rr.prototype._digest=function(e){return e==="hex"?jt.toHex32(this.h,"big"):jt.split32(this.h,"big")};function Mg(r,e,t,i,n){var s=r&t^~r&n;return s<0&&(s+=4294967296),s}function Eg(r,e,t,i,n,s){var h=e&i^~e&s;return h<0&&(h+=4294967296),h}function Sg(r,e,t,i,n){var s=r&t^r&n^t&n;return s<0&&(s+=4294967296),s}function Ig(r,e,t,i,n,s){var h=e&i^e&s^i&s;return h<0&&(h+=4294967296),h}function Ag(r,e){var t=kr(r,e,28),i=kr(e,r,2),n=kr(e,r,7),s=t^i^n;return s<0&&(s+=4294967296),s}function Dg(r,e){var t=Kr(r,e,28),i=Kr(e,r,2),n=Kr(e,r,7),s=t^i^n;return s<0&&(s+=4294967296),s}function Pg(r,e){var t=kr(r,e,14),i=kr(r,e,18),n=kr(e,r,9),s=t^i^n;return s<0&&(s+=4294967296),s}function Og(r,e){var t=Kr(r,e,14),i=Kr(r,e,18),n=Kr(e,r,9),s=t^i^n;return s<0&&(s+=4294967296),s}function Ng(r,e){var t=kr(r,e,1),i=kr(r,e,8),n=nu(r,e,7),s=t^i^n;return s<0&&(s+=4294967296),s}function Rg(r,e){var t=Kr(r,e,1),i=Kr(r,e,8),n=su(r,e,7),s=t^i^n;return s<0&&(s+=4294967296),s}function Tg(r,e){var t=kr(r,e,19),i=kr(e,r,29),n=nu(r,e,6),s=t^i^n;return s<0&&(s+=4294967296),s}function Cg(r,e){var t=Kr(r,e,19),i=Kr(e,r,29),n=su(r,e,6),s=t^i^n;return s<0&&(s+=4294967296),s}var fo=et,fu=ou;function ai(){if(!(this instanceof ai))return new ai;fu.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}fo.inherits(ai,fu);var Lg=ai;ai.blockSize=1024;ai.outSize=384;ai.hmacStrength=192;ai.padLength=128;ai.prototype._digest=function(e){return e==="hex"?fo.toHex32(this.h.slice(0,12),"big"):fo.split32(this.h.slice(0,12),"big")};vn.sha1=ig;vn.sha224=vg;vn.sha256=ru;vn.sha384=Lg;vn.sha512=ou;var hu={},$i=et,$g=pn,gs=$i.rotl32,Qf=$i.sum32,Pn=$i.sum32_3,eh=$i.sum32_4,cu=$g.BlockHash;function Vr(){if(!(this instanceof Vr))return new Vr;cu.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}$i.inherits(Vr,cu);hu.ripemd160=Vr;Vr.blockSize=512;Vr.outSize=160;Vr.hmacStrength=192;Vr.padLength=64;Vr.prototype._update=function(e,t){for(var i=this.h[0],n=this.h[1],s=this.h[2],h=this.h[3],u=this.h[4],g=i,b=n,_=s,M=h,A=u,I=0;I<80;I++){var D=Qf(gs(eh(i,th(I,n,s,h),e[Ug[I]+t],Fg(I)),Bg[I]),u);i=u,u=h,h=gs(s,10),s=n,n=D,D=Qf(gs(eh(g,th(79-I,b,_,M),e[zg[I]+t],qg(I)),kg[I]),A),g=A,A=M,M=gs(_,10),_=b,b=D}D=Pn(this.h[1],s,M),this.h[1]=Pn(this.h[2],h,A),this.h[2]=Pn(this.h[3],u,g),this.h[3]=Pn(this.h[4],i,b),this.h[4]=Pn(this.h[0],n,_),this.h[0]=D};Vr.prototype._digest=function(e){return e==="hex"?$i.toHex32(this.h,"little"):$i.split32(this.h,"little")};function th(r,e,t,i){return r<=15?e^t^i:r<=31?e&t|~e&i:r<=47?(e|~t)^i:r<=63?e&i|t&~i:e^(t|~i)}function Fg(r){return r<=15?0:r<=31?1518500249:r<=47?1859775393:r<=63?2400959708:2840853838}function qg(r){return r<=15?1352829926:r<=31?1548603684:r<=47?1836072691:r<=63?2053994217:0}var Ug=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],zg=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],Bg=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],kg=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],Kg=et,jg=ki;function fn(r,e,t){if(!(this instanceof fn))return new fn(r,e,t);this.Hash=r,this.blockSize=r.blockSize/8,this.outSize=r.outSize/8,this.inner=null,this.outer=null,this._init(Kg.toArray(e,t))}var Hg=fn;fn.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),jg(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=new this.Hash().update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=new this.Hash().update(e)};fn.prototype.update=function(e,t){return this.inner.update(e,t),this};fn.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)};(function(r){var e=r;e.utils=et,e.common=pn,e.sha=vn,e.ripemd=hu,e.hmac=Hg,e.sha1=e.sha.sha1,e.sha256=e.sha.sha256,e.sha224=e.sha.sha224,e.sha384=e.sha.sha384,e.sha512=e.sha.sha512,e.ripemd160=e.ripemd.ripemd160})(Xn);const Qr=cn(Xn);function bn(r,e,t){return t={path:e,exports:{},require:function(i,n){return Vg(i,n??t.path)}},r(t,t.exports),t.exports}function Vg(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var Co=uu;function uu(r,e){if(!r)throw new Error(e||"Assertion failed")}uu.equal=function(e,t,i){if(e!=t)throw new Error(i||"Assertion failed: "+e+" != "+t)};var Nr=bn(function(r,e){var t=e;function i(h,u){if(Array.isArray(h))return h.slice();if(!h)return[];var g=[];if(typeof h!="string"){for(var b=0;b<h.length;b++)g[b]=h[b]|0;return g}if(u==="hex"){h=h.replace(/[^a-z0-9]+/ig,""),h.length%2!==0&&(h="0"+h);for(var b=0;b<h.length;b+=2)g.push(parseInt(h[b]+h[b+1],16))}else for(var b=0;b<h.length;b++){var _=h.charCodeAt(b),M=_>>8,A=_&255;M?g.push(M,A):g.push(A)}return g}t.toArray=i;function n(h){return h.length===1?"0"+h:h}t.zero2=n;function s(h){for(var u="",g=0;g<h.length;g++)u+=n(h[g].toString(16));return u}t.toHex=s,t.encode=function(u,g){return g==="hex"?s(u):u}}),ur=bn(function(r,e){var t=e;t.assert=Co,t.toArray=Nr.toArray,t.zero2=Nr.zero2,t.toHex=Nr.toHex,t.encode=Nr.encode;function i(g,b,_){var M=new Array(Math.max(g.bitLength(),_)+1);M.fill(0);for(var A=1<<b+1,I=g.clone(),D=0;D<M.length;D++){var N,U=I.andln(A-1);I.isOdd()?(U>(A>>1)-1?N=(A>>1)-U:N=U,I.isubn(N)):N=0,M[D]=N,I.iushrn(1)}return M}t.getNAF=i;function n(g,b){var _=[[],[]];g=g.clone(),b=b.clone();for(var M=0,A=0,I;g.cmpn(-M)>0||b.cmpn(-A)>0;){var D=g.andln(3)+M&3,N=b.andln(3)+A&3;D===3&&(D=-1),N===3&&(N=-1);var U;D&1?(I=g.andln(7)+M&7,(I===3||I===5)&&N===2?U=-D:U=D):U=0,_[0].push(U);var k;N&1?(I=b.andln(7)+A&7,(I===3||I===5)&&D===2?k=-N:k=N):k=0,_[1].push(k),2*M===U+1&&(M=1-M),2*A===k+1&&(A=1-A),g.iushrn(1),b.iushrn(1)}return _}t.getJSF=n;function s(g,b,_){var M="_"+b;g.prototype[b]=function(){return this[M]!==void 0?this[M]:this[M]=_.call(this)}}t.cachedProperty=s;function h(g){return typeof g=="string"?t.toArray(g,"hex"):g}t.parseBytes=h;function u(g){return new Je(g,"hex","le")}t.intFromLE=u}),$s=ur.getNAF,Gg=ur.getJSF,Fs=ur.assert;function mi(r,e){this.type=r,this.p=new Je(e.p,16),this.red=e.prime?Je.red(e.prime):Je.mont(this.p),this.zero=new Je(0).toRed(this.red),this.one=new Je(1).toRed(this.red),this.two=new Je(2).toRed(this.red),this.n=e.n&&new Je(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var t=this.n&&this.p.div(this.n);!t||t.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var Ki=mi;mi.prototype.point=function(){throw new Error("Not implemented")};mi.prototype.validate=function(){throw new Error("Not implemented")};mi.prototype._fixedNafMul=function(e,t){Fs(e.precomputed);var i=e._getDoubles(),n=$s(t,1,this._bitLength),s=(1<<i.step+1)-(i.step%2===0?2:1);s/=3;var h=[],u,g;for(u=0;u<n.length;u+=i.step){g=0;for(var b=u+i.step-1;b>=u;b--)g=(g<<1)+n[b];h.push(g)}for(var _=this.jpoint(null,null,null),M=this.jpoint(null,null,null),A=s;A>0;A--){for(u=0;u<h.length;u++)g=h[u],g===A?M=M.mixedAdd(i.points[u]):g===-A&&(M=M.mixedAdd(i.points[u].neg()));_=_.add(M)}return _.toP()};mi.prototype._wnafMul=function(e,t){var i=4,n=e._getNAFPoints(i);i=n.wnd;for(var s=n.points,h=$s(t,i,this._bitLength),u=this.jpoint(null,null,null),g=h.length-1;g>=0;g--){for(var b=0;g>=0&&h[g]===0;g--)b++;if(g>=0&&b++,u=u.dblp(b),g<0)break;var _=h[g];Fs(_!==0),e.type==="affine"?_>0?u=u.mixedAdd(s[_-1>>1]):u=u.mixedAdd(s[-_-1>>1].neg()):_>0?u=u.add(s[_-1>>1]):u=u.add(s[-_-1>>1].neg())}return e.type==="affine"?u.toP():u};mi.prototype._wnafMulAdd=function(e,t,i,n,s){var h=this._wnafT1,u=this._wnafT2,g=this._wnafT3,b=0,_,M,A;for(_=0;_<n;_++){A=t[_];var I=A._getNAFPoints(e);h[_]=I.wnd,u[_]=I.points}for(_=n-1;_>=1;_-=2){var D=_-1,N=_;if(h[D]!==1||h[N]!==1){g[D]=$s(i[D],h[D],this._bitLength),g[N]=$s(i[N],h[N],this._bitLength),b=Math.max(g[D].length,b),b=Math.max(g[N].length,b);continue}var U=[t[D],null,null,t[N]];t[D].y.cmp(t[N].y)===0?(U[1]=t[D].add(t[N]),U[2]=t[D].toJ().mixedAdd(t[N].neg())):t[D].y.cmp(t[N].y.redNeg())===0?(U[1]=t[D].toJ().mixedAdd(t[N]),U[2]=t[D].add(t[N].neg())):(U[1]=t[D].toJ().mixedAdd(t[N]),U[2]=t[D].toJ().mixedAdd(t[N].neg()));var k=[-3,-1,-5,-7,0,7,5,1,3],T=Gg(i[D],i[N]);for(b=Math.max(T[0].length,b),g[D]=new Array(b),g[N]=new Array(b),M=0;M<b;M++){var K=T[0][M]|0,R=T[1][M]|0;g[D][M]=k[(K+1)*3+(R+1)],g[N][M]=0,u[D]=U}}var C=this.jpoint(null,null,null),$=this._wnafT4;for(_=b;_>=0;_--){for(var E=0;_>=0;){var O=!0;for(M=0;M<n;M++)$[M]=g[M][_]|0,$[M]!==0&&(O=!1);if(!O)break;E++,_--}if(_>=0&&E++,C=C.dblp(E),_<0)break;for(M=0;M<n;M++){var J=$[M];J!==0&&(J>0?A=u[M][J-1>>1]:J<0&&(A=u[M][-J-1>>1].neg()),A.type==="affine"?C=C.mixedAdd(A):C=C.add(A))}}for(_=0;_<n;_++)u[_]=null;return s?C:C.toP()};function _r(r,e){this.curve=r,this.type=e,this.precomputed=null}mi.BasePoint=_r;_r.prototype.eq=function(){throw new Error("Not implemented")};_r.prototype.validate=function(){return this.curve.validate(this)};mi.prototype.decodePoint=function(e,t){e=ur.toArray(e,t);var i=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*i){e[0]===6?Fs(e[e.length-1]%2===0):e[0]===7&&Fs(e[e.length-1]%2===1);var n=this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));return n}else if((e[0]===2||e[0]===3)&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),e[0]===3);throw new Error("Unknown point format")};_r.prototype.encodeCompressed=function(e){return this.encode(e,!0)};_r.prototype._encode=function(e){var t=this.curve.p.byteLength(),i=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",t))};_r.prototype.encode=function(e,t){return ur.encode(this._encode(t),e)};_r.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this};_r.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return t?t.points.length>=Math.ceil((e.bitLength()+1)/t.step):!1};_r.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],n=this,s=0;s<t;s+=e){for(var h=0;h<e;h++)n=n.dbl();i.push(n)}return{step:e,points:i}};_r.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],i=(1<<e)-1,n=i===1?null:this.dbl(),s=1;s<i;s++)t[s]=t[s-1].add(n);return{wnd:e,points:t}};_r.prototype._getBeta=function(){return null};_r.prototype.dblp=function(e){for(var t=this,i=0;i<e;i++)t=t.dbl();return t};var Lo=bn(function(r){typeof Object.create=="function"?r.exports=function(t,i){i&&(t.super_=i,t.prototype=Object.create(i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:r.exports=function(t,i){if(i){t.super_=i;var n=function(){};n.prototype=i.prototype,t.prototype=new n,t.prototype.constructor=t}}}),Wg=ur.assert;function xr(r){Ki.call(this,"short",r),this.a=new Je(r.a,16).toRed(this.red),this.b=new Je(r.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(r),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}Lo(xr,Ki);var Jg=xr;xr.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var t,i;if(e.beta)t=new Je(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);t=n[0].cmp(n[1])<0?n[0]:n[1],t=t.toRed(this.red)}if(e.lambda)i=new Je(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(t))===0?i=s[0]:(i=s[1],Wg(this.g.mul(i).x.cmp(this.g.x.redMul(t))===0))}var h;return e.basis?h=e.basis.map(function(u){return{a:new Je(u.a,16),b:new Je(u.b,16)}}):h=this._getEndoBasis(i),{beta:t,lambda:i,basis:h}}};xr.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:Je.mont(e),i=new Je(2).toRed(t).redInvm(),n=i.redNeg(),s=new Je(3).toRed(t).redNeg().redSqrt().redMul(i),h=n.redAdd(s).fromRed(),u=n.redSub(s).fromRed();return[h,u]};xr.prototype._getEndoBasis=function(e){for(var t=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=e,n=this.n.clone(),s=new Je(1),h=new Je(0),u=new Je(0),g=new Je(1),b,_,M,A,I,D,N,U=0,k,T;i.cmpn(0)!==0;){var K=n.div(i);k=n.sub(K.mul(i)),T=u.sub(K.mul(s));var R=g.sub(K.mul(h));if(!M&&k.cmp(t)<0)b=N.neg(),_=s,M=k.neg(),A=T;else if(M&&++U===2)break;N=k,n=i,i=k,u=s,s=T,g=h,h=R}I=k.neg(),D=T;var C=M.sqr().add(A.sqr()),$=I.sqr().add(D.sqr());return $.cmp(C)>=0&&(I=b,D=_),M.negative&&(M=M.neg(),A=A.neg()),I.negative&&(I=I.neg(),D=D.neg()),[{a:M,b:A},{a:I,b:D}]};xr.prototype._endoSplit=function(e){var t=this.endo.basis,i=t[0],n=t[1],s=n.b.mul(e).divRound(this.n),h=i.b.neg().mul(e).divRound(this.n),u=s.mul(i.a),g=h.mul(n.a),b=s.mul(i.b),_=h.mul(n.b),M=e.sub(u).sub(g),A=b.add(_).neg();return{k1:M,k2:A}};xr.prototype.pointFromX=function(e,t){e=new Je(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=i.redSqrt();if(n.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var s=n.fromRed().isOdd();return(t&&!s||!t&&s)&&(n=n.redNeg()),this.point(e,n)};xr.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,i=e.y,n=this.a.redMul(t),s=t.redSqr().redMul(t).redIAdd(n).redIAdd(this.b);return i.redSqr().redISub(s).cmpn(0)===0};xr.prototype._endoWnafMulAdd=function(e,t,i){for(var n=this._endoWnafT1,s=this._endoWnafT2,h=0;h<e.length;h++){var u=this._endoSplit(t[h]),g=e[h],b=g._getBeta();u.k1.negative&&(u.k1.ineg(),g=g.neg(!0)),u.k2.negative&&(u.k2.ineg(),b=b.neg(!0)),n[h*2]=g,n[h*2+1]=b,s[h*2]=u.k1,s[h*2+1]=u.k2}for(var _=this._wnafMulAdd(1,n,s,h*2,i),M=0;M<h*2;M++)n[M]=null,s[M]=null;return _};function St(r,e,t,i){Ki.BasePoint.call(this,r,"affine"),e===null&&t===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new Je(e,16),this.y=new Je(t,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}Lo(St,Ki.BasePoint);xr.prototype.point=function(e,t,i){return new St(this,e,t,i)};xr.prototype.pointFromJSON=function(e,t){return St.fromJSON(this,e,t)};St.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,n=function(s){return i.point(s.x.redMul(i.endo.beta),s.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return t}};St.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};St.fromJSON=function(e,t,i){typeof t=="string"&&(t=JSON.parse(t));var n=e.point(t[0],t[1],i);if(!t[2])return n;function s(u){return e.point(u[0],u[1],i)}var h=t[2];return n.precomputed={beta:null,doubles:h.doubles&&{step:h.doubles.step,points:[n].concat(h.doubles.points.map(s))},naf:h.naf&&{wnd:h.naf.wnd,points:[n].concat(h.naf.points.map(s))}},n};St.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};St.prototype.isInfinity=function(){return this.inf};St.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var t=this.y.redSub(e.y);t.cmpn(0)!==0&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var i=t.redSqr().redISub(this.x).redISub(e.x),n=t.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)};St.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var t=this.curve.a,i=this.x.redSqr(),n=e.redInvm(),s=i.redAdd(i).redIAdd(i).redIAdd(t).redMul(n),h=s.redSqr().redISub(this.x.redAdd(this.x)),u=s.redMul(this.x.redSub(h)).redISub(this.y);return this.curve.point(h,u)};St.prototype.getX=function(){return this.x.fromRed()};St.prototype.getY=function(){return this.y.fromRed()};St.prototype.mul=function(e){return e=new Je(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};St.prototype.mulAdd=function(e,t,i){var n=[this,t],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s):this.curve._wnafMulAdd(1,n,s,2)};St.prototype.jmulAdd=function(e,t,i){var n=[this,t],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s,!0):this.curve._wnafMulAdd(1,n,s,2,!0)};St.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};St.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,n=function(s){return s.neg()};t.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(n)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(n)}}}return t};St.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function Pt(r,e,t,i){Ki.BasePoint.call(this,r,"jacobian"),e===null&&t===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new Je(0)):(this.x=new Je(e,16),this.y=new Je(t,16),this.z=new Je(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}Lo(Pt,Ki.BasePoint);xr.prototype.jpoint=function(e,t,i){return new Pt(this,e,t,i)};Pt.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),i=this.x.redMul(t),n=this.y.redMul(t).redMul(e);return this.curve.point(i,n)};Pt.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};Pt.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),i=this.z.redSqr(),n=this.x.redMul(t),s=e.x.redMul(i),h=this.y.redMul(t.redMul(e.z)),u=e.y.redMul(i.redMul(this.z)),g=n.redSub(s),b=h.redSub(u);if(g.cmpn(0)===0)return b.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var _=g.redSqr(),M=_.redMul(g),A=n.redMul(_),I=b.redSqr().redIAdd(M).redISub(A).redISub(A),D=b.redMul(A.redISub(I)).redISub(h.redMul(M)),N=this.z.redMul(e.z).redMul(g);return this.curve.jpoint(I,D,N)};Pt.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),i=this.x,n=e.x.redMul(t),s=this.y,h=e.y.redMul(t).redMul(this.z),u=i.redSub(n),g=s.redSub(h);if(u.cmpn(0)===0)return g.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var b=u.redSqr(),_=b.redMul(u),M=i.redMul(b),A=g.redSqr().redIAdd(_).redISub(M).redISub(M),I=g.redMul(M.redISub(A)).redISub(s.redMul(_)),D=this.z.redMul(u);return this.curve.jpoint(A,I,D)};Pt.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var i=this;for(t=0;t<e;t++)i=i.dbl();return i}var n=this.curve.a,s=this.curve.tinv,h=this.x,u=this.y,g=this.z,b=g.redSqr().redSqr(),_=u.redAdd(u);for(t=0;t<e;t++){var M=h.redSqr(),A=_.redSqr(),I=A.redSqr(),D=M.redAdd(M).redIAdd(M).redIAdd(n.redMul(b)),N=h.redMul(A),U=D.redSqr().redISub(N.redAdd(N)),k=N.redISub(U),T=D.redMul(k);T=T.redIAdd(T).redISub(I);var K=_.redMul(g);t+1<e&&(b=b.redMul(I)),h=U,g=K,_=T}return this.curve.jpoint(h,_.redMul(s),g)};Pt.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};Pt.prototype._zeroDbl=function(){var e,t,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),h=s.redSqr(),u=this.x.redAdd(s).redSqr().redISub(n).redISub(h);u=u.redIAdd(u);var g=n.redAdd(n).redIAdd(n),b=g.redSqr().redISub(u).redISub(u),_=h.redIAdd(h);_=_.redIAdd(_),_=_.redIAdd(_),e=b,t=g.redMul(u.redISub(b)).redISub(_),i=this.y.redAdd(this.y)}else{var M=this.x.redSqr(),A=this.y.redSqr(),I=A.redSqr(),D=this.x.redAdd(A).redSqr().redISub(M).redISub(I);D=D.redIAdd(D);var N=M.redAdd(M).redIAdd(M),U=N.redSqr(),k=I.redIAdd(I);k=k.redIAdd(k),k=k.redIAdd(k),e=U.redISub(D).redISub(D),t=N.redMul(D.redISub(e)).redISub(k),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(e,t,i)};Pt.prototype._threeDbl=function(){var e,t,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),h=s.redSqr(),u=this.x.redAdd(s).redSqr().redISub(n).redISub(h);u=u.redIAdd(u);var g=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),b=g.redSqr().redISub(u).redISub(u);e=b;var _=h.redIAdd(h);_=_.redIAdd(_),_=_.redIAdd(_),t=g.redMul(u.redISub(b)).redISub(_),i=this.y.redAdd(this.y)}else{var M=this.z.redSqr(),A=this.y.redSqr(),I=this.x.redMul(A),D=this.x.redSub(M).redMul(this.x.redAdd(M));D=D.redAdd(D).redIAdd(D);var N=I.redIAdd(I);N=N.redIAdd(N);var U=N.redAdd(N);e=D.redSqr().redISub(U),i=this.y.redAdd(this.z).redSqr().redISub(A).redISub(M);var k=A.redSqr();k=k.redIAdd(k),k=k.redIAdd(k),k=k.redIAdd(k),t=D.redMul(N.redISub(e)).redISub(k)}return this.curve.jpoint(e,t,i)};Pt.prototype._dbl=function(){var e=this.curve.a,t=this.x,i=this.y,n=this.z,s=n.redSqr().redSqr(),h=t.redSqr(),u=i.redSqr(),g=h.redAdd(h).redIAdd(h).redIAdd(e.redMul(s)),b=t.redAdd(t);b=b.redIAdd(b);var _=b.redMul(u),M=g.redSqr().redISub(_.redAdd(_)),A=_.redISub(M),I=u.redSqr();I=I.redIAdd(I),I=I.redIAdd(I),I=I.redIAdd(I);var D=g.redMul(A).redISub(I),N=i.redAdd(i).redMul(n);return this.curve.jpoint(M,D,N)};Pt.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr(),n=t.redSqr(),s=e.redAdd(e).redIAdd(e),h=s.redSqr(),u=this.x.redAdd(t).redSqr().redISub(e).redISub(n);u=u.redIAdd(u),u=u.redAdd(u).redIAdd(u),u=u.redISub(h);var g=u.redSqr(),b=n.redIAdd(n);b=b.redIAdd(b),b=b.redIAdd(b),b=b.redIAdd(b);var _=s.redIAdd(u).redSqr().redISub(h).redISub(g).redISub(b),M=t.redMul(_);M=M.redIAdd(M),M=M.redIAdd(M);var A=this.x.redMul(g).redISub(M);A=A.redIAdd(A),A=A.redIAdd(A);var I=this.y.redMul(_.redMul(b.redISub(_)).redISub(u.redMul(g)));I=I.redIAdd(I),I=I.redIAdd(I),I=I.redIAdd(I);var D=this.z.redAdd(u).redSqr().redISub(i).redISub(g);return this.curve.jpoint(A,I,D)};Pt.prototype.mul=function(e,t){return e=new Je(e,t),this.curve._wnafMul(this,e)};Pt.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),i=e.z.redSqr();if(this.x.redMul(i).redISub(e.x.redMul(t)).cmpn(0)!==0)return!1;var n=t.redMul(this.z),s=i.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(n)).cmpn(0)===0};Pt.prototype.eqXToP=function(e){var t=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(t);if(this.x.cmp(i)===0)return!0;for(var n=e.clone(),s=this.curve.redN.redMul(t);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(s),this.x.cmp(i)===0)return!0}};Pt.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};Pt.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var xs=bn(function(r,e){var t=e;t.base=Ki,t.short=Jg,t.mont=null,t.edwards=null}),Ms=bn(function(r,e){var t=e,i=ur.assert;function n(u){u.type==="short"?this.curve=new xs.short(u):u.type==="edwards"?this.curve=new xs.edwards(u):this.curve=new xs.mont(u),this.g=this.curve.g,this.n=this.curve.n,this.hash=u.hash,i(this.g.validate(),"Invalid curve"),i(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}t.PresetCurve=n;function s(u,g){Object.defineProperty(t,u,{configurable:!0,enumerable:!0,get:function(){var b=new n(g);return Object.defineProperty(t,u,{configurable:!0,enumerable:!0,value:b}),b}})}s("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:Qr.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),s("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:Qr.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),s("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:Qr.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),s("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:Qr.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),s("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:Qr.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),s("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Qr.sha256,gRed:!1,g:["9"]}),s("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Qr.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var h;try{h=null.crash()}catch{h=void 0}s("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:Qr.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",h]})});function vi(r){if(!(this instanceof vi))return new vi(r);this.hash=r.hash,this.predResist=!!r.predResist,this.outLen=this.hash.outSize,this.minEntropy=r.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=Nr.toArray(r.entropy,r.entropyEnc||"hex"),t=Nr.toArray(r.nonce,r.nonceEnc||"hex"),i=Nr.toArray(r.pers,r.persEnc||"hex");Co(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,t,i)}var lu=vi;vi.prototype._init=function(e,t,i){var n=e.concat(t).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656};vi.prototype._hmac=function(){return new Qr.hmac(this.hash,this.K)};vi.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())};vi.prototype.reseed=function(e,t,i,n){typeof t!="string"&&(n=i,i=t,t=null),e=Nr.toArray(e,t),i=Nr.toArray(i,n),Co(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1};vi.prototype.generate=function(e,t,i,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof t!="string"&&(n=i,i=t,t=null),i&&(i=Nr.toArray(i,n||"hex"),this._update(i));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var h=s.slice(0,e);return this._update(i),this._reseed++,Nr.encode(h,t)};var ho=ur.assert;function Lt(r,e){this.ec=r,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var $o=Lt;Lt.fromPublic=function(e,t,i){return t instanceof Lt?t:new Lt(e,{pub:t,pubEnc:i})};Lt.fromPrivate=function(e,t,i){return t instanceof Lt?t:new Lt(e,{priv:t,privEnc:i})};Lt.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};Lt.prototype.getPublic=function(e,t){return typeof e=="string"&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub};Lt.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};Lt.prototype._importPrivate=function(e,t){this.priv=new Je(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)};Lt.prototype._importPublic=function(e,t){if(e.x||e.y){this.ec.curve.type==="mont"?ho(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&ho(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,t)};Lt.prototype.derive=function(e){return e.validate()||ho(e.validate(),"public point not validated"),e.mul(this.priv).getX()};Lt.prototype.sign=function(e,t,i){return this.ec.sign(e,this,t,i)};Lt.prototype.verify=function(e,t){return this.ec.verify(e,t,this)};Lt.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var Yg=ur.assert;function na(r,e){if(r instanceof na)return r;this._importDER(r,e)||(Yg(r.r&&r.s,"Signature without r or s"),this.r=new Je(r.r,16),this.s=new Je(r.s,16),r.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=r.recoveryParam)}var sa=na;function Xg(){this.place=0}function Ta(r,e){var t=r[e.place++];if(!(t&128))return t;var i=t&15;if(i===0||i>4)return!1;for(var n=0,s=0,h=e.place;s<i;s++,h++)n<<=8,n|=r[h],n>>>=0;return n<=127?!1:(e.place=h,n)}function rh(r){for(var e=0,t=r.length-1;!r[e]&&!(r[e+1]&128)&&e<t;)e++;return e===0?r:r.slice(e)}na.prototype._importDER=function(e,t){e=ur.toArray(e,t);var i=new Xg;if(e[i.place++]!==48)return!1;var n=Ta(e,i);if(n===!1||n+i.place!==e.length||e[i.place++]!==2)return!1;var s=Ta(e,i);if(s===!1)return!1;var h=e.slice(i.place,s+i.place);if(i.place+=s,e[i.place++]!==2)return!1;var u=Ta(e,i);if(u===!1||e.length!==u+i.place)return!1;var g=e.slice(i.place,u+i.place);if(h[0]===0)if(h[1]&128)h=h.slice(1);else return!1;if(g[0]===0)if(g[1]&128)g=g.slice(1);else return!1;return this.r=new Je(h),this.s=new Je(g),this.recoveryParam=null,!0};function Ca(r,e){if(e<128){r.push(e);return}var t=1+(Math.log(e)/Math.LN2>>>3);for(r.push(t|128);--t;)r.push(e>>>(t<<3)&255);r.push(e)}na.prototype.toDER=function(e){var t=this.r.toArray(),i=this.s.toArray();for(t[0]&128&&(t=[0].concat(t)),i[0]&128&&(i=[0].concat(i)),t=rh(t),i=rh(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var n=[2];Ca(n,t.length),n=n.concat(t),n.push(2),Ca(n,i.length);var s=n.concat(i),h=[48];return Ca(h,s.length),h=h.concat(s),ur.encode(h,e)};var Zg=function(){throw new Error("unsupported")},du=ur.assert;function yr(r){if(!(this instanceof yr))return new yr(r);typeof r=="string"&&(du(Object.prototype.hasOwnProperty.call(Ms,r),"Unknown curve "+r),r=Ms[r]),r instanceof Ms.PresetCurve&&(r={curve:r}),this.curve=r.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=r.curve.g,this.g.precompute(r.curve.n.bitLength()+1),this.hash=r.hash||r.curve.hash}var Qg=yr;yr.prototype.keyPair=function(e){return new $o(this,e)};yr.prototype.keyFromPrivate=function(e,t){return $o.fromPrivate(this,e,t)};yr.prototype.keyFromPublic=function(e,t){return $o.fromPublic(this,e,t)};yr.prototype.genKeyPair=function(e){e||(e={});for(var t=new lu({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||Zg(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),n=this.n.sub(new Je(2));;){var s=new Je(t.generate(i));if(!(s.cmp(n)>0))return s.iaddn(1),this.keyFromPrivate(s)}};yr.prototype._truncateToN=function(e,t){var i=e.byteLength()*8-this.n.bitLength();return i>0&&(e=e.ushrn(i)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e};yr.prototype.sign=function(e,t,i,n){typeof i=="object"&&(n=i,i=null),n||(n={}),t=this.keyFromPrivate(t,i),e=this._truncateToN(new Je(e,16));for(var s=this.n.byteLength(),h=t.getPrivate().toArray("be",s),u=e.toArray("be",s),g=new lu({hash:this.hash,entropy:h,nonce:u,pers:n.pers,persEnc:n.persEnc||"utf8"}),b=this.n.sub(new Je(1)),_=0;;_++){var M=n.k?n.k(_):new Je(g.generate(this.n.byteLength()));if(M=this._truncateToN(M,!0),!(M.cmpn(1)<=0||M.cmp(b)>=0)){var A=this.g.mul(M);if(!A.isInfinity()){var I=A.getX(),D=I.umod(this.n);if(D.cmpn(0)!==0){var N=M.invm(this.n).mul(D.mul(t.getPrivate()).iadd(e));if(N=N.umod(this.n),N.cmpn(0)!==0){var U=(A.getY().isOdd()?1:0)|(I.cmp(D)!==0?2:0);return n.canonical&&N.cmp(this.nh)>0&&(N=this.n.sub(N),U^=1),new sa({r:D,s:N,recoveryParam:U})}}}}}};yr.prototype.verify=function(e,t,i,n){e=this._truncateToN(new Je(e,16)),i=this.keyFromPublic(i,n),t=new sa(t,"hex");var s=t.r,h=t.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||h.cmpn(1)<0||h.cmp(this.n)>=0)return!1;var u=h.invm(this.n),g=u.mul(e).umod(this.n),b=u.mul(s).umod(this.n),_;return this.curve._maxwellTrick?(_=this.g.jmulAdd(g,i.getPublic(),b),_.isInfinity()?!1:_.eqXToP(s)):(_=this.g.mulAdd(g,i.getPublic(),b),_.isInfinity()?!1:_.getX().umod(this.n).cmp(s)===0)};yr.prototype.recoverPubKey=function(r,e,t,i){du((3&t)===t,"The recovery param is more than two bits"),e=new sa(e,i);var n=this.n,s=new Je(r),h=e.r,u=e.s,g=t&1,b=t>>1;if(h.cmp(this.curve.p.umod(this.curve.n))>=0&&b)throw new Error("Unable to find sencond key candinate");b?h=this.curve.pointFromX(h.add(this.curve.n),g):h=this.curve.pointFromX(h,g);var _=e.r.invm(n),M=n.sub(s).mul(_).umod(n),A=u.mul(_).umod(n);return this.g.mulAdd(M,h,A)};yr.prototype.getKeyRecoveryParam=function(r,e,t,i){if(e=new sa(e,i),e.recoveryParam!==null)return e.recoveryParam;for(var n=0;n<4;n++){var s;try{s=this.recoverPubKey(r,e,n)}catch{continue}if(s.eq(t))return n}throw new Error("Unable to find valid recovery factor")};var eb=bn(function(r,e){var t=e;t.version="6.5.4",t.utils=ur,t.rand=function(){throw new Error("unsupported")},t.curve=xs,t.curves=Ms,t.ec=Qg,t.eddsa=null}),tb=eb.ec;const rb="signing-key/5.7.0",co=new ht(rb);let La=null;function ui(){return La||(La=new tb("secp256k1")),La}class ib{constructor(e){An(this,"curve","secp256k1"),An(this,"privateKey",fr(e)),av(this.privateKey)!==32&&co.throwArgumentError("invalid private key","privateKey","[[ REDACTED ]]");const t=ui().keyFromPrivate(bt(this.privateKey));An(this,"publicKey","0x"+t.getPublic(!1,"hex")),An(this,"compressedPublicKey","0x"+t.getPublic(!0,"hex")),An(this,"_isSigningKey",!0)}_addPoint(e){const t=ui().keyFromPublic(bt(this.publicKey)),i=ui().keyFromPublic(bt(e));return"0x"+t.pub.add(i.pub).encodeCompressed("hex")}signDigest(e){const t=ui().keyFromPrivate(bt(this.privateKey)),i=bt(e);i.length!==32&&co.throwArgumentError("bad digest length","digest",e);const n=t.sign(i,{canonical:!0});return Hc({recoveryParam:n.recoveryParam,r:rn("0x"+n.r.toString(16),32),s:rn("0x"+n.s.toString(16),32)})}computeSharedSecret(e){const t=ui().keyFromPrivate(bt(this.privateKey)),i=ui().keyFromPublic(bt(pu(e)));return rn("0x"+t.derive(i.getPublic()).toString(16),32)}static isSigningKey(e){return!!(e&&e._isSigningKey)}}function nb(r,e){const t=Hc(e),i={r:bt(t.r),s:bt(t.s)};return"0x"+ui().recoverPubKey(bt(r),i,t.recoveryParam).encode("hex",!1)}function pu(r,e){const t=bt(r);return t.length===32?new ib(t).publicKey:t.length===33?"0x"+ui().keyFromPublic(t).getPublic(!1,"hex"):t.length===65?fr(t):co.throwArgumentError("invalid public or private key","key","[REDACTED]")}var ih;(function(r){r[r.legacy=0]="legacy",r[r.eip2930=1]="eip2930",r[r.eip1559=2]="eip1559"})(ih||(ih={}));function sb(r){const e=pu(r);return mv(Wf(Oo(Wf(e,1)),12))}function ab(r,e){return sb(nb(bt(r),e))}var Fo={},aa={};Object.defineProperty(aa,"__esModule",{value:!0});var Ct=Ye,uo=cr,ob=20;function fb(r,e,t){for(var i=1634760805,n=857760878,s=2036477234,h=1797285236,u=t[3]<<24|t[2]<<16|t[1]<<8|t[0],g=t[7]<<24|t[6]<<16|t[5]<<8|t[4],b=t[11]<<24|t[10]<<16|t[9]<<8|t[8],_=t[15]<<24|t[14]<<16|t[13]<<8|t[12],M=t[19]<<24|t[18]<<16|t[17]<<8|t[16],A=t[23]<<24|t[22]<<16|t[21]<<8|t[20],I=t[27]<<24|t[26]<<16|t[25]<<8|t[24],D=t[31]<<24|t[30]<<16|t[29]<<8|t[28],N=e[3]<<24|e[2]<<16|e[1]<<8|e[0],U=e[7]<<24|e[6]<<16|e[5]<<8|e[4],k=e[11]<<24|e[10]<<16|e[9]<<8|e[8],T=e[15]<<24|e[14]<<16|e[13]<<8|e[12],K=i,R=n,C=s,$=h,E=u,O=g,J=b,Z=_,P=M,w=A,c=I,a=D,o=N,d=U,v=k,y=T,m=0;m<ob;m+=2)K=K+E|0,o^=K,o=o>>>16|o<<16,P=P+o|0,E^=P,E=E>>>20|E<<12,R=R+O|0,d^=R,d=d>>>16|d<<16,w=w+d|0,O^=w,O=O>>>20|O<<12,C=C+J|0,v^=C,v=v>>>16|v<<16,c=c+v|0,J^=c,J=J>>>20|J<<12,$=$+Z|0,y^=$,y=y>>>16|y<<16,a=a+y|0,Z^=a,Z=Z>>>20|Z<<12,C=C+J|0,v^=C,v=v>>>24|v<<8,c=c+v|0,J^=c,J=J>>>25|J<<7,$=$+Z|0,y^=$,y=y>>>24|y<<8,a=a+y|0,Z^=a,Z=Z>>>25|Z<<7,R=R+O|0,d^=R,d=d>>>24|d<<8,w=w+d|0,O^=w,O=O>>>25|O<<7,K=K+E|0,o^=K,o=o>>>24|o<<8,P=P+o|0,E^=P,E=E>>>25|E<<7,K=K+O|0,y^=K,y=y>>>16|y<<16,c=c+y|0,O^=c,O=O>>>20|O<<12,R=R+J|0,o^=R,o=o>>>16|o<<16,a=a+o|0,J^=a,J=J>>>20|J<<12,C=C+Z|0,d^=C,d=d>>>16|d<<16,P=P+d|0,Z^=P,Z=Z>>>20|Z<<12,$=$+E|0,v^=$,v=v>>>16|v<<16,w=w+v|0,E^=w,E=E>>>20|E<<12,C=C+Z|0,d^=C,d=d>>>24|d<<8,P=P+d|0,Z^=P,Z=Z>>>25|Z<<7,$=$+E|0,v^=$,v=v>>>24|v<<8,w=w+v|0,E^=w,E=E>>>25|E<<7,R=R+J|0,o^=R,o=o>>>24|o<<8,a=a+o|0,J^=a,J=J>>>25|J<<7,K=K+O|0,y^=K,y=y>>>24|y<<8,c=c+y|0,O^=c,O=O>>>25|O<<7;Ct.writeUint32LE(K+i|0,r,0),Ct.writeUint32LE(R+n|0,r,4),Ct.writeUint32LE(C+s|0,r,8),Ct.writeUint32LE($+h|0,r,12),Ct.writeUint32LE(E+u|0,r,16),Ct.writeUint32LE(O+g|0,r,20),Ct.writeUint32LE(J+b|0,r,24),Ct.writeUint32LE(Z+_|0,r,28),Ct.writeUint32LE(P+M|0,r,32),Ct.writeUint32LE(w+A|0,r,36),Ct.writeUint32LE(c+I|0,r,40),Ct.writeUint32LE(a+D|0,r,44),Ct.writeUint32LE(o+N|0,r,48),Ct.writeUint32LE(d+U|0,r,52),Ct.writeUint32LE(v+k|0,r,56),Ct.writeUint32LE(y+T|0,r,60)}function vu(r,e,t,i,n){if(n===void 0&&(n=0),r.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<t.length)throw new Error("ChaCha: destination is shorter than source");var s,h;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),h=s.length-e.length,s.set(e,h)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,h=n}for(var u=new Uint8Array(64),g=0;g<t.length;g+=64){fb(u,s,r);for(var b=g;b<g+64&&b<t.length;b++)i[b]=t[b]^u[b-g];cb(s,0,h)}return uo.wipe(u),n===0&&uo.wipe(s),i}aa.streamXOR=vu;function hb(r,e,t,i){return i===void 0&&(i=0),uo.wipe(t),vu(r,e,t,t,i)}aa.stream=hb;function cb(r,e,t){for(var i=1;t--;)i=i+(r[e]&255)|0,r[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var gu={},yi={};Object.defineProperty(yi,"__esModule",{value:!0});function ub(r,e,t){return~(r-1)&e|r-1&t}yi.select=ub;function lb(r,e){return(r|0)-(e|0)-1>>>31&1}yi.lessOrEqual=lb;function bu(r,e){if(r.length!==e.length)return 0;for(var t=0,i=0;i<r.length;i++)t|=r[i]^e[i];return 1&t-1>>>8}yi.compare=bu;function db(r,e){return r.length===0||e.length===0?!1:bu(r,e)!==0}yi.equal=db;(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=yi,t=cr;r.DIGEST_LENGTH=16;var i=function(){function h(u){this.digestLength=r.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var g=u[0]|u[1]<<8;this._r[0]=g&8191;var b=u[2]|u[3]<<8;this._r[1]=(g>>>13|b<<3)&8191;var _=u[4]|u[5]<<8;this._r[2]=(b>>>10|_<<6)&7939;var M=u[6]|u[7]<<8;this._r[3]=(_>>>7|M<<9)&8191;var A=u[8]|u[9]<<8;this._r[4]=(M>>>4|A<<12)&255,this._r[5]=A>>>1&8190;var I=u[10]|u[11]<<8;this._r[6]=(A>>>14|I<<2)&8191;var D=u[12]|u[13]<<8;this._r[7]=(I>>>11|D<<5)&8065;var N=u[14]|u[15]<<8;this._r[8]=(D>>>8|N<<8)&8191,this._r[9]=N>>>5&127,this._pad[0]=u[16]|u[17]<<8,this._pad[1]=u[18]|u[19]<<8,this._pad[2]=u[20]|u[21]<<8,this._pad[3]=u[22]|u[23]<<8,this._pad[4]=u[24]|u[25]<<8,this._pad[5]=u[26]|u[27]<<8,this._pad[6]=u[28]|u[29]<<8,this._pad[7]=u[30]|u[31]<<8}return h.prototype._blocks=function(u,g,b){for(var _=this._fin?0:2048,M=this._h[0],A=this._h[1],I=this._h[2],D=this._h[3],N=this._h[4],U=this._h[5],k=this._h[6],T=this._h[7],K=this._h[8],R=this._h[9],C=this._r[0],$=this._r[1],E=this._r[2],O=this._r[3],J=this._r[4],Z=this._r[5],P=this._r[6],w=this._r[7],c=this._r[8],a=this._r[9];b>=16;){var o=u[g+0]|u[g+1]<<8;M+=o&8191;var d=u[g+2]|u[g+3]<<8;A+=(o>>>13|d<<3)&8191;var v=u[g+4]|u[g+5]<<8;I+=(d>>>10|v<<6)&8191;var y=u[g+6]|u[g+7]<<8;D+=(v>>>7|y<<9)&8191;var m=u[g+8]|u[g+9]<<8;N+=(y>>>4|m<<12)&8191,U+=m>>>1&8191;var l=u[g+10]|u[g+11]<<8;k+=(m>>>14|l<<2)&8191;var p=u[g+12]|u[g+13]<<8;T+=(l>>>11|p<<5)&8191;var f=u[g+14]|u[g+15]<<8;K+=(p>>>8|f<<8)&8191,R+=f>>>5|_;var x=0,H=x;H+=M*C,H+=A*(5*a),H+=I*(5*c),H+=D*(5*w),H+=N*(5*P),x=H>>>13,H&=8191,H+=U*(5*Z),H+=k*(5*J),H+=T*(5*O),H+=K*(5*E),H+=R*(5*$),x+=H>>>13,H&=8191;var j=x;j+=M*$,j+=A*C,j+=I*(5*a),j+=D*(5*c),j+=N*(5*w),x=j>>>13,j&=8191,j+=U*(5*P),j+=k*(5*Z),j+=T*(5*J),j+=K*(5*O),j+=R*(5*E),x+=j>>>13,j&=8191;var G=x;G+=M*E,G+=A*$,G+=I*C,G+=D*(5*a),G+=N*(5*c),x=G>>>13,G&=8191,G+=U*(5*w),G+=k*(5*P),G+=T*(5*Z),G+=K*(5*J),G+=R*(5*O),x+=G>>>13,G&=8191;var B=x;B+=M*O,B+=A*E,B+=I*$,B+=D*C,B+=N*(5*a),x=B>>>13,B&=8191,B+=U*(5*c),B+=k*(5*w),B+=T*(5*P),B+=K*(5*Z),B+=R*(5*J),x+=B>>>13,B&=8191;var z=x;z+=M*J,z+=A*O,z+=I*E,z+=D*$,z+=N*C,x=z>>>13,z&=8191,z+=U*(5*a),z+=k*(5*c),z+=T*(5*w),z+=K*(5*P),z+=R*(5*Z),x+=z>>>13,z&=8191;var q=x;q+=M*Z,q+=A*J,q+=I*O,q+=D*E,q+=N*$,x=q>>>13,q&=8191,q+=U*C,q+=k*(5*a),q+=T*(5*c),q+=K*(5*w),q+=R*(5*P),x+=q>>>13,q&=8191;var S=x;S+=M*P,S+=A*Z,S+=I*J,S+=D*O,S+=N*E,x=S>>>13,S&=8191,S+=U*$,S+=k*C,S+=T*(5*a),S+=K*(5*c),S+=R*(5*w),x+=S>>>13,S&=8191;var F=x;F+=M*w,F+=A*P,F+=I*Z,F+=D*J,F+=N*O,x=F>>>13,F&=8191,F+=U*E,F+=k*$,F+=T*C,F+=K*(5*a),F+=R*(5*c),x+=F>>>13,F&=8191;var W=x;W+=M*c,W+=A*w,W+=I*P,W+=D*Z,W+=N*J,x=W>>>13,W&=8191,W+=U*O,W+=k*E,W+=T*$,W+=K*C,W+=R*(5*a),x+=W>>>13,W&=8191;var te=x;te+=M*a,te+=A*c,te+=I*w,te+=D*P,te+=N*Z,x=te>>>13,te&=8191,te+=U*J,te+=k*O,te+=T*E,te+=K*$,te+=R*C,x+=te>>>13,te&=8191,x=(x<<2)+x|0,x=x+H|0,H=x&8191,x=x>>>13,j+=x,M=H,A=j,I=G,D=B,N=z,U=q,k=S,T=F,K=W,R=te,g+=16,b-=16}this._h[0]=M,this._h[1]=A,this._h[2]=I,this._h[3]=D,this._h[4]=N,this._h[5]=U,this._h[6]=k,this._h[7]=T,this._h[8]=K,this._h[9]=R},h.prototype.finish=function(u,g){g===void 0&&(g=0);var b=new Uint16Array(10),_,M,A,I;if(this._leftover){for(I=this._leftover,this._buffer[I++]=1;I<16;I++)this._buffer[I]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(_=this._h[1]>>>13,this._h[1]&=8191,I=2;I<10;I++)this._h[I]+=_,_=this._h[I]>>>13,this._h[I]&=8191;for(this._h[0]+=_*5,_=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=_,_=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=_,b[0]=this._h[0]+5,_=b[0]>>>13,b[0]&=8191,I=1;I<10;I++)b[I]=this._h[I]+_,_=b[I]>>>13,b[I]&=8191;for(b[9]-=8192,M=(_^1)-1,I=0;I<10;I++)b[I]&=M;for(M=~M,I=0;I<10;I++)this._h[I]=this._h[I]&M|b[I];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,A=this._h[0]+this._pad[0],this._h[0]=A&65535,I=1;I<8;I++)A=(this._h[I]+this._pad[I]|0)+(A>>>16)|0,this._h[I]=A&65535;return u[g+0]=this._h[0]>>>0,u[g+1]=this._h[0]>>>8,u[g+2]=this._h[1]>>>0,u[g+3]=this._h[1]>>>8,u[g+4]=this._h[2]>>>0,u[g+5]=this._h[2]>>>8,u[g+6]=this._h[3]>>>0,u[g+7]=this._h[3]>>>8,u[g+8]=this._h[4]>>>0,u[g+9]=this._h[4]>>>8,u[g+10]=this._h[5]>>>0,u[g+11]=this._h[5]>>>8,u[g+12]=this._h[6]>>>0,u[g+13]=this._h[6]>>>8,u[g+14]=this._h[7]>>>0,u[g+15]=this._h[7]>>>8,this._finished=!0,this},h.prototype.update=function(u){var g=0,b=u.length,_;if(this._leftover){_=16-this._leftover,_>b&&(_=b);for(var M=0;M<_;M++)this._buffer[this._leftover+M]=u[g+M];if(b-=_,g+=_,this._leftover+=_,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(b>=16&&(_=b-b%16,this._blocks(u,g,_),g+=_,b-=_),b){for(var M=0;M<b;M++)this._buffer[this._leftover+M]=u[g+M];this._leftover+=b}return this},h.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var u=new Uint8Array(16);return this.finish(u),u},h.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},h}();r.Poly1305=i;function n(h,u){var g=new i(h);g.update(u);var b=g.digest();return g.clean(),b}r.oneTimeAuth=n;function s(h,u){return h.length!==r.DIGEST_LENGTH||u.length!==r.DIGEST_LENGTH?!1:e.equal(h,u)}r.equal=s})(gu);(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=aa,t=gu,i=cr,n=Ye,s=yi;r.KEY_LENGTH=32,r.NONCE_LENGTH=12,r.TAG_LENGTH=16;var h=new Uint8Array(16),u=function(){function g(b){if(this.nonceLength=r.NONCE_LENGTH,this.tagLength=r.TAG_LENGTH,b.length!==r.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(b)}return g.prototype.seal=function(b,_,M,A){if(b.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var I=new Uint8Array(16);I.set(b,I.length-b.length);var D=new Uint8Array(32);e.stream(this._key,I,D,4);var N=_.length+this.tagLength,U;if(A){if(A.length!==N)throw new Error("ChaCha20Poly1305: incorrect destination length");U=A}else U=new Uint8Array(N);return e.streamXOR(this._key,I,_,U,4),this._authenticate(U.subarray(U.length-this.tagLength,U.length),D,U.subarray(0,U.length-this.tagLength),M),i.wipe(I),U},g.prototype.open=function(b,_,M,A){if(b.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(_.length<this.tagLength)return null;var I=new Uint8Array(16);I.set(b,I.length-b.length);var D=new Uint8Array(32);e.stream(this._key,I,D,4);var N=new Uint8Array(this.tagLength);if(this._authenticate(N,D,_.subarray(0,_.length-this.tagLength),M),!s.equal(N,_.subarray(_.length-this.tagLength,_.length)))return null;var U=_.length-this.tagLength,k;if(A){if(A.length!==U)throw new Error("ChaCha20Poly1305: incorrect destination length");k=A}else k=new Uint8Array(U);return e.streamXOR(this._key,I,_.subarray(0,_.length-this.tagLength),k,4),i.wipe(I),k},g.prototype.clean=function(){return i.wipe(this._key),this},g.prototype._authenticate=function(b,_,M,A){var I=new t.Poly1305(_);A&&(I.update(A),A.length%16>0&&I.update(h.subarray(A.length%16))),I.update(M),M.length%16>0&&I.update(h.subarray(M.length%16));var D=new Uint8Array(8);A&&n.writeUint64LE(A.length,D),I.update(D),n.writeUint64LE(M.length,D),I.update(D);for(var N=I.digest(),U=0;U<N.length;U++)b[U]=N[U];I.clean(),i.wipe(N),i.wipe(D)},g}();r.ChaCha20Poly1305=u})(Fo);var mu={},Zn={},qo={};Object.defineProperty(qo,"__esModule",{value:!0});function pb(r){return typeof r.saveState<"u"&&typeof r.restoreState<"u"&&typeof r.cleanSavedState<"u"}qo.isSerializableHash=pb;Object.defineProperty(Zn,"__esModule",{value:!0});var Cr=qo,vb=yi,gb=cr,yu=function(){function r(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(i).clean():i.set(t);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=106;this._outer.update(i),Cr.isSerializableHash(this._inner)&&Cr.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),gb.wipe(i)}return r.prototype.reset=function(){if(!Cr.isSerializableHash(this._inner)||!Cr.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.clean=function(){Cr.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Cr.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},r.prototype.update=function(e){return this._inner.update(e),this},r.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},r.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},r.prototype.saveState=function(){if(!Cr.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},r.prototype.restoreState=function(e){if(!Cr.isSerializableHash(this._inner)||!Cr.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.cleanSavedState=function(e){if(!Cr.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},r}();Zn.HMAC=yu;function bb(r,e,t){var i=new yu(r,e);i.update(t);var n=i.digest();return i.clean(),n}Zn.hmac=bb;Zn.equal=vb.equal;Object.defineProperty(mu,"__esModule",{value:!0});var nh=Zn,sh=cr,mb=function(){function r(e,t,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var s=nh.hmac(this._hash,i,t);this._hmac=new nh.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return r.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},r.prototype.expand=function(e){for(var t=new Uint8Array(e),i=0;i<t.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[i]=this._buffer[this._bufpos++];return t},r.prototype.clean=function(){this._hmac.clean(),sh.wipe(this._buffer),sh.wipe(this._counter),this._bufpos=0},r}(),yb=mu.HKDF=mb,Qn={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=Ye,t=cr;r.DIGEST_LENGTH=32,r.BLOCK_SIZE=64;var i=function(){function u(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},u.prototype.update=function(g,b){if(b===void 0&&(b=g.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var _=0;if(this._bytesHashed+=b,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&b>0;)this._buffer[this._bufferLength++]=g[_++],b--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(b>=this.blockSize&&(_=s(this._temp,this._state,g,_,b),b%=this.blockSize);b>0;)this._buffer[this._bufferLength++]=g[_++],b--;return this},u.prototype.finish=function(g){if(!this._finished){var b=this._bytesHashed,_=this._bufferLength,M=b/536870912|0,A=b<<3,I=b%64<56?64:128;this._buffer[_]=128;for(var D=_+1;D<I-8;D++)this._buffer[D]=0;e.writeUint32BE(M,this._buffer,I-8),e.writeUint32BE(A,this._buffer,I-4),s(this._temp,this._state,this._buffer,0,I),this._finished=!0}for(var D=0;D<this.digestLength/4;D++)e.writeUint32BE(this._state[D],g,D*4);return this},u.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(g){return this._state.set(g.state),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(g){t.wipe(g.state),g.buffer&&t.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},u}();r.SHA256=i;var n=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(u,g,b,_,M){for(;M>=64;){for(var A=g[0],I=g[1],D=g[2],N=g[3],U=g[4],k=g[5],T=g[6],K=g[7],R=0;R<16;R++){var C=_+R*4;u[R]=e.readUint32BE(b,C)}for(var R=16;R<64;R++){var $=u[R-2],E=($>>>17|$<<15)^($>>>19|$<<13)^$>>>10;$=u[R-15];var O=($>>>7|$<<25)^($>>>18|$<<14)^$>>>3;u[R]=(E+u[R-7]|0)+(O+u[R-16]|0)}for(var R=0;R<64;R++){var E=(((U>>>6|U<<26)^(U>>>11|U<<21)^(U>>>25|U<<7))+(U&k^~U&T)|0)+(K+(n[R]+u[R]|0)|0)|0,O=((A>>>2|A<<30)^(A>>>13|A<<19)^(A>>>22|A<<10))+(A&I^A&D^I&D)|0;K=T,T=k,k=U,U=N+E|0,N=D,D=I,I=A,A=E+O|0}g[0]+=A,g[1]+=I,g[2]+=D,g[3]+=N,g[4]+=U,g[5]+=k,g[6]+=T,g[7]+=K,_+=64,M-=64}return _}function h(u){var g=new i;g.update(u);var b=g.digest();return g.clean(),b}r.hash=h})(Qn);var Uo={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.sharedKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.scalarMultBase=r.scalarMult=r.SHARED_KEY_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=void 0;const e=bi,t=cr;r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=32,r.SHARED_KEY_LENGTH=32;function i(R){const C=new Float64Array(16);if(R)for(let $=0;$<R.length;$++)C[$]=R[$];return C}const n=new Uint8Array(32);n[0]=9;const s=i([56129,1]);function h(R){let C=1;for(let $=0;$<16;$++){let E=R[$]+C+65535;C=Math.floor(E/65536),R[$]=E-C*65536}R[0]+=C-1+37*(C-1)}function u(R,C,$){const E=~($-1);for(let O=0;O<16;O++){const J=E&(R[O]^C[O]);R[O]^=J,C[O]^=J}}function g(R,C){const $=i(),E=i();for(let O=0;O<16;O++)E[O]=C[O];h(E),h(E),h(E);for(let O=0;O<2;O++){$[0]=E[0]-65517;for(let Z=1;Z<15;Z++)$[Z]=E[Z]-65535-($[Z-1]>>16&1),$[Z-1]&=65535;$[15]=E[15]-32767-($[14]>>16&1);const J=$[15]>>16&1;$[14]&=65535,u(E,$,1-J)}for(let O=0;O<16;O++)R[2*O]=E[O]&255,R[2*O+1]=E[O]>>8}function b(R,C){for(let $=0;$<16;$++)R[$]=C[2*$]+(C[2*$+1]<<8);R[15]&=32767}function _(R,C,$){for(let E=0;E<16;E++)R[E]=C[E]+$[E]}function M(R,C,$){for(let E=0;E<16;E++)R[E]=C[E]-$[E]}function A(R,C,$){let E,O,J=0,Z=0,P=0,w=0,c=0,a=0,o=0,d=0,v=0,y=0,m=0,l=0,p=0,f=0,x=0,H=0,j=0,G=0,B=0,z=0,q=0,S=0,F=0,W=0,te=0,fe=0,ie=0,Ce=0,ye=0,oe=0,ze=0,ge=$[0],re=$[1],Ne=$[2],ce=$[3],ee=$[4],Ie=$[5],se=$[6],Y=$[7],Pe=$[8],ve=$[9],Q=$[10],Le=$[11],me=$[12],ne=$[13],$e=$[14],we=$[15];E=C[0],J+=E*ge,Z+=E*re,P+=E*Ne,w+=E*ce,c+=E*ee,a+=E*Ie,o+=E*se,d+=E*Y,v+=E*Pe,y+=E*ve,m+=E*Q,l+=E*Le,p+=E*me,f+=E*ne,x+=E*$e,H+=E*we,E=C[1],Z+=E*ge,P+=E*re,w+=E*Ne,c+=E*ce,a+=E*ee,o+=E*Ie,d+=E*se,v+=E*Y,y+=E*Pe,m+=E*ve,l+=E*Q,p+=E*Le,f+=E*me,x+=E*ne,H+=E*$e,j+=E*we,E=C[2],P+=E*ge,w+=E*re,c+=E*Ne,a+=E*ce,o+=E*ee,d+=E*Ie,v+=E*se,y+=E*Y,m+=E*Pe,l+=E*ve,p+=E*Q,f+=E*Le,x+=E*me,H+=E*ne,j+=E*$e,G+=E*we,E=C[3],w+=E*ge,c+=E*re,a+=E*Ne,o+=E*ce,d+=E*ee,v+=E*Ie,y+=E*se,m+=E*Y,l+=E*Pe,p+=E*ve,f+=E*Q,x+=E*Le,H+=E*me,j+=E*ne,G+=E*$e,B+=E*we,E=C[4],c+=E*ge,a+=E*re,o+=E*Ne,d+=E*ce,v+=E*ee,y+=E*Ie,m+=E*se,l+=E*Y,p+=E*Pe,f+=E*ve,x+=E*Q,H+=E*Le,j+=E*me,G+=E*ne,B+=E*$e,z+=E*we,E=C[5],a+=E*ge,o+=E*re,d+=E*Ne,v+=E*ce,y+=E*ee,m+=E*Ie,l+=E*se,p+=E*Y,f+=E*Pe,x+=E*ve,H+=E*Q,j+=E*Le,G+=E*me,B+=E*ne,z+=E*$e,q+=E*we,E=C[6],o+=E*ge,d+=E*re,v+=E*Ne,y+=E*ce,m+=E*ee,l+=E*Ie,p+=E*se,f+=E*Y,x+=E*Pe,H+=E*ve,j+=E*Q,G+=E*Le,B+=E*me,z+=E*ne,q+=E*$e,S+=E*we,E=C[7],d+=E*ge,v+=E*re,y+=E*Ne,m+=E*ce,l+=E*ee,p+=E*Ie,f+=E*se,x+=E*Y,H+=E*Pe,j+=E*ve,G+=E*Q,B+=E*Le,z+=E*me,q+=E*ne,S+=E*$e,F+=E*we,E=C[8],v+=E*ge,y+=E*re,m+=E*Ne,l+=E*ce,p+=E*ee,f+=E*Ie,x+=E*se,H+=E*Y,j+=E*Pe,G+=E*ve,B+=E*Q,z+=E*Le,q+=E*me,S+=E*ne,F+=E*$e,W+=E*we,E=C[9],y+=E*ge,m+=E*re,l+=E*Ne,p+=E*ce,f+=E*ee,x+=E*Ie,H+=E*se,j+=E*Y,G+=E*Pe,B+=E*ve,z+=E*Q,q+=E*Le,S+=E*me,F+=E*ne,W+=E*$e,te+=E*we,E=C[10],m+=E*ge,l+=E*re,p+=E*Ne,f+=E*ce,x+=E*ee,H+=E*Ie,j+=E*se,G+=E*Y,B+=E*Pe,z+=E*ve,q+=E*Q,S+=E*Le,F+=E*me,W+=E*ne,te+=E*$e,fe+=E*we,E=C[11],l+=E*ge,p+=E*re,f+=E*Ne,x+=E*ce,H+=E*ee,j+=E*Ie,G+=E*se,B+=E*Y,z+=E*Pe,q+=E*ve,S+=E*Q,F+=E*Le,W+=E*me,te+=E*ne,fe+=E*$e,ie+=E*we,E=C[12],p+=E*ge,f+=E*re,x+=E*Ne,H+=E*ce,j+=E*ee,G+=E*Ie,B+=E*se,z+=E*Y,q+=E*Pe,S+=E*ve,F+=E*Q,W+=E*Le,te+=E*me,fe+=E*ne,ie+=E*$e,Ce+=E*we,E=C[13],f+=E*ge,x+=E*re,H+=E*Ne,j+=E*ce,G+=E*ee,B+=E*Ie,z+=E*se,q+=E*Y,S+=E*Pe,F+=E*ve,W+=E*Q,te+=E*Le,fe+=E*me,ie+=E*ne,Ce+=E*$e,ye+=E*we,E=C[14],x+=E*ge,H+=E*re,j+=E*Ne,G+=E*ce,B+=E*ee,z+=E*Ie,q+=E*se,S+=E*Y,F+=E*Pe,W+=E*ve,te+=E*Q,fe+=E*Le,ie+=E*me,Ce+=E*ne,ye+=E*$e,oe+=E*we,E=C[15],H+=E*ge,j+=E*re,G+=E*Ne,B+=E*ce,z+=E*ee,q+=E*Ie,S+=E*se,F+=E*Y,W+=E*Pe,te+=E*ve,fe+=E*Q,ie+=E*Le,Ce+=E*me,ye+=E*ne,oe+=E*$e,ze+=E*we,J+=38*j,Z+=38*G,P+=38*B,w+=38*z,c+=38*q,a+=38*S,o+=38*F,d+=38*W,v+=38*te,y+=38*fe,m+=38*ie,l+=38*Ce,p+=38*ye,f+=38*oe,x+=38*ze,O=1,E=J+O+65535,O=Math.floor(E/65536),J=E-O*65536,E=Z+O+65535,O=Math.floor(E/65536),Z=E-O*65536,E=P+O+65535,O=Math.floor(E/65536),P=E-O*65536,E=w+O+65535,O=Math.floor(E/65536),w=E-O*65536,E=c+O+65535,O=Math.floor(E/65536),c=E-O*65536,E=a+O+65535,O=Math.floor(E/65536),a=E-O*65536,E=o+O+65535,O=Math.floor(E/65536),o=E-O*65536,E=d+O+65535,O=Math.floor(E/65536),d=E-O*65536,E=v+O+65535,O=Math.floor(E/65536),v=E-O*65536,E=y+O+65535,O=Math.floor(E/65536),y=E-O*65536,E=m+O+65535,O=Math.floor(E/65536),m=E-O*65536,E=l+O+65535,O=Math.floor(E/65536),l=E-O*65536,E=p+O+65535,O=Math.floor(E/65536),p=E-O*65536,E=f+O+65535,O=Math.floor(E/65536),f=E-O*65536,E=x+O+65535,O=Math.floor(E/65536),x=E-O*65536,E=H+O+65535,O=Math.floor(E/65536),H=E-O*65536,J+=O-1+37*(O-1),O=1,E=J+O+65535,O=Math.floor(E/65536),J=E-O*65536,E=Z+O+65535,O=Math.floor(E/65536),Z=E-O*65536,E=P+O+65535,O=Math.floor(E/65536),P=E-O*65536,E=w+O+65535,O=Math.floor(E/65536),w=E-O*65536,E=c+O+65535,O=Math.floor(E/65536),c=E-O*65536,E=a+O+65535,O=Math.floor(E/65536),a=E-O*65536,E=o+O+65535,O=Math.floor(E/65536),o=E-O*65536,E=d+O+65535,O=Math.floor(E/65536),d=E-O*65536,E=v+O+65535,O=Math.floor(E/65536),v=E-O*65536,E=y+O+65535,O=Math.floor(E/65536),y=E-O*65536,E=m+O+65535,O=Math.floor(E/65536),m=E-O*65536,E=l+O+65535,O=Math.floor(E/65536),l=E-O*65536,E=p+O+65535,O=Math.floor(E/65536),p=E-O*65536,E=f+O+65535,O=Math.floor(E/65536),f=E-O*65536,E=x+O+65535,O=Math.floor(E/65536),x=E-O*65536,E=H+O+65535,O=Math.floor(E/65536),H=E-O*65536,J+=O-1+37*(O-1),R[0]=J,R[1]=Z,R[2]=P,R[3]=w,R[4]=c,R[5]=a,R[6]=o,R[7]=d,R[8]=v,R[9]=y,R[10]=m,R[11]=l,R[12]=p,R[13]=f,R[14]=x,R[15]=H}function I(R,C){A(R,C,C)}function D(R,C){const $=i();for(let E=0;E<16;E++)$[E]=C[E];for(let E=253;E>=0;E--)I($,$),E!==2&&E!==4&&A($,$,C);for(let E=0;E<16;E++)R[E]=$[E]}function N(R,C){const $=new Uint8Array(32),E=new Float64Array(80),O=i(),J=i(),Z=i(),P=i(),w=i(),c=i();for(let v=0;v<31;v++)$[v]=R[v];$[31]=R[31]&127|64,$[0]&=248,b(E,C);for(let v=0;v<16;v++)J[v]=E[v];O[0]=P[0]=1;for(let v=254;v>=0;--v){const y=$[v>>>3]>>>(v&7)&1;u(O,J,y),u(Z,P,y),_(w,O,Z),M(O,O,Z),_(Z,J,P),M(J,J,P),I(P,w),I(c,O),A(O,Z,O),A(Z,J,w),_(w,O,Z),M(O,O,Z),I(J,O),M(Z,P,c),A(O,Z,s),_(O,O,P),A(Z,Z,O),A(O,P,c),A(P,J,E),I(J,w),u(O,J,y),u(Z,P,y)}for(let v=0;v<16;v++)E[v+16]=O[v],E[v+32]=Z[v],E[v+48]=J[v],E[v+64]=P[v];const a=E.subarray(32),o=E.subarray(16);D(a,a),A(o,o,a);const d=new Uint8Array(32);return g(d,o),d}r.scalarMult=N;function U(R){return N(R,n)}r.scalarMultBase=U;function k(R){if(R.length!==r.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${r.SECRET_KEY_LENGTH} bytes`);const C=new Uint8Array(R);return{publicKey:U(C),secretKey:C}}r.generateKeyPairFromSeed=k;function T(R){const C=(0,e.randomBytes)(32,R),$=k(C);return(0,t.wipe)(C),$}r.generateKeyPair=T;function K(R,C,$=!1){if(R.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(C.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const E=N(R,C);if($){let O=0;for(let J=0;J<E.length;J++)O|=E[J];if(O===0)throw new Error("X25519: invalid shared key")}return E}r.sharedKey=K})(Uo);function wu(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function $a(r,e){e||(e=r.reduce((n,s)=>n+s.length,0));const t=wu(e);let i=0;for(const n of r)t.set(n,i),i+=n.length;return t}function _u(r,e,t,i){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:i}}}const ah=_u("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Fa=_u("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=wu(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),xu={utf8:ah,"utf-8":ah,hex:Ts.base16,latin1:Fa,ascii:Fa,binary:Fa,...Ts};function mr(r,e="utf8"){const t=xu[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}function Kt(r,e="utf8"){const t=xu[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}var Mu={};const wb="elliptic",_b="6.6.0",xb="EC cryptography",Mb="lib/elliptic.js",Eb=["lib"],Sb={lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},Ib={type:"git",url:"git@github.com:indutny/elliptic"},Ab=["EC","Elliptic","curve","Cryptography"],Db="Fedor Indutny <fedor@indutny.com>",Pb="MIT",Ob={url:"https://github.com/indutny/elliptic/issues"},Nb="https://github.com/indutny/elliptic",Rb={brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},Tb={"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"},Cb={name:wb,version:_b,description:xb,main:Mb,files:Eb,scripts:Sb,repository:Ib,keywords:Ab,author:Db,license:Pb,bugs:Ob,homepage:Nb,devDependencies:Rb,dependencies:Tb};var lr={},zo={exports:{}};zo.exports;(function(r){(function(e,t){function i(P,w){if(!P)throw new Error(w||"Assertion failed")}function n(P,w){P.super_=w;var c=function(){};c.prototype=w.prototype,P.prototype=new c,P.prototype.constructor=P}function s(P,w,c){if(s.isBN(P))return P;this.negative=0,this.words=null,this.length=0,this.red=null,P!==null&&((w==="le"||w==="be")&&(c=w,w=10),this._init(P||0,w||10,c||"be"))}typeof e=="object"?e.exports=s:t.BN=s,s.BN=s,s.wordSize=26;var h;try{typeof window<"u"&&typeof window.Buffer<"u"?h=window.Buffer:h=Vn.Buffer}catch{}s.isBN=function(w){return w instanceof s?!0:w!==null&&typeof w=="object"&&w.constructor.wordSize===s.wordSize&&Array.isArray(w.words)},s.max=function(w,c){return w.cmp(c)>0?w:c},s.min=function(w,c){return w.cmp(c)<0?w:c},s.prototype._init=function(w,c,a){if(typeof w=="number")return this._initNumber(w,c,a);if(typeof w=="object")return this._initArray(w,c,a);c==="hex"&&(c=16),i(c===(c|0)&&c>=2&&c<=36),w=w.toString().replace(/\s+/g,"");var o=0;w[0]==="-"&&(o++,this.negative=1),o<w.length&&(c===16?this._parseHex(w,o,a):(this._parseBase(w,c,o),a==="le"&&this._initArray(this.toArray(),c,a)))},s.prototype._initNumber=function(w,c,a){w<0&&(this.negative=1,w=-w),w<67108864?(this.words=[w&67108863],this.length=1):w<4503599627370496?(this.words=[w&67108863,w/67108864&67108863],this.length=2):(i(w<9007199254740992),this.words=[w&67108863,w/67108864&67108863,1],this.length=3),a==="le"&&this._initArray(this.toArray(),c,a)},s.prototype._initArray=function(w,c,a){if(i(typeof w.length=="number"),w.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(w.length/3),this.words=new Array(this.length);for(var o=0;o<this.length;o++)this.words[o]=0;var d,v,y=0;if(a==="be")for(o=w.length-1,d=0;o>=0;o-=3)v=w[o]|w[o-1]<<8|w[o-2]<<16,this.words[d]|=v<<y&67108863,this.words[d+1]=v>>>26-y&67108863,y+=24,y>=26&&(y-=26,d++);else if(a==="le")for(o=0,d=0;o<w.length;o+=3)v=w[o]|w[o+1]<<8|w[o+2]<<16,this.words[d]|=v<<y&67108863,this.words[d+1]=v>>>26-y&67108863,y+=24,y>=26&&(y-=26,d++);return this.strip()};function u(P,w){var c=P.charCodeAt(w);return c>=65&&c<=70?c-55:c>=97&&c<=102?c-87:c-48&15}function g(P,w,c){var a=u(P,c);return c-1>=w&&(a|=u(P,c-1)<<4),a}s.prototype._parseHex=function(w,c,a){this.length=Math.ceil((w.length-c)/6),this.words=new Array(this.length);for(var o=0;o<this.length;o++)this.words[o]=0;var d=0,v=0,y;if(a==="be")for(o=w.length-1;o>=c;o-=2)y=g(w,c,o)<<d,this.words[v]|=y&67108863,d>=18?(d-=18,v+=1,this.words[v]|=y>>>26):d+=8;else{var m=w.length-c;for(o=m%2===0?c+1:c;o<w.length;o+=2)y=g(w,c,o)<<d,this.words[v]|=y&67108863,d>=18?(d-=18,v+=1,this.words[v]|=y>>>26):d+=8}this.strip()};function b(P,w,c,a){for(var o=0,d=Math.min(P.length,c),v=w;v<d;v++){var y=P.charCodeAt(v)-48;o*=a,y>=49?o+=y-49+10:y>=17?o+=y-17+10:o+=y}return o}s.prototype._parseBase=function(w,c,a){this.words=[0],this.length=1;for(var o=0,d=1;d<=67108863;d*=c)o++;o--,d=d/c|0;for(var v=w.length-a,y=v%o,m=Math.min(v,v-y)+a,l=0,p=a;p<m;p+=o)l=b(w,p,p+o,c),this.imuln(d),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l);if(y!==0){var f=1;for(l=b(w,p,w.length,c),p=0;p<y;p++)f*=c;this.imuln(f),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l)}this.strip()},s.prototype.copy=function(w){w.words=new Array(this.length);for(var c=0;c<this.length;c++)w.words[c]=this.words[c];w.length=this.length,w.negative=this.negative,w.red=this.red},s.prototype.clone=function(){var w=new s(null);return this.copy(w),w},s.prototype._expand=function(w){for(;this.length<w;)this.words[this.length++]=0;return this},s.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},s.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},s.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var _=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],M=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],A=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(w,c){w=w||10,c=c|0||1;var a;if(w===16||w==="hex"){a="";for(var o=0,d=0,v=0;v<this.length;v++){var y=this.words[v],m=((y<<o|d)&16777215).toString(16);d=y>>>24-o&16777215,d!==0||v!==this.length-1?a=_[6-m.length]+m+a:a=m+a,o+=2,o>=26&&(o-=26,v--)}for(d!==0&&(a=d.toString(16)+a);a.length%c!==0;)a="0"+a;return this.negative!==0&&(a="-"+a),a}if(w===(w|0)&&w>=2&&w<=36){var l=M[w],p=A[w];a="";var f=this.clone();for(f.negative=0;!f.isZero();){var x=f.modn(p).toString(w);f=f.idivn(p),f.isZero()?a=x+a:a=_[l-x.length]+x+a}for(this.isZero()&&(a="0"+a);a.length%c!==0;)a="0"+a;return this.negative!==0&&(a="-"+a),a}i(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var w=this.words[0];return this.length===2?w+=this.words[1]*67108864:this.length===3&&this.words[2]===1?w+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-w:w},s.prototype.toJSON=function(){return this.toString(16)},s.prototype.toBuffer=function(w,c){return i(typeof h<"u"),this.toArrayLike(h,w,c)},s.prototype.toArray=function(w,c){return this.toArrayLike(Array,w,c)},s.prototype.toArrayLike=function(w,c,a){var o=this.byteLength(),d=a||Math.max(1,o);i(o<=d,"byte array longer than desired length"),i(d>0,"Requested array length <= 0"),this.strip();var v=c==="le",y=new w(d),m,l,p=this.clone();if(v){for(l=0;!p.isZero();l++)m=p.andln(255),p.iushrn(8),y[l]=m;for(;l<d;l++)y[l]=0}else{for(l=0;l<d-o;l++)y[l]=0;for(l=0;!p.isZero();l++)m=p.andln(255),p.iushrn(8),y[d-l-1]=m}return y},Math.clz32?s.prototype._countBits=function(w){return 32-Math.clz32(w)}:s.prototype._countBits=function(w){var c=w,a=0;return c>=4096&&(a+=13,c>>>=13),c>=64&&(a+=7,c>>>=7),c>=8&&(a+=4,c>>>=4),c>=2&&(a+=2,c>>>=2),a+c},s.prototype._zeroBits=function(w){if(w===0)return 26;var c=w,a=0;return c&8191||(a+=13,c>>>=13),c&127||(a+=7,c>>>=7),c&15||(a+=4,c>>>=4),c&3||(a+=2,c>>>=2),c&1||a++,a},s.prototype.bitLength=function(){var w=this.words[this.length-1],c=this._countBits(w);return(this.length-1)*26+c};function I(P){for(var w=new Array(P.bitLength()),c=0;c<w.length;c++){var a=c/26|0,o=c%26;w[c]=(P.words[a]&1<<o)>>>o}return w}s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var w=0,c=0;c<this.length;c++){var a=this._zeroBits(this.words[c]);if(w+=a,a!==26)break}return w},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(w){return this.negative!==0?this.abs().inotn(w).iaddn(1):this.clone()},s.prototype.fromTwos=function(w){return this.testn(w-1)?this.notn(w).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return this.negative!==0},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(w){for(;this.length<w.length;)this.words[this.length++]=0;for(var c=0;c<w.length;c++)this.words[c]=this.words[c]|w.words[c];return this.strip()},s.prototype.ior=function(w){return i((this.negative|w.negative)===0),this.iuor(w)},s.prototype.or=function(w){return this.length>w.length?this.clone().ior(w):w.clone().ior(this)},s.prototype.uor=function(w){return this.length>w.length?this.clone().iuor(w):w.clone().iuor(this)},s.prototype.iuand=function(w){var c;this.length>w.length?c=w:c=this;for(var a=0;a<c.length;a++)this.words[a]=this.words[a]&w.words[a];return this.length=c.length,this.strip()},s.prototype.iand=function(w){return i((this.negative|w.negative)===0),this.iuand(w)},s.prototype.and=function(w){return this.length>w.length?this.clone().iand(w):w.clone().iand(this)},s.prototype.uand=function(w){return this.length>w.length?this.clone().iuand(w):w.clone().iuand(this)},s.prototype.iuxor=function(w){var c,a;this.length>w.length?(c=this,a=w):(c=w,a=this);for(var o=0;o<a.length;o++)this.words[o]=c.words[o]^a.words[o];if(this!==c)for(;o<c.length;o++)this.words[o]=c.words[o];return this.length=c.length,this.strip()},s.prototype.ixor=function(w){return i((this.negative|w.negative)===0),this.iuxor(w)},s.prototype.xor=function(w){return this.length>w.length?this.clone().ixor(w):w.clone().ixor(this)},s.prototype.uxor=function(w){return this.length>w.length?this.clone().iuxor(w):w.clone().iuxor(this)},s.prototype.inotn=function(w){i(typeof w=="number"&&w>=0);var c=Math.ceil(w/26)|0,a=w%26;this._expand(c),a>0&&c--;for(var o=0;o<c;o++)this.words[o]=~this.words[o]&67108863;return a>0&&(this.words[o]=~this.words[o]&67108863>>26-a),this.strip()},s.prototype.notn=function(w){return this.clone().inotn(w)},s.prototype.setn=function(w,c){i(typeof w=="number"&&w>=0);var a=w/26|0,o=w%26;return this._expand(a+1),c?this.words[a]=this.words[a]|1<<o:this.words[a]=this.words[a]&~(1<<o),this.strip()},s.prototype.iadd=function(w){var c;if(this.negative!==0&&w.negative===0)return this.negative=0,c=this.isub(w),this.negative^=1,this._normSign();if(this.negative===0&&w.negative!==0)return w.negative=0,c=this.isub(w),w.negative=1,c._normSign();var a,o;this.length>w.length?(a=this,o=w):(a=w,o=this);for(var d=0,v=0;v<o.length;v++)c=(a.words[v]|0)+(o.words[v]|0)+d,this.words[v]=c&67108863,d=c>>>26;for(;d!==0&&v<a.length;v++)c=(a.words[v]|0)+d,this.words[v]=c&67108863,d=c>>>26;if(this.length=a.length,d!==0)this.words[this.length]=d,this.length++;else if(a!==this)for(;v<a.length;v++)this.words[v]=a.words[v];return this},s.prototype.add=function(w){var c;return w.negative!==0&&this.negative===0?(w.negative=0,c=this.sub(w),w.negative^=1,c):w.negative===0&&this.negative!==0?(this.negative=0,c=w.sub(this),this.negative=1,c):this.length>w.length?this.clone().iadd(w):w.clone().iadd(this)},s.prototype.isub=function(w){if(w.negative!==0){w.negative=0;var c=this.iadd(w);return w.negative=1,c._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(w),this.negative=1,this._normSign();var a=this.cmp(w);if(a===0)return this.negative=0,this.length=1,this.words[0]=0,this;var o,d;a>0?(o=this,d=w):(o=w,d=this);for(var v=0,y=0;y<d.length;y++)c=(o.words[y]|0)-(d.words[y]|0)+v,v=c>>26,this.words[y]=c&67108863;for(;v!==0&&y<o.length;y++)c=(o.words[y]|0)+v,v=c>>26,this.words[y]=c&67108863;if(v===0&&y<o.length&&o!==this)for(;y<o.length;y++)this.words[y]=o.words[y];return this.length=Math.max(this.length,y),o!==this&&(this.negative=1),this.strip()},s.prototype.sub=function(w){return this.clone().isub(w)};function D(P,w,c){c.negative=w.negative^P.negative;var a=P.length+w.length|0;c.length=a,a=a-1|0;var o=P.words[0]|0,d=w.words[0]|0,v=o*d,y=v&67108863,m=v/67108864|0;c.words[0]=y;for(var l=1;l<a;l++){for(var p=m>>>26,f=m&67108863,x=Math.min(l,w.length-1),H=Math.max(0,l-P.length+1);H<=x;H++){var j=l-H|0;o=P.words[j]|0,d=w.words[H]|0,v=o*d+f,p+=v/67108864|0,f=v&67108863}c.words[l]=f|0,m=p|0}return m!==0?c.words[l]=m|0:c.length--,c.strip()}var N=function(w,c,a){var o=w.words,d=c.words,v=a.words,y=0,m,l,p,f=o[0]|0,x=f&8191,H=f>>>13,j=o[1]|0,G=j&8191,B=j>>>13,z=o[2]|0,q=z&8191,S=z>>>13,F=o[3]|0,W=F&8191,te=F>>>13,fe=o[4]|0,ie=fe&8191,Ce=fe>>>13,ye=o[5]|0,oe=ye&8191,ze=ye>>>13,ge=o[6]|0,re=ge&8191,Ne=ge>>>13,ce=o[7]|0,ee=ce&8191,Ie=ce>>>13,se=o[8]|0,Y=se&8191,Pe=se>>>13,ve=o[9]|0,Q=ve&8191,Le=ve>>>13,me=d[0]|0,ne=me&8191,$e=me>>>13,we=d[1]|0,xe=we&8191,Ze=we>>>13,qe=d[2]|0,_e=qe&8191,tt=qe>>>13,Ue=d[3]|0,Ee=Ue&8191,Be=Ue>>>13,Se=d[4]|0,he=Se&8191,ke=Se>>>13,De=d[5]|0,ae=De&8191,Ve=De>>>13,Re=d[6]|0,de=Re&8191,Ge=Re>>>13,Te=d[7]|0,ue=Te&8191,Ke=Te>>>13,Me=d[8]|0,pe=Me&8191,We=Me>>>13,He=d[9]|0,Oe=He&8191,rt=He>>>13;a.negative=w.negative^c.negative,a.length=19,m=Math.imul(x,ne),l=Math.imul(x,$e),l=l+Math.imul(H,ne)|0,p=Math.imul(H,$e);var Fe=(y+m|0)+((l&8191)<<13)|0;y=(p+(l>>>13)|0)+(Fe>>>26)|0,Fe&=67108863,m=Math.imul(G,ne),l=Math.imul(G,$e),l=l+Math.imul(B,ne)|0,p=Math.imul(B,$e),m=m+Math.imul(x,xe)|0,l=l+Math.imul(x,Ze)|0,l=l+Math.imul(H,xe)|0,p=p+Math.imul(H,Ze)|0;var je=(y+m|0)+((l&8191)<<13)|0;y=(p+(l>>>13)|0)+(je>>>26)|0,je&=67108863,m=Math.imul(q,ne),l=Math.imul(q,$e),l=l+Math.imul(S,ne)|0,p=Math.imul(S,$e),m=m+Math.imul(G,xe)|0,l=l+Math.imul(G,Ze)|0,l=l+Math.imul(B,xe)|0,p=p+Math.imul(B,Ze)|0,m=m+Math.imul(x,_e)|0,l=l+Math.imul(x,tt)|0,l=l+Math.imul(H,_e)|0,p=p+Math.imul(H,tt)|0;var Gt=(y+m|0)+((l&8191)<<13)|0;y=(p+(l>>>13)|0)+(Gt>>>26)|0,Gt&=67108863,m=Math.imul(W,ne),l=Math.imul(W,$e),l=l+Math.imul(te,ne)|0,p=Math.imul(te,$e),m=m+Math.imul(q,xe)|0,l=l+Math.imul(q,Ze)|0,l=l+Math.imul(S,xe)|0,p=p+Math.imul(S,Ze)|0,m=m+Math.imul(G,_e)|0,l=l+Math.imul(G,tt)|0,l=l+Math.imul(B,_e)|0,p=p+Math.imul(B,tt)|0,m=m+Math.imul(x,Ee)|0,l=l+Math.imul(x,Be)|0,l=l+Math.imul(H,Ee)|0,p=p+Math.imul(H,Be)|0;var Wt=(y+m|0)+((l&8191)<<13)|0;y=(p+(l>>>13)|0)+(Wt>>>26)|0,Wt&=67108863,m=Math.imul(ie,ne),l=Math.imul(ie,$e),l=l+Math.imul(Ce,ne)|0,p=Math.imul(Ce,$e),m=m+Math.imul(W,xe)|0,l=l+Math.imul(W,Ze)|0,l=l+Math.imul(te,xe)|0,p=p+Math.imul(te,Ze)|0,m=m+Math.imul(q,_e)|0,l=l+Math.imul(q,tt)|0,l=l+Math.imul(S,_e)|0,p=p+Math.imul(S,tt)|0,m=m+Math.imul(G,Ee)|0,l=l+Math.imul(G,Be)|0,l=l+Math.imul(B,Ee)|0,p=p+Math.imul(B,Be)|0,m=m+Math.imul(x,he)|0,l=l+Math.imul(x,ke)|0,l=l+Math.imul(H,he)|0,p=p+Math.imul(H,ke)|0;var Jt=(y+m|0)+((l&8191)<<13)|0;y=(p+(l>>>13)|0)+(Jt>>>26)|0,Jt&=67108863,m=Math.imul(oe,ne),l=Math.imul(oe,$e),l=l+Math.imul(ze,ne)|0,p=Math.imul(ze,$e),m=m+Math.imul(ie,xe)|0,l=l+Math.imul(ie,Ze)|0,l=l+Math.imul(Ce,xe)|0,p=p+Math.imul(Ce,Ze)|0,m=m+Math.imul(W,_e)|0,l=l+Math.imul(W,tt)|0,l=l+Math.imul(te,_e)|0,p=p+Math.imul(te,tt)|0,m=m+Math.imul(q,Ee)|0,l=l+Math.imul(q,Be)|0,l=l+Math.imul(S,Ee)|0,p=p+Math.imul(S,Be)|0,m=m+Math.imul(G,he)|0,l=l+Math.imul(G,ke)|0,l=l+Math.imul(B,he)|0,p=p+Math.imul(B,ke)|0,m=m+Math.imul(x,ae)|0,l=l+Math.imul(x,Ve)|0,l=l+Math.imul(H,ae)|0,p=p+Math.imul(H,Ve)|0;var Yt=(y+m|0)+((l&8191)<<13)|0;y=(p+(l>>>13)|0)+(Yt>>>26)|0,Yt&=67108863,m=Math.imul(re,ne),l=Math.imul(re,$e),l=l+Math.imul(Ne,ne)|0,p=Math.imul(Ne,$e),m=m+Math.imul(oe,xe)|0,l=l+Math.imul(oe,Ze)|0,l=l+Math.imul(ze,xe)|0,p=p+Math.imul(ze,Ze)|0,m=m+Math.imul(ie,_e)|0,l=l+Math.imul(ie,tt)|0,l=l+Math.imul(Ce,_e)|0,p=p+Math.imul(Ce,tt)|0,m=m+Math.imul(W,Ee)|0,l=l+Math.imul(W,Be)|0,l=l+Math.imul(te,Ee)|0,p=p+Math.imul(te,Be)|0,m=m+Math.imul(q,he)|0,l=l+Math.imul(q,ke)|0,l=l+Math.imul(S,he)|0,p=p+Math.imul(S,ke)|0,m=m+Math.imul(G,ae)|0,l=l+Math.imul(G,Ve)|0,l=l+Math.imul(B,ae)|0,p=p+Math.imul(B,Ve)|0,m=m+Math.imul(x,de)|0,l=l+Math.imul(x,Ge)|0,l=l+Math.imul(H,de)|0,p=p+Math.imul(H,Ge)|0;var mt=(y+m|0)+((l&8191)<<13)|0;y=(p+(l>>>13)|0)+(mt>>>26)|0,mt&=67108863,m=Math.imul(ee,ne),l=Math.imul(ee,$e),l=l+Math.imul(Ie,ne)|0,p=Math.imul(Ie,$e),m=m+Math.imul(re,xe)|0,l=l+Math.imul(re,Ze)|0,l=l+Math.imul(Ne,xe)|0,p=p+Math.imul(Ne,Ze)|0,m=m+Math.imul(oe,_e)|0,l=l+Math.imul(oe,tt)|0,l=l+Math.imul(ze,_e)|0,p=p+Math.imul(ze,tt)|0,m=m+Math.imul(ie,Ee)|0,l=l+Math.imul(ie,Be)|0,l=l+Math.imul(Ce,Ee)|0,p=p+Math.imul(Ce,Be)|0,m=m+Math.imul(W,he)|0,l=l+Math.imul(W,ke)|0,l=l+Math.imul(te,he)|0,p=p+Math.imul(te,ke)|0,m=m+Math.imul(q,ae)|0,l=l+Math.imul(q,Ve)|0,l=l+Math.imul(S,ae)|0,p=p+Math.imul(S,Ve)|0,m=m+Math.imul(G,de)|0,l=l+Math.imul(G,Ge)|0,l=l+Math.imul(B,de)|0,p=p+Math.imul(B,Ge)|0,m=m+Math.imul(x,ue)|0,l=l+Math.imul(x,Ke)|0,l=l+Math.imul(H,ue)|0,p=p+Math.imul(H,Ke)|0;var Xt=(y+m|0)+((l&8191)<<13)|0;y=(p+(l>>>13)|0)+(Xt>>>26)|0,Xt&=67108863,m=Math.imul(Y,ne),l=Math.imul(Y,$e),l=l+Math.imul(Pe,ne)|0,p=Math.imul(Pe,$e),m=m+Math.imul(ee,xe)|0,l=l+Math.imul(ee,Ze)|0,l=l+Math.imul(Ie,xe)|0,p=p+Math.imul(Ie,Ze)|0,m=m+Math.imul(re,_e)|0,l=l+Math.imul(re,tt)|0,l=l+Math.imul(Ne,_e)|0,p=p+Math.imul(Ne,tt)|0,m=m+Math.imul(oe,Ee)|0,l=l+Math.imul(oe,Be)|0,l=l+Math.imul(ze,Ee)|0,p=p+Math.imul(ze,Be)|0,m=m+Math.imul(ie,he)|0,l=l+Math.imul(ie,ke)|0,l=l+Math.imul(Ce,he)|0,p=p+Math.imul(Ce,ke)|0,m=m+Math.imul(W,ae)|0,l=l+Math.imul(W,Ve)|0,l=l+Math.imul(te,ae)|0,p=p+Math.imul(te,Ve)|0,m=m+Math.imul(q,de)|0,l=l+Math.imul(q,Ge)|0,l=l+Math.imul(S,de)|0,p=p+Math.imul(S,Ge)|0,m=m+Math.imul(G,ue)|0,l=l+Math.imul(G,Ke)|0,l=l+Math.imul(B,ue)|0,p=p+Math.imul(B,Ke)|0,m=m+Math.imul(x,pe)|0,l=l+Math.imul(x,We)|0,l=l+Math.imul(H,pe)|0,p=p+Math.imul(H,We)|0;var Zt=(y+m|0)+((l&8191)<<13)|0;y=(p+(l>>>13)|0)+(Zt>>>26)|0,Zt&=67108863,m=Math.imul(Q,ne),l=Math.imul(Q,$e),l=l+Math.imul(Le,ne)|0,p=Math.imul(Le,$e),m=m+Math.imul(Y,xe)|0,l=l+Math.imul(Y,Ze)|0,l=l+Math.imul(Pe,xe)|0,p=p+Math.imul(Pe,Ze)|0,m=m+Math.imul(ee,_e)|0,l=l+Math.imul(ee,tt)|0,l=l+Math.imul(Ie,_e)|0,p=p+Math.imul(Ie,tt)|0,m=m+Math.imul(re,Ee)|0,l=l+Math.imul(re,Be)|0,l=l+Math.imul(Ne,Ee)|0,p=p+Math.imul(Ne,Be)|0,m=m+Math.imul(oe,he)|0,l=l+Math.imul(oe,ke)|0,l=l+Math.imul(ze,he)|0,p=p+Math.imul(ze,ke)|0,m=m+Math.imul(ie,ae)|0,l=l+Math.imul(ie,Ve)|0,l=l+Math.imul(Ce,ae)|0,p=p+Math.imul(Ce,Ve)|0,m=m+Math.imul(W,de)|0,l=l+Math.imul(W,Ge)|0,l=l+Math.imul(te,de)|0,p=p+Math.imul(te,Ge)|0,m=m+Math.imul(q,ue)|0,l=l+Math.imul(q,Ke)|0,l=l+Math.imul(S,ue)|0,p=p+Math.imul(S,Ke)|0,m=m+Math.imul(G,pe)|0,l=l+Math.imul(G,We)|0,l=l+Math.imul(B,pe)|0,p=p+Math.imul(B,We)|0,m=m+Math.imul(x,Oe)|0,l=l+Math.imul(x,rt)|0,l=l+Math.imul(H,Oe)|0,p=p+Math.imul(H,rt)|0;var Qt=(y+m|0)+((l&8191)<<13)|0;y=(p+(l>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,m=Math.imul(Q,xe),l=Math.imul(Q,Ze),l=l+Math.imul(Le,xe)|0,p=Math.imul(Le,Ze),m=m+Math.imul(Y,_e)|0,l=l+Math.imul(Y,tt)|0,l=l+Math.imul(Pe,_e)|0,p=p+Math.imul(Pe,tt)|0,m=m+Math.imul(ee,Ee)|0,l=l+Math.imul(ee,Be)|0,l=l+Math.imul(Ie,Ee)|0,p=p+Math.imul(Ie,Be)|0,m=m+Math.imul(re,he)|0,l=l+Math.imul(re,ke)|0,l=l+Math.imul(Ne,he)|0,p=p+Math.imul(Ne,ke)|0,m=m+Math.imul(oe,ae)|0,l=l+Math.imul(oe,Ve)|0,l=l+Math.imul(ze,ae)|0,p=p+Math.imul(ze,Ve)|0,m=m+Math.imul(ie,de)|0,l=l+Math.imul(ie,Ge)|0,l=l+Math.imul(Ce,de)|0,p=p+Math.imul(Ce,Ge)|0,m=m+Math.imul(W,ue)|0,l=l+Math.imul(W,Ke)|0,l=l+Math.imul(te,ue)|0,p=p+Math.imul(te,Ke)|0,m=m+Math.imul(q,pe)|0,l=l+Math.imul(q,We)|0,l=l+Math.imul(S,pe)|0,p=p+Math.imul(S,We)|0,m=m+Math.imul(G,Oe)|0,l=l+Math.imul(G,rt)|0,l=l+Math.imul(B,Oe)|0,p=p+Math.imul(B,rt)|0;var er=(y+m|0)+((l&8191)<<13)|0;y=(p+(l>>>13)|0)+(er>>>26)|0,er&=67108863,m=Math.imul(Q,_e),l=Math.imul(Q,tt),l=l+Math.imul(Le,_e)|0,p=Math.imul(Le,tt),m=m+Math.imul(Y,Ee)|0,l=l+Math.imul(Y,Be)|0,l=l+Math.imul(Pe,Ee)|0,p=p+Math.imul(Pe,Be)|0,m=m+Math.imul(ee,he)|0,l=l+Math.imul(ee,ke)|0,l=l+Math.imul(Ie,he)|0,p=p+Math.imul(Ie,ke)|0,m=m+Math.imul(re,ae)|0,l=l+Math.imul(re,Ve)|0,l=l+Math.imul(Ne,ae)|0,p=p+Math.imul(Ne,Ve)|0,m=m+Math.imul(oe,de)|0,l=l+Math.imul(oe,Ge)|0,l=l+Math.imul(ze,de)|0,p=p+Math.imul(ze,Ge)|0,m=m+Math.imul(ie,ue)|0,l=l+Math.imul(ie,Ke)|0,l=l+Math.imul(Ce,ue)|0,p=p+Math.imul(Ce,Ke)|0,m=m+Math.imul(W,pe)|0,l=l+Math.imul(W,We)|0,l=l+Math.imul(te,pe)|0,p=p+Math.imul(te,We)|0,m=m+Math.imul(q,Oe)|0,l=l+Math.imul(q,rt)|0,l=l+Math.imul(S,Oe)|0,p=p+Math.imul(S,rt)|0;var tr=(y+m|0)+((l&8191)<<13)|0;y=(p+(l>>>13)|0)+(tr>>>26)|0,tr&=67108863,m=Math.imul(Q,Ee),l=Math.imul(Q,Be),l=l+Math.imul(Le,Ee)|0,p=Math.imul(Le,Be),m=m+Math.imul(Y,he)|0,l=l+Math.imul(Y,ke)|0,l=l+Math.imul(Pe,he)|0,p=p+Math.imul(Pe,ke)|0,m=m+Math.imul(ee,ae)|0,l=l+Math.imul(ee,Ve)|0,l=l+Math.imul(Ie,ae)|0,p=p+Math.imul(Ie,Ve)|0,m=m+Math.imul(re,de)|0,l=l+Math.imul(re,Ge)|0,l=l+Math.imul(Ne,de)|0,p=p+Math.imul(Ne,Ge)|0,m=m+Math.imul(oe,ue)|0,l=l+Math.imul(oe,Ke)|0,l=l+Math.imul(ze,ue)|0,p=p+Math.imul(ze,Ke)|0,m=m+Math.imul(ie,pe)|0,l=l+Math.imul(ie,We)|0,l=l+Math.imul(Ce,pe)|0,p=p+Math.imul(Ce,We)|0,m=m+Math.imul(W,Oe)|0,l=l+Math.imul(W,rt)|0,l=l+Math.imul(te,Oe)|0,p=p+Math.imul(te,rt)|0;var Rt=(y+m|0)+((l&8191)<<13)|0;y=(p+(l>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,m=Math.imul(Q,he),l=Math.imul(Q,ke),l=l+Math.imul(Le,he)|0,p=Math.imul(Le,ke),m=m+Math.imul(Y,ae)|0,l=l+Math.imul(Y,Ve)|0,l=l+Math.imul(Pe,ae)|0,p=p+Math.imul(Pe,Ve)|0,m=m+Math.imul(ee,de)|0,l=l+Math.imul(ee,Ge)|0,l=l+Math.imul(Ie,de)|0,p=p+Math.imul(Ie,Ge)|0,m=m+Math.imul(re,ue)|0,l=l+Math.imul(re,Ke)|0,l=l+Math.imul(Ne,ue)|0,p=p+Math.imul(Ne,Ke)|0,m=m+Math.imul(oe,pe)|0,l=l+Math.imul(oe,We)|0,l=l+Math.imul(ze,pe)|0,p=p+Math.imul(ze,We)|0,m=m+Math.imul(ie,Oe)|0,l=l+Math.imul(ie,rt)|0,l=l+Math.imul(Ce,Oe)|0,p=p+Math.imul(Ce,rt)|0;var rr=(y+m|0)+((l&8191)<<13)|0;y=(p+(l>>>13)|0)+(rr>>>26)|0,rr&=67108863,m=Math.imul(Q,ae),l=Math.imul(Q,Ve),l=l+Math.imul(Le,ae)|0,p=Math.imul(Le,Ve),m=m+Math.imul(Y,de)|0,l=l+Math.imul(Y,Ge)|0,l=l+Math.imul(Pe,de)|0,p=p+Math.imul(Pe,Ge)|0,m=m+Math.imul(ee,ue)|0,l=l+Math.imul(ee,Ke)|0,l=l+Math.imul(Ie,ue)|0,p=p+Math.imul(Ie,Ke)|0,m=m+Math.imul(re,pe)|0,l=l+Math.imul(re,We)|0,l=l+Math.imul(Ne,pe)|0,p=p+Math.imul(Ne,We)|0,m=m+Math.imul(oe,Oe)|0,l=l+Math.imul(oe,rt)|0,l=l+Math.imul(ze,Oe)|0,p=p+Math.imul(ze,rt)|0;var ir=(y+m|0)+((l&8191)<<13)|0;y=(p+(l>>>13)|0)+(ir>>>26)|0,ir&=67108863,m=Math.imul(Q,de),l=Math.imul(Q,Ge),l=l+Math.imul(Le,de)|0,p=Math.imul(Le,Ge),m=m+Math.imul(Y,ue)|0,l=l+Math.imul(Y,Ke)|0,l=l+Math.imul(Pe,ue)|0,p=p+Math.imul(Pe,Ke)|0,m=m+Math.imul(ee,pe)|0,l=l+Math.imul(ee,We)|0,l=l+Math.imul(Ie,pe)|0,p=p+Math.imul(Ie,We)|0,m=m+Math.imul(re,Oe)|0,l=l+Math.imul(re,rt)|0,l=l+Math.imul(Ne,Oe)|0,p=p+Math.imul(Ne,rt)|0;var gt=(y+m|0)+((l&8191)<<13)|0;y=(p+(l>>>13)|0)+(gt>>>26)|0,gt&=67108863,m=Math.imul(Q,ue),l=Math.imul(Q,Ke),l=l+Math.imul(Le,ue)|0,p=Math.imul(Le,Ke),m=m+Math.imul(Y,pe)|0,l=l+Math.imul(Y,We)|0,l=l+Math.imul(Pe,pe)|0,p=p+Math.imul(Pe,We)|0,m=m+Math.imul(ee,Oe)|0,l=l+Math.imul(ee,rt)|0,l=l+Math.imul(Ie,Oe)|0,p=p+Math.imul(Ie,rt)|0;var nr=(y+m|0)+((l&8191)<<13)|0;y=(p+(l>>>13)|0)+(nr>>>26)|0,nr&=67108863,m=Math.imul(Q,pe),l=Math.imul(Q,We),l=l+Math.imul(Le,pe)|0,p=Math.imul(Le,We),m=m+Math.imul(Y,Oe)|0,l=l+Math.imul(Y,rt)|0,l=l+Math.imul(Pe,Oe)|0,p=p+Math.imul(Pe,rt)|0;var sr=(y+m|0)+((l&8191)<<13)|0;y=(p+(l>>>13)|0)+(sr>>>26)|0,sr&=67108863,m=Math.imul(Q,Oe),l=Math.imul(Q,rt),l=l+Math.imul(Le,Oe)|0,p=Math.imul(Le,rt);var ar=(y+m|0)+((l&8191)<<13)|0;return y=(p+(l>>>13)|0)+(ar>>>26)|0,ar&=67108863,v[0]=Fe,v[1]=je,v[2]=Gt,v[3]=Wt,v[4]=Jt,v[5]=Yt,v[6]=mt,v[7]=Xt,v[8]=Zt,v[9]=Qt,v[10]=er,v[11]=tr,v[12]=Rt,v[13]=rr,v[14]=ir,v[15]=gt,v[16]=nr,v[17]=sr,v[18]=ar,y!==0&&(v[19]=y,a.length++),a};Math.imul||(N=D);function U(P,w,c){c.negative=w.negative^P.negative,c.length=P.length+w.length;for(var a=0,o=0,d=0;d<c.length-1;d++){var v=o;o=0;for(var y=a&67108863,m=Math.min(d,w.length-1),l=Math.max(0,d-P.length+1);l<=m;l++){var p=d-l,f=P.words[p]|0,x=w.words[l]|0,H=f*x,j=H&67108863;v=v+(H/67108864|0)|0,j=j+y|0,y=j&67108863,v=v+(j>>>26)|0,o+=v>>>26,v&=67108863}c.words[d]=y,a=v,v=o}return a!==0?c.words[d]=a:c.length--,c.strip()}function k(P,w,c){var a=new T;return a.mulp(P,w,c)}s.prototype.mulTo=function(w,c){var a,o=this.length+w.length;return this.length===10&&w.length===10?a=N(this,w,c):o<63?a=D(this,w,c):o<1024?a=U(this,w,c):a=k(this,w,c),a};function T(P,w){this.x=P,this.y=w}T.prototype.makeRBT=function(w){for(var c=new Array(w),a=s.prototype._countBits(w)-1,o=0;o<w;o++)c[o]=this.revBin(o,a,w);return c},T.prototype.revBin=function(w,c,a){if(w===0||w===a-1)return w;for(var o=0,d=0;d<c;d++)o|=(w&1)<<c-d-1,w>>=1;return o},T.prototype.permute=function(w,c,a,o,d,v){for(var y=0;y<v;y++)o[y]=c[w[y]],d[y]=a[w[y]]},T.prototype.transform=function(w,c,a,o,d,v){this.permute(v,w,c,a,o,d);for(var y=1;y<d;y<<=1)for(var m=y<<1,l=Math.cos(2*Math.PI/m),p=Math.sin(2*Math.PI/m),f=0;f<d;f+=m)for(var x=l,H=p,j=0;j<y;j++){var G=a[f+j],B=o[f+j],z=a[f+j+y],q=o[f+j+y],S=x*z-H*q;q=x*q+H*z,z=S,a[f+j]=G+z,o[f+j]=B+q,a[f+j+y]=G-z,o[f+j+y]=B-q,j!==m&&(S=l*x-p*H,H=l*H+p*x,x=S)}},T.prototype.guessLen13b=function(w,c){var a=Math.max(c,w)|1,o=a&1,d=0;for(a=a/2|0;a;a=a>>>1)d++;return 1<<d+1+o},T.prototype.conjugate=function(w,c,a){if(!(a<=1))for(var o=0;o<a/2;o++){var d=w[o];w[o]=w[a-o-1],w[a-o-1]=d,d=c[o],c[o]=-c[a-o-1],c[a-o-1]=-d}},T.prototype.normalize13b=function(w,c){for(var a=0,o=0;o<c/2;o++){var d=Math.round(w[2*o+1]/c)*8192+Math.round(w[2*o]/c)+a;w[o]=d&67108863,d<67108864?a=0:a=d/67108864|0}return w},T.prototype.convert13b=function(w,c,a,o){for(var d=0,v=0;v<c;v++)d=d+(w[v]|0),a[2*v]=d&8191,d=d>>>13,a[2*v+1]=d&8191,d=d>>>13;for(v=2*c;v<o;++v)a[v]=0;i(d===0),i((d&-8192)===0)},T.prototype.stub=function(w){for(var c=new Array(w),a=0;a<w;a++)c[a]=0;return c},T.prototype.mulp=function(w,c,a){var o=2*this.guessLen13b(w.length,c.length),d=this.makeRBT(o),v=this.stub(o),y=new Array(o),m=new Array(o),l=new Array(o),p=new Array(o),f=new Array(o),x=new Array(o),H=a.words;H.length=o,this.convert13b(w.words,w.length,y,o),this.convert13b(c.words,c.length,p,o),this.transform(y,v,m,l,o,d),this.transform(p,v,f,x,o,d);for(var j=0;j<o;j++){var G=m[j]*f[j]-l[j]*x[j];l[j]=m[j]*x[j]+l[j]*f[j],m[j]=G}return this.conjugate(m,l,o),this.transform(m,l,H,v,o,d),this.conjugate(H,v,o),this.normalize13b(H,o),a.negative=w.negative^c.negative,a.length=w.length+c.length,a.strip()},s.prototype.mul=function(w){var c=new s(null);return c.words=new Array(this.length+w.length),this.mulTo(w,c)},s.prototype.mulf=function(w){var c=new s(null);return c.words=new Array(this.length+w.length),k(this,w,c)},s.prototype.imul=function(w){return this.clone().mulTo(w,this)},s.prototype.imuln=function(w){i(typeof w=="number"),i(w<67108864);for(var c=0,a=0;a<this.length;a++){var o=(this.words[a]|0)*w,d=(o&67108863)+(c&67108863);c>>=26,c+=o/67108864|0,c+=d>>>26,this.words[a]=d&67108863}return c!==0&&(this.words[a]=c,this.length++),this},s.prototype.muln=function(w){return this.clone().imuln(w)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(w){var c=I(w);if(c.length===0)return new s(1);for(var a=this,o=0;o<c.length&&c[o]===0;o++,a=a.sqr());if(++o<c.length)for(var d=a.sqr();o<c.length;o++,d=d.sqr())c[o]!==0&&(a=a.mul(d));return a},s.prototype.iushln=function(w){i(typeof w=="number"&&w>=0);var c=w%26,a=(w-c)/26,o=67108863>>>26-c<<26-c,d;if(c!==0){var v=0;for(d=0;d<this.length;d++){var y=this.words[d]&o,m=(this.words[d]|0)-y<<c;this.words[d]=m|v,v=y>>>26-c}v&&(this.words[d]=v,this.length++)}if(a!==0){for(d=this.length-1;d>=0;d--)this.words[d+a]=this.words[d];for(d=0;d<a;d++)this.words[d]=0;this.length+=a}return this.strip()},s.prototype.ishln=function(w){return i(this.negative===0),this.iushln(w)},s.prototype.iushrn=function(w,c,a){i(typeof w=="number"&&w>=0);var o;c?o=(c-c%26)/26:o=0;var d=w%26,v=Math.min((w-d)/26,this.length),y=67108863^67108863>>>d<<d,m=a;if(o-=v,o=Math.max(0,o),m){for(var l=0;l<v;l++)m.words[l]=this.words[l];m.length=v}if(v!==0)if(this.length>v)for(this.length-=v,l=0;l<this.length;l++)this.words[l]=this.words[l+v];else this.words[0]=0,this.length=1;var p=0;for(l=this.length-1;l>=0&&(p!==0||l>=o);l--){var f=this.words[l]|0;this.words[l]=p<<26-d|f>>>d,p=f&y}return m&&p!==0&&(m.words[m.length++]=p),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},s.prototype.ishrn=function(w,c,a){return i(this.negative===0),this.iushrn(w,c,a)},s.prototype.shln=function(w){return this.clone().ishln(w)},s.prototype.ushln=function(w){return this.clone().iushln(w)},s.prototype.shrn=function(w){return this.clone().ishrn(w)},s.prototype.ushrn=function(w){return this.clone().iushrn(w)},s.prototype.testn=function(w){i(typeof w=="number"&&w>=0);var c=w%26,a=(w-c)/26,o=1<<c;if(this.length<=a)return!1;var d=this.words[a];return!!(d&o)},s.prototype.imaskn=function(w){i(typeof w=="number"&&w>=0);var c=w%26,a=(w-c)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=a)return this;if(c!==0&&a++,this.length=Math.min(a,this.length),c!==0){var o=67108863^67108863>>>c<<c;this.words[this.length-1]&=o}return this.strip()},s.prototype.maskn=function(w){return this.clone().imaskn(w)},s.prototype.iaddn=function(w){return i(typeof w=="number"),i(w<67108864),w<0?this.isubn(-w):this.negative!==0?this.length===1&&(this.words[0]|0)<w?(this.words[0]=w-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(w),this.negative=1,this):this._iaddn(w)},s.prototype._iaddn=function(w){this.words[0]+=w;for(var c=0;c<this.length&&this.words[c]>=67108864;c++)this.words[c]-=67108864,c===this.length-1?this.words[c+1]=1:this.words[c+1]++;return this.length=Math.max(this.length,c+1),this},s.prototype.isubn=function(w){if(i(typeof w=="number"),i(w<67108864),w<0)return this.iaddn(-w);if(this.negative!==0)return this.negative=0,this.iaddn(w),this.negative=1,this;if(this.words[0]-=w,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var c=0;c<this.length&&this.words[c]<0;c++)this.words[c]+=67108864,this.words[c+1]-=1;return this.strip()},s.prototype.addn=function(w){return this.clone().iaddn(w)},s.prototype.subn=function(w){return this.clone().isubn(w)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(w,c,a){var o=w.length+a,d;this._expand(o);var v,y=0;for(d=0;d<w.length;d++){v=(this.words[d+a]|0)+y;var m=(w.words[d]|0)*c;v-=m&67108863,y=(v>>26)-(m/67108864|0),this.words[d+a]=v&67108863}for(;d<this.length-a;d++)v=(this.words[d+a]|0)+y,y=v>>26,this.words[d+a]=v&67108863;if(y===0)return this.strip();for(i(y===-1),y=0,d=0;d<this.length;d++)v=-(this.words[d]|0)+y,y=v>>26,this.words[d]=v&67108863;return this.negative=1,this.strip()},s.prototype._wordDiv=function(w,c){var a=this.length-w.length,o=this.clone(),d=w,v=d.words[d.length-1]|0,y=this._countBits(v);a=26-y,a!==0&&(d=d.ushln(a),o.iushln(a),v=d.words[d.length-1]|0);var m=o.length-d.length,l;if(c!=="mod"){l=new s(null),l.length=m+1,l.words=new Array(l.length);for(var p=0;p<l.length;p++)l.words[p]=0}var f=o.clone()._ishlnsubmul(d,1,m);f.negative===0&&(o=f,l&&(l.words[m]=1));for(var x=m-1;x>=0;x--){var H=(o.words[d.length+x]|0)*67108864+(o.words[d.length+x-1]|0);for(H=Math.min(H/v|0,67108863),o._ishlnsubmul(d,H,x);o.negative!==0;)H--,o.negative=0,o._ishlnsubmul(d,1,x),o.isZero()||(o.negative^=1);l&&(l.words[x]=H)}return l&&l.strip(),o.strip(),c!=="div"&&a!==0&&o.iushrn(a),{div:l||null,mod:o}},s.prototype.divmod=function(w,c,a){if(i(!w.isZero()),this.isZero())return{div:new s(0),mod:new s(0)};var o,d,v;return this.negative!==0&&w.negative===0?(v=this.neg().divmod(w,c),c!=="mod"&&(o=v.div.neg()),c!=="div"&&(d=v.mod.neg(),a&&d.negative!==0&&d.iadd(w)),{div:o,mod:d}):this.negative===0&&w.negative!==0?(v=this.divmod(w.neg(),c),c!=="mod"&&(o=v.div.neg()),{div:o,mod:v.mod}):this.negative&w.negative?(v=this.neg().divmod(w.neg(),c),c!=="div"&&(d=v.mod.neg(),a&&d.negative!==0&&d.isub(w)),{div:v.div,mod:d}):w.length>this.length||this.cmp(w)<0?{div:new s(0),mod:this}:w.length===1?c==="div"?{div:this.divn(w.words[0]),mod:null}:c==="mod"?{div:null,mod:new s(this.modn(w.words[0]))}:{div:this.divn(w.words[0]),mod:new s(this.modn(w.words[0]))}:this._wordDiv(w,c)},s.prototype.div=function(w){return this.divmod(w,"div",!1).div},s.prototype.mod=function(w){return this.divmod(w,"mod",!1).mod},s.prototype.umod=function(w){return this.divmod(w,"mod",!0).mod},s.prototype.divRound=function(w){var c=this.divmod(w);if(c.mod.isZero())return c.div;var a=c.div.negative!==0?c.mod.isub(w):c.mod,o=w.ushrn(1),d=w.andln(1),v=a.cmp(o);return v<0||d===1&&v===0?c.div:c.div.negative!==0?c.div.isubn(1):c.div.iaddn(1)},s.prototype.modn=function(w){i(w<=67108863);for(var c=(1<<26)%w,a=0,o=this.length-1;o>=0;o--)a=(c*a+(this.words[o]|0))%w;return a},s.prototype.idivn=function(w){i(w<=67108863);for(var c=0,a=this.length-1;a>=0;a--){var o=(this.words[a]|0)+c*67108864;this.words[a]=o/w|0,c=o%w}return this.strip()},s.prototype.divn=function(w){return this.clone().idivn(w)},s.prototype.egcd=function(w){i(w.negative===0),i(!w.isZero());var c=this,a=w.clone();c.negative!==0?c=c.umod(w):c=c.clone();for(var o=new s(1),d=new s(0),v=new s(0),y=new s(1),m=0;c.isEven()&&a.isEven();)c.iushrn(1),a.iushrn(1),++m;for(var l=a.clone(),p=c.clone();!c.isZero();){for(var f=0,x=1;!(c.words[0]&x)&&f<26;++f,x<<=1);if(f>0)for(c.iushrn(f);f-- >0;)(o.isOdd()||d.isOdd())&&(o.iadd(l),d.isub(p)),o.iushrn(1),d.iushrn(1);for(var H=0,j=1;!(a.words[0]&j)&&H<26;++H,j<<=1);if(H>0)for(a.iushrn(H);H-- >0;)(v.isOdd()||y.isOdd())&&(v.iadd(l),y.isub(p)),v.iushrn(1),y.iushrn(1);c.cmp(a)>=0?(c.isub(a),o.isub(v),d.isub(y)):(a.isub(c),v.isub(o),y.isub(d))}return{a:v,b:y,gcd:a.iushln(m)}},s.prototype._invmp=function(w){i(w.negative===0),i(!w.isZero());var c=this,a=w.clone();c.negative!==0?c=c.umod(w):c=c.clone();for(var o=new s(1),d=new s(0),v=a.clone();c.cmpn(1)>0&&a.cmpn(1)>0;){for(var y=0,m=1;!(c.words[0]&m)&&y<26;++y,m<<=1);if(y>0)for(c.iushrn(y);y-- >0;)o.isOdd()&&o.iadd(v),o.iushrn(1);for(var l=0,p=1;!(a.words[0]&p)&&l<26;++l,p<<=1);if(l>0)for(a.iushrn(l);l-- >0;)d.isOdd()&&d.iadd(v),d.iushrn(1);c.cmp(a)>=0?(c.isub(a),o.isub(d)):(a.isub(c),d.isub(o))}var f;return c.cmpn(1)===0?f=o:f=d,f.cmpn(0)<0&&f.iadd(w),f},s.prototype.gcd=function(w){if(this.isZero())return w.abs();if(w.isZero())return this.abs();var c=this.clone(),a=w.clone();c.negative=0,a.negative=0;for(var o=0;c.isEven()&&a.isEven();o++)c.iushrn(1),a.iushrn(1);do{for(;c.isEven();)c.iushrn(1);for(;a.isEven();)a.iushrn(1);var d=c.cmp(a);if(d<0){var v=c;c=a,a=v}else if(d===0||a.cmpn(1)===0)break;c.isub(a)}while(!0);return a.iushln(o)},s.prototype.invm=function(w){return this.egcd(w).a.umod(w)},s.prototype.isEven=function(){return(this.words[0]&1)===0},s.prototype.isOdd=function(){return(this.words[0]&1)===1},s.prototype.andln=function(w){return this.words[0]&w},s.prototype.bincn=function(w){i(typeof w=="number");var c=w%26,a=(w-c)/26,o=1<<c;if(this.length<=a)return this._expand(a+1),this.words[a]|=o,this;for(var d=o,v=a;d!==0&&v<this.length;v++){var y=this.words[v]|0;y+=d,d=y>>>26,y&=67108863,this.words[v]=y}return d!==0&&(this.words[v]=d,this.length++),this},s.prototype.isZero=function(){return this.length===1&&this.words[0]===0},s.prototype.cmpn=function(w){var c=w<0;if(this.negative!==0&&!c)return-1;if(this.negative===0&&c)return 1;this.strip();var a;if(this.length>1)a=1;else{c&&(w=-w),i(w<=67108863,"Number is too big");var o=this.words[0]|0;a=o===w?0:o<w?-1:1}return this.negative!==0?-a|0:a},s.prototype.cmp=function(w){if(this.negative!==0&&w.negative===0)return-1;if(this.negative===0&&w.negative!==0)return 1;var c=this.ucmp(w);return this.negative!==0?-c|0:c},s.prototype.ucmp=function(w){if(this.length>w.length)return 1;if(this.length<w.length)return-1;for(var c=0,a=this.length-1;a>=0;a--){var o=this.words[a]|0,d=w.words[a]|0;if(o!==d){o<d?c=-1:o>d&&(c=1);break}}return c},s.prototype.gtn=function(w){return this.cmpn(w)===1},s.prototype.gt=function(w){return this.cmp(w)===1},s.prototype.gten=function(w){return this.cmpn(w)>=0},s.prototype.gte=function(w){return this.cmp(w)>=0},s.prototype.ltn=function(w){return this.cmpn(w)===-1},s.prototype.lt=function(w){return this.cmp(w)===-1},s.prototype.lten=function(w){return this.cmpn(w)<=0},s.prototype.lte=function(w){return this.cmp(w)<=0},s.prototype.eqn=function(w){return this.cmpn(w)===0},s.prototype.eq=function(w){return this.cmp(w)===0},s.red=function(w){return new J(w)},s.prototype.toRed=function(w){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),w.convertTo(this)._forceRed(w)},s.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(w){return this.red=w,this},s.prototype.forceRed=function(w){return i(!this.red,"Already a number in reduction context"),this._forceRed(w)},s.prototype.redAdd=function(w){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,w)},s.prototype.redIAdd=function(w){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,w)},s.prototype.redSub=function(w){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,w)},s.prototype.redISub=function(w){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,w)},s.prototype.redShl=function(w){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,w)},s.prototype.redMul=function(w){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,w),this.red.mul(this,w)},s.prototype.redIMul=function(w){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,w),this.red.imul(this,w)},s.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(w){return i(this.red&&!w.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,w)};var K={k256:null,p224:null,p192:null,p25519:null};function R(P,w){this.name=P,this.p=new s(w,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}R.prototype._tmp=function(){var w=new s(null);return w.words=new Array(Math.ceil(this.n/13)),w},R.prototype.ireduce=function(w){var c=w,a;do this.split(c,this.tmp),c=this.imulK(c),c=c.iadd(this.tmp),a=c.bitLength();while(a>this.n);var o=a<this.n?-1:c.ucmp(this.p);return o===0?(c.words[0]=0,c.length=1):o>0?c.isub(this.p):c.strip!==void 0?c.strip():c._strip(),c},R.prototype.split=function(w,c){w.iushrn(this.n,0,c)},R.prototype.imulK=function(w){return w.imul(this.k)};function C(){R.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(C,R),C.prototype.split=function(w,c){for(var a=4194303,o=Math.min(w.length,9),d=0;d<o;d++)c.words[d]=w.words[d];if(c.length=o,w.length<=9){w.words[0]=0,w.length=1;return}var v=w.words[9];for(c.words[c.length++]=v&a,d=10;d<w.length;d++){var y=w.words[d]|0;w.words[d-10]=(y&a)<<4|v>>>22,v=y}v>>>=22,w.words[d-10]=v,v===0&&w.length>10?w.length-=10:w.length-=9},C.prototype.imulK=function(w){w.words[w.length]=0,w.words[w.length+1]=0,w.length+=2;for(var c=0,a=0;a<w.length;a++){var o=w.words[a]|0;c+=o*977,w.words[a]=c&67108863,c=o*64+(c/67108864|0)}return w.words[w.length-1]===0&&(w.length--,w.words[w.length-1]===0&&w.length--),w};function $(){R.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n($,R);function E(){R.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(E,R);function O(){R.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(O,R),O.prototype.imulK=function(w){for(var c=0,a=0;a<w.length;a++){var o=(w.words[a]|0)*19+c,d=o&67108863;o>>>=26,w.words[a]=d,c=o}return c!==0&&(w.words[w.length++]=c),w},s._prime=function(w){if(K[w])return K[w];var c;if(w==="k256")c=new C;else if(w==="p224")c=new $;else if(w==="p192")c=new E;else if(w==="p25519")c=new O;else throw new Error("Unknown prime "+w);return K[w]=c,c};function J(P){if(typeof P=="string"){var w=s._prime(P);this.m=w.p,this.prime=w}else i(P.gtn(1),"modulus must be greater than 1"),this.m=P,this.prime=null}J.prototype._verify1=function(w){i(w.negative===0,"red works only with positives"),i(w.red,"red works only with red numbers")},J.prototype._verify2=function(w,c){i((w.negative|c.negative)===0,"red works only with positives"),i(w.red&&w.red===c.red,"red works only with red numbers")},J.prototype.imod=function(w){return this.prime?this.prime.ireduce(w)._forceRed(this):w.umod(this.m)._forceRed(this)},J.prototype.neg=function(w){return w.isZero()?w.clone():this.m.sub(w)._forceRed(this)},J.prototype.add=function(w,c){this._verify2(w,c);var a=w.add(c);return a.cmp(this.m)>=0&&a.isub(this.m),a._forceRed(this)},J.prototype.iadd=function(w,c){this._verify2(w,c);var a=w.iadd(c);return a.cmp(this.m)>=0&&a.isub(this.m),a},J.prototype.sub=function(w,c){this._verify2(w,c);var a=w.sub(c);return a.cmpn(0)<0&&a.iadd(this.m),a._forceRed(this)},J.prototype.isub=function(w,c){this._verify2(w,c);var a=w.isub(c);return a.cmpn(0)<0&&a.iadd(this.m),a},J.prototype.shl=function(w,c){return this._verify1(w),this.imod(w.ushln(c))},J.prototype.imul=function(w,c){return this._verify2(w,c),this.imod(w.imul(c))},J.prototype.mul=function(w,c){return this._verify2(w,c),this.imod(w.mul(c))},J.prototype.isqr=function(w){return this.imul(w,w.clone())},J.prototype.sqr=function(w){return this.mul(w,w)},J.prototype.sqrt=function(w){if(w.isZero())return w.clone();var c=this.m.andln(3);if(i(c%2===1),c===3){var a=this.m.add(new s(1)).iushrn(2);return this.pow(w,a)}for(var o=this.m.subn(1),d=0;!o.isZero()&&o.andln(1)===0;)d++,o.iushrn(1);i(!o.isZero());var v=new s(1).toRed(this),y=v.redNeg(),m=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new s(2*l*l).toRed(this);this.pow(l,m).cmp(y)!==0;)l.redIAdd(y);for(var p=this.pow(l,o),f=this.pow(w,o.addn(1).iushrn(1)),x=this.pow(w,o),H=d;x.cmp(v)!==0;){for(var j=x,G=0;j.cmp(v)!==0;G++)j=j.redSqr();i(G<H);var B=this.pow(p,new s(1).iushln(H-G-1));f=f.redMul(B),p=B.redSqr(),x=x.redMul(p),H=G}return f},J.prototype.invm=function(w){var c=w._invmp(this.m);return c.negative!==0?(c.negative=0,this.imod(c).redNeg()):this.imod(c)},J.prototype.pow=function(w,c){if(c.isZero())return new s(1).toRed(this);if(c.cmpn(1)===0)return w.clone();var a=4,o=new Array(1<<a);o[0]=new s(1).toRed(this),o[1]=w;for(var d=2;d<o.length;d++)o[d]=this.mul(o[d-1],w);var v=o[0],y=0,m=0,l=c.bitLength()%26;for(l===0&&(l=26),d=c.length-1;d>=0;d--){for(var p=c.words[d],f=l-1;f>=0;f--){var x=p>>f&1;if(v!==o[0]&&(v=this.sqr(v)),x===0&&y===0){m=0;continue}y<<=1,y|=x,m++,!(m!==a&&(d!==0||f!==0))&&(v=this.mul(v,o[y]),m=0,y=0)}l=26}return v},J.prototype.convertTo=function(w){var c=w.umod(this.m);return c===w?c.clone():c},J.prototype.convertFrom=function(w){var c=w.clone();return c.red=null,c},s.mont=function(w){return new Z(w)};function Z(P){J.call(this,P),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(Z,J),Z.prototype.convertTo=function(w){return this.imod(w.ushln(this.shift))},Z.prototype.convertFrom=function(w){var c=this.imod(w.mul(this.rinv));return c.red=null,c},Z.prototype.imul=function(w,c){if(w.isZero()||c.isZero())return w.words[0]=0,w.length=1,w;var a=w.imul(c),o=a.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),d=a.isub(o).iushrn(this.shift),v=d;return d.cmp(this.m)>=0?v=d.isub(this.m):d.cmpn(0)<0&&(v=d.iadd(this.m)),v._forceRed(this)},Z.prototype.mul=function(w,c){if(w.isZero()||c.isZero())return new s(0)._forceRed(this);var a=w.mul(c),o=a.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),d=a.isub(o).iushrn(this.shift),v=d;return d.cmp(this.m)>=0?v=d.isub(this.m):d.cmpn(0)<0&&(v=d.iadd(this.m)),v._forceRed(this)},Z.prototype.invm=function(w){var c=this.imod(w._invmp(this.m).mul(this.r2));return c._forceRed(this)}})(r,Oi)})(zo);var oi=zo.exports,Bo={};(function(r){var e=r;function t(s,h){if(Array.isArray(s))return s.slice();if(!s)return[];var u=[];if(typeof s!="string"){for(var g=0;g<s.length;g++)u[g]=s[g]|0;return u}if(h==="hex"){s=s.replace(/[^a-z0-9]+/ig,""),s.length%2!==0&&(s="0"+s);for(var g=0;g<s.length;g+=2)u.push(parseInt(s[g]+s[g+1],16))}else for(var g=0;g<s.length;g++){var b=s.charCodeAt(g),_=b>>8,M=b&255;_?u.push(_,M):u.push(M)}return u}e.toArray=t;function i(s){return s.length===1?"0"+s:s}e.zero2=i;function n(s){for(var h="",u=0;u<s.length;u++)h+=i(s[u].toString(16));return h}e.toHex=n,e.encode=function(h,u){return u==="hex"?n(h):h}})(Bo);(function(r){var e=r,t=oi,i=ki,n=Bo;e.assert=i,e.toArray=n.toArray,e.zero2=n.zero2,e.toHex=n.toHex,e.encode=n.encode;function s(_,M,A){var I=new Array(Math.max(_.bitLength(),A)+1),D;for(D=0;D<I.length;D+=1)I[D]=0;var N=1<<M+1,U=_.clone();for(D=0;D<I.length;D++){var k,T=U.andln(N-1);U.isOdd()?(T>(N>>1)-1?k=(N>>1)-T:k=T,U.isubn(k)):k=0,I[D]=k,U.iushrn(1)}return I}e.getNAF=s;function h(_,M){var A=[[],[]];_=_.clone(),M=M.clone();for(var I=0,D=0,N;_.cmpn(-I)>0||M.cmpn(-D)>0;){var U=_.andln(3)+I&3,k=M.andln(3)+D&3;U===3&&(U=-1),k===3&&(k=-1);var T;U&1?(N=_.andln(7)+I&7,(N===3||N===5)&&k===2?T=-U:T=U):T=0,A[0].push(T);var K;k&1?(N=M.andln(7)+D&7,(N===3||N===5)&&U===2?K=-k:K=k):K=0,A[1].push(K),2*I===T+1&&(I=1-I),2*D===K+1&&(D=1-D),_.iushrn(1),M.iushrn(1)}return A}e.getJSF=h;function u(_,M,A){var I="_"+M;_.prototype[M]=function(){return this[I]!==void 0?this[I]:this[I]=A.call(this)}}e.cachedProperty=u;function g(_){return typeof _=="string"?e.toArray(_,"hex"):_}e.parseBytes=g;function b(_){return new t(_,"hex","le")}e.intFromLE=b})(lr);var ko={exports:{}},qa;ko.exports=function(e){return qa||(qa=new di(null)),qa.generate(e)};function di(r){this.rand=r}ko.exports.Rand=di;di.prototype.generate=function(e){return this._rand(e)};di.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),i=0;i<t.length;i++)t[i]=this.rand.getByte();return t};if(typeof self=="object")self.crypto&&self.crypto.getRandomValues?di.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?di.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:typeof window=="object"&&(di.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var oh=Vn;if(typeof oh.randomBytes!="function")throw new Error("Not supported");di.prototype._rand=function(e){return oh.randomBytes(e)}}catch{}var Eu=ko.exports,Ko={},Si=oi,es=lr,qs=es.getNAF,Lb=es.getJSF,Us=es.assert;function wi(r,e){this.type=r,this.p=new Si(e.p,16),this.red=e.prime?Si.red(e.prime):Si.mont(this.p),this.zero=new Si(0).toRed(this.red),this.one=new Si(1).toRed(this.red),this.two=new Si(2).toRed(this.red),this.n=e.n&&new Si(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var t=this.n&&this.p.div(this.n);!t||t.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var oa=wi;wi.prototype.point=function(){throw new Error("Not implemented")};wi.prototype.validate=function(){throw new Error("Not implemented")};wi.prototype._fixedNafMul=function(e,t){Us(e.precomputed);var i=e._getDoubles(),n=qs(t,1,this._bitLength),s=(1<<i.step+1)-(i.step%2===0?2:1);s/=3;var h=[],u,g;for(u=0;u<n.length;u+=i.step){g=0;for(var b=u+i.step-1;b>=u;b--)g=(g<<1)+n[b];h.push(g)}for(var _=this.jpoint(null,null,null),M=this.jpoint(null,null,null),A=s;A>0;A--){for(u=0;u<h.length;u++)g=h[u],g===A?M=M.mixedAdd(i.points[u]):g===-A&&(M=M.mixedAdd(i.points[u].neg()));_=_.add(M)}return _.toP()};wi.prototype._wnafMul=function(e,t){var i=4,n=e._getNAFPoints(i);i=n.wnd;for(var s=n.points,h=qs(t,i,this._bitLength),u=this.jpoint(null,null,null),g=h.length-1;g>=0;g--){for(var b=0;g>=0&&h[g]===0;g--)b++;if(g>=0&&b++,u=u.dblp(b),g<0)break;var _=h[g];Us(_!==0),e.type==="affine"?_>0?u=u.mixedAdd(s[_-1>>1]):u=u.mixedAdd(s[-_-1>>1].neg()):_>0?u=u.add(s[_-1>>1]):u=u.add(s[-_-1>>1].neg())}return e.type==="affine"?u.toP():u};wi.prototype._wnafMulAdd=function(e,t,i,n,s){var h=this._wnafT1,u=this._wnafT2,g=this._wnafT3,b=0,_,M,A;for(_=0;_<n;_++){A=t[_];var I=A._getNAFPoints(e);h[_]=I.wnd,u[_]=I.points}for(_=n-1;_>=1;_-=2){var D=_-1,N=_;if(h[D]!==1||h[N]!==1){g[D]=qs(i[D],h[D],this._bitLength),g[N]=qs(i[N],h[N],this._bitLength),b=Math.max(g[D].length,b),b=Math.max(g[N].length,b);continue}var U=[t[D],null,null,t[N]];t[D].y.cmp(t[N].y)===0?(U[1]=t[D].add(t[N]),U[2]=t[D].toJ().mixedAdd(t[N].neg())):t[D].y.cmp(t[N].y.redNeg())===0?(U[1]=t[D].toJ().mixedAdd(t[N]),U[2]=t[D].add(t[N].neg())):(U[1]=t[D].toJ().mixedAdd(t[N]),U[2]=t[D].toJ().mixedAdd(t[N].neg()));var k=[-3,-1,-5,-7,0,7,5,1,3],T=Lb(i[D],i[N]);for(b=Math.max(T[0].length,b),g[D]=new Array(b),g[N]=new Array(b),M=0;M<b;M++){var K=T[0][M]|0,R=T[1][M]|0;g[D][M]=k[(K+1)*3+(R+1)],g[N][M]=0,u[D]=U}}var C=this.jpoint(null,null,null),$=this._wnafT4;for(_=b;_>=0;_--){for(var E=0;_>=0;){var O=!0;for(M=0;M<n;M++)$[M]=g[M][_]|0,$[M]!==0&&(O=!1);if(!O)break;E++,_--}if(_>=0&&E++,C=C.dblp(E),_<0)break;for(M=0;M<n;M++){var J=$[M];J!==0&&(J>0?A=u[M][J-1>>1]:J<0&&(A=u[M][-J-1>>1].neg()),A.type==="affine"?C=C.mixedAdd(A):C=C.add(A))}}for(_=0;_<n;_++)u[_]=null;return s?C:C.toP()};function Mr(r,e){this.curve=r,this.type=e,this.precomputed=null}wi.BasePoint=Mr;Mr.prototype.eq=function(){throw new Error("Not implemented")};Mr.prototype.validate=function(){return this.curve.validate(this)};wi.prototype.decodePoint=function(e,t){e=es.toArray(e,t);var i=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*i){e[0]===6?Us(e[e.length-1]%2===0):e[0]===7&&Us(e[e.length-1]%2===1);var n=this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));return n}else if((e[0]===2||e[0]===3)&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),e[0]===3);throw new Error("Unknown point format")};Mr.prototype.encodeCompressed=function(e){return this.encode(e,!0)};Mr.prototype._encode=function(e){var t=this.curve.p.byteLength(),i=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",t))};Mr.prototype.encode=function(e,t){return es.encode(this._encode(t),e)};Mr.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this};Mr.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return t?t.points.length>=Math.ceil((e.bitLength()+1)/t.step):!1};Mr.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],n=this,s=0;s<t;s+=e){for(var h=0;h<e;h++)n=n.dbl();i.push(n)}return{step:e,points:i}};Mr.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],i=(1<<e)-1,n=i===1?null:this.dbl(),s=1;s<i;s++)t[s]=t[s-1].add(n);return{wnd:e,points:t}};Mr.prototype._getBeta=function(){return null};Mr.prototype.dblp=function(e){for(var t=this,i=0;i<e;i++)t=t.dbl();return t};var $b=lr,dt=oi,jo=ra,mn=oa,Fb=$b.assert;function Er(r){mn.call(this,"short",r),this.a=new dt(r.a,16).toRed(this.red),this.b=new dt(r.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(r),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}jo(Er,mn);var qb=Er;Er.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var t,i;if(e.beta)t=new dt(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);t=n[0].cmp(n[1])<0?n[0]:n[1],t=t.toRed(this.red)}if(e.lambda)i=new dt(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(t))===0?i=s[0]:(i=s[1],Fb(this.g.mul(i).x.cmp(this.g.x.redMul(t))===0))}var h;return e.basis?h=e.basis.map(function(u){return{a:new dt(u.a,16),b:new dt(u.b,16)}}):h=this._getEndoBasis(i),{beta:t,lambda:i,basis:h}}};Er.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:dt.mont(e),i=new dt(2).toRed(t).redInvm(),n=i.redNeg(),s=new dt(3).toRed(t).redNeg().redSqrt().redMul(i),h=n.redAdd(s).fromRed(),u=n.redSub(s).fromRed();return[h,u]};Er.prototype._getEndoBasis=function(e){for(var t=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=e,n=this.n.clone(),s=new dt(1),h=new dt(0),u=new dt(0),g=new dt(1),b,_,M,A,I,D,N,U=0,k,T;i.cmpn(0)!==0;){var K=n.div(i);k=n.sub(K.mul(i)),T=u.sub(K.mul(s));var R=g.sub(K.mul(h));if(!M&&k.cmp(t)<0)b=N.neg(),_=s,M=k.neg(),A=T;else if(M&&++U===2)break;N=k,n=i,i=k,u=s,s=T,g=h,h=R}I=k.neg(),D=T;var C=M.sqr().add(A.sqr()),$=I.sqr().add(D.sqr());return $.cmp(C)>=0&&(I=b,D=_),M.negative&&(M=M.neg(),A=A.neg()),I.negative&&(I=I.neg(),D=D.neg()),[{a:M,b:A},{a:I,b:D}]};Er.prototype._endoSplit=function(e){var t=this.endo.basis,i=t[0],n=t[1],s=n.b.mul(e).divRound(this.n),h=i.b.neg().mul(e).divRound(this.n),u=s.mul(i.a),g=h.mul(n.a),b=s.mul(i.b),_=h.mul(n.b),M=e.sub(u).sub(g),A=b.add(_).neg();return{k1:M,k2:A}};Er.prototype.pointFromX=function(e,t){e=new dt(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=i.redSqrt();if(n.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var s=n.fromRed().isOdd();return(t&&!s||!t&&s)&&(n=n.redNeg()),this.point(e,n)};Er.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,i=e.y,n=this.a.redMul(t),s=t.redSqr().redMul(t).redIAdd(n).redIAdd(this.b);return i.redSqr().redISub(s).cmpn(0)===0};Er.prototype._endoWnafMulAdd=function(e,t,i){for(var n=this._endoWnafT1,s=this._endoWnafT2,h=0;h<e.length;h++){var u=this._endoSplit(t[h]),g=e[h],b=g._getBeta();u.k1.negative&&(u.k1.ineg(),g=g.neg(!0)),u.k2.negative&&(u.k2.ineg(),b=b.neg(!0)),n[h*2]=g,n[h*2+1]=b,s[h*2]=u.k1,s[h*2+1]=u.k2}for(var _=this._wnafMulAdd(1,n,s,h*2,i),M=0;M<h*2;M++)n[M]=null,s[M]=null;return _};function It(r,e,t,i){mn.BasePoint.call(this,r,"affine"),e===null&&t===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new dt(e,16),this.y=new dt(t,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}jo(It,mn.BasePoint);Er.prototype.point=function(e,t,i){return new It(this,e,t,i)};Er.prototype.pointFromJSON=function(e,t){return It.fromJSON(this,e,t)};It.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,n=function(s){return i.point(s.x.redMul(i.endo.beta),s.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return t}};It.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};It.fromJSON=function(e,t,i){typeof t=="string"&&(t=JSON.parse(t));var n=e.point(t[0],t[1],i);if(!t[2])return n;function s(u){return e.point(u[0],u[1],i)}var h=t[2];return n.precomputed={beta:null,doubles:h.doubles&&{step:h.doubles.step,points:[n].concat(h.doubles.points.map(s))},naf:h.naf&&{wnd:h.naf.wnd,points:[n].concat(h.naf.points.map(s))}},n};It.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};It.prototype.isInfinity=function(){return this.inf};It.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var t=this.y.redSub(e.y);t.cmpn(0)!==0&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var i=t.redSqr().redISub(this.x).redISub(e.x),n=t.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)};It.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var t=this.curve.a,i=this.x.redSqr(),n=e.redInvm(),s=i.redAdd(i).redIAdd(i).redIAdd(t).redMul(n),h=s.redSqr().redISub(this.x.redAdd(this.x)),u=s.redMul(this.x.redSub(h)).redISub(this.y);return this.curve.point(h,u)};It.prototype.getX=function(){return this.x.fromRed()};It.prototype.getY=function(){return this.y.fromRed()};It.prototype.mul=function(e){return e=new dt(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};It.prototype.mulAdd=function(e,t,i){var n=[this,t],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s):this.curve._wnafMulAdd(1,n,s,2)};It.prototype.jmulAdd=function(e,t,i){var n=[this,t],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s,!0):this.curve._wnafMulAdd(1,n,s,2,!0)};It.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};It.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,n=function(s){return s.neg()};t.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(n)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(n)}}}return t};It.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function Ot(r,e,t,i){mn.BasePoint.call(this,r,"jacobian"),e===null&&t===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new dt(0)):(this.x=new dt(e,16),this.y=new dt(t,16),this.z=new dt(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}jo(Ot,mn.BasePoint);Er.prototype.jpoint=function(e,t,i){return new Ot(this,e,t,i)};Ot.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),i=this.x.redMul(t),n=this.y.redMul(t).redMul(e);return this.curve.point(i,n)};Ot.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};Ot.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),i=this.z.redSqr(),n=this.x.redMul(t),s=e.x.redMul(i),h=this.y.redMul(t.redMul(e.z)),u=e.y.redMul(i.redMul(this.z)),g=n.redSub(s),b=h.redSub(u);if(g.cmpn(0)===0)return b.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var _=g.redSqr(),M=_.redMul(g),A=n.redMul(_),I=b.redSqr().redIAdd(M).redISub(A).redISub(A),D=b.redMul(A.redISub(I)).redISub(h.redMul(M)),N=this.z.redMul(e.z).redMul(g);return this.curve.jpoint(I,D,N)};Ot.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),i=this.x,n=e.x.redMul(t),s=this.y,h=e.y.redMul(t).redMul(this.z),u=i.redSub(n),g=s.redSub(h);if(u.cmpn(0)===0)return g.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var b=u.redSqr(),_=b.redMul(u),M=i.redMul(b),A=g.redSqr().redIAdd(_).redISub(M).redISub(M),I=g.redMul(M.redISub(A)).redISub(s.redMul(_)),D=this.z.redMul(u);return this.curve.jpoint(A,I,D)};Ot.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var i=this;for(t=0;t<e;t++)i=i.dbl();return i}var n=this.curve.a,s=this.curve.tinv,h=this.x,u=this.y,g=this.z,b=g.redSqr().redSqr(),_=u.redAdd(u);for(t=0;t<e;t++){var M=h.redSqr(),A=_.redSqr(),I=A.redSqr(),D=M.redAdd(M).redIAdd(M).redIAdd(n.redMul(b)),N=h.redMul(A),U=D.redSqr().redISub(N.redAdd(N)),k=N.redISub(U),T=D.redMul(k);T=T.redIAdd(T).redISub(I);var K=_.redMul(g);t+1<e&&(b=b.redMul(I)),h=U,g=K,_=T}return this.curve.jpoint(h,_.redMul(s),g)};Ot.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};Ot.prototype._zeroDbl=function(){var e,t,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),h=s.redSqr(),u=this.x.redAdd(s).redSqr().redISub(n).redISub(h);u=u.redIAdd(u);var g=n.redAdd(n).redIAdd(n),b=g.redSqr().redISub(u).redISub(u),_=h.redIAdd(h);_=_.redIAdd(_),_=_.redIAdd(_),e=b,t=g.redMul(u.redISub(b)).redISub(_),i=this.y.redAdd(this.y)}else{var M=this.x.redSqr(),A=this.y.redSqr(),I=A.redSqr(),D=this.x.redAdd(A).redSqr().redISub(M).redISub(I);D=D.redIAdd(D);var N=M.redAdd(M).redIAdd(M),U=N.redSqr(),k=I.redIAdd(I);k=k.redIAdd(k),k=k.redIAdd(k),e=U.redISub(D).redISub(D),t=N.redMul(D.redISub(e)).redISub(k),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(e,t,i)};Ot.prototype._threeDbl=function(){var e,t,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),h=s.redSqr(),u=this.x.redAdd(s).redSqr().redISub(n).redISub(h);u=u.redIAdd(u);var g=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),b=g.redSqr().redISub(u).redISub(u);e=b;var _=h.redIAdd(h);_=_.redIAdd(_),_=_.redIAdd(_),t=g.redMul(u.redISub(b)).redISub(_),i=this.y.redAdd(this.y)}else{var M=this.z.redSqr(),A=this.y.redSqr(),I=this.x.redMul(A),D=this.x.redSub(M).redMul(this.x.redAdd(M));D=D.redAdd(D).redIAdd(D);var N=I.redIAdd(I);N=N.redIAdd(N);var U=N.redAdd(N);e=D.redSqr().redISub(U),i=this.y.redAdd(this.z).redSqr().redISub(A).redISub(M);var k=A.redSqr();k=k.redIAdd(k),k=k.redIAdd(k),k=k.redIAdd(k),t=D.redMul(N.redISub(e)).redISub(k)}return this.curve.jpoint(e,t,i)};Ot.prototype._dbl=function(){var e=this.curve.a,t=this.x,i=this.y,n=this.z,s=n.redSqr().redSqr(),h=t.redSqr(),u=i.redSqr(),g=h.redAdd(h).redIAdd(h).redIAdd(e.redMul(s)),b=t.redAdd(t);b=b.redIAdd(b);var _=b.redMul(u),M=g.redSqr().redISub(_.redAdd(_)),A=_.redISub(M),I=u.redSqr();I=I.redIAdd(I),I=I.redIAdd(I),I=I.redIAdd(I);var D=g.redMul(A).redISub(I),N=i.redAdd(i).redMul(n);return this.curve.jpoint(M,D,N)};Ot.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr(),n=t.redSqr(),s=e.redAdd(e).redIAdd(e),h=s.redSqr(),u=this.x.redAdd(t).redSqr().redISub(e).redISub(n);u=u.redIAdd(u),u=u.redAdd(u).redIAdd(u),u=u.redISub(h);var g=u.redSqr(),b=n.redIAdd(n);b=b.redIAdd(b),b=b.redIAdd(b),b=b.redIAdd(b);var _=s.redIAdd(u).redSqr().redISub(h).redISub(g).redISub(b),M=t.redMul(_);M=M.redIAdd(M),M=M.redIAdd(M);var A=this.x.redMul(g).redISub(M);A=A.redIAdd(A),A=A.redIAdd(A);var I=this.y.redMul(_.redMul(b.redISub(_)).redISub(u.redMul(g)));I=I.redIAdd(I),I=I.redIAdd(I),I=I.redIAdd(I);var D=this.z.redAdd(u).redSqr().redISub(i).redISub(g);return this.curve.jpoint(A,I,D)};Ot.prototype.mul=function(e,t){return e=new dt(e,t),this.curve._wnafMul(this,e)};Ot.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),i=e.z.redSqr();if(this.x.redMul(i).redISub(e.x.redMul(t)).cmpn(0)!==0)return!1;var n=t.redMul(this.z),s=i.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(n)).cmpn(0)===0};Ot.prototype.eqXToP=function(e){var t=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(t);if(this.x.cmp(i)===0)return!0;for(var n=e.clone(),s=this.curve.redN.redMul(t);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(s),this.x.cmp(i)===0)return!0}};Ot.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};Ot.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var Qi=oi,Su=ra,fa=oa,Ub=lr;function yn(r){fa.call(this,"mont",r),this.a=new Qi(r.a,16).toRed(this.red),this.b=new Qi(r.b,16).toRed(this.red),this.i4=new Qi(4).toRed(this.red).redInvm(),this.two=new Qi(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}Su(yn,fa);var zb=yn;yn.prototype.validate=function(e){var t=e.normalize().x,i=t.redSqr(),n=i.redMul(t).redAdd(i.redMul(this.a)).redAdd(t),s=n.redSqrt();return s.redSqr().cmp(n)===0};function Et(r,e,t){fa.BasePoint.call(this,r,"projective"),e===null&&t===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new Qi(e,16),this.z=new Qi(t,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}Su(Et,fa.BasePoint);yn.prototype.decodePoint=function(e,t){return this.point(Ub.toArray(e,t),1)};yn.prototype.point=function(e,t){return new Et(this,e,t)};yn.prototype.pointFromJSON=function(e){return Et.fromJSON(this,e)};Et.prototype.precompute=function(){};Et.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};Et.fromJSON=function(e,t){return new Et(e,t[0],t[1]||e.one)};Et.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Et.prototype.isInfinity=function(){return this.z.cmpn(0)===0};Et.prototype.dbl=function(){var e=this.x.redAdd(this.z),t=e.redSqr(),i=this.x.redSub(this.z),n=i.redSqr(),s=t.redSub(n),h=t.redMul(n),u=s.redMul(n.redAdd(this.curve.a24.redMul(s)));return this.curve.point(h,u)};Et.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};Et.prototype.diffAdd=function(e,t){var i=this.x.redAdd(this.z),n=this.x.redSub(this.z),s=e.x.redAdd(e.z),h=e.x.redSub(e.z),u=h.redMul(i),g=s.redMul(n),b=t.z.redMul(u.redAdd(g).redSqr()),_=t.x.redMul(u.redISub(g).redSqr());return this.curve.point(b,_)};Et.prototype.mul=function(e){for(var t=e.clone(),i=this,n=this.curve.point(null,null),s=this,h=[];t.cmpn(0)!==0;t.iushrn(1))h.push(t.andln(1));for(var u=h.length-1;u>=0;u--)h[u]===0?(i=i.diffAdd(n,s),n=n.dbl()):(n=i.diffAdd(n,s),i=i.dbl());return n};Et.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};Et.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};Et.prototype.eq=function(e){return this.getX().cmp(e.getX())===0};Et.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};Et.prototype.getX=function(){return this.normalize(),this.x.fromRed()};var Bb=lr,ri=oi,Iu=ra,ha=oa,kb=Bb.assert;function Jr(r){this.twisted=(r.a|0)!==1,this.mOneA=this.twisted&&(r.a|0)===-1,this.extended=this.mOneA,ha.call(this,"edwards",r),this.a=new ri(r.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new ri(r.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new ri(r.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),kb(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(r.c|0)===1}Iu(Jr,ha);var Kb=Jr;Jr.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)};Jr.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)};Jr.prototype.jpoint=function(e,t,i,n){return this.point(e,t,i,n)};Jr.prototype.pointFromX=function(e,t){e=new ri(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=this.c2.redSub(this.a.redMul(i)),s=this.one.redSub(this.c2.redMul(this.d).redMul(i)),h=n.redMul(s.redInvm()),u=h.redSqrt();if(u.redSqr().redSub(h).cmp(this.zero)!==0)throw new Error("invalid point");var g=u.fromRed().isOdd();return(t&&!g||!t&&g)&&(u=u.redNeg()),this.point(e,u)};Jr.prototype.pointFromY=function(e,t){e=new ri(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=i.redSub(this.c2),s=i.redMul(this.d).redMul(this.c2).redSub(this.a),h=n.redMul(s.redInvm());if(h.cmp(this.zero)===0){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var u=h.redSqrt();if(u.redSqr().redSub(h).cmp(this.zero)!==0)throw new Error("invalid point");return u.fromRed().isOdd()!==t&&(u=u.redNeg()),this.point(u,e)};Jr.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),i=e.y.redSqr(),n=t.redMul(this.a).redAdd(i),s=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(i)));return n.cmp(s)===0};function ot(r,e,t,i,n){ha.BasePoint.call(this,r,"projective"),e===null&&t===null&&i===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new ri(e,16),this.y=new ri(t,16),this.z=i?new ri(i,16):this.curve.one,this.t=n&&new ri(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}Iu(ot,ha.BasePoint);Jr.prototype.pointFromJSON=function(e){return ot.fromJSON(this,e)};Jr.prototype.point=function(e,t,i,n){return new ot(this,e,t,i,n)};ot.fromJSON=function(e,t){return new ot(e,t[0],t[1],t[2])};ot.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};ot.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};ot.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var n=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),h=n.redAdd(t),u=h.redSub(i),g=n.redSub(t),b=s.redMul(u),_=h.redMul(g),M=s.redMul(g),A=u.redMul(h);return this.curve.point(b,_,A,M)};ot.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),t=this.x.redSqr(),i=this.y.redSqr(),n,s,h,u,g,b;if(this.curve.twisted){u=this.curve._mulA(t);var _=u.redAdd(i);this.zOne?(n=e.redSub(t).redSub(i).redMul(_.redSub(this.curve.two)),s=_.redMul(u.redSub(i)),h=_.redSqr().redSub(_).redSub(_)):(g=this.z.redSqr(),b=_.redSub(g).redISub(g),n=e.redSub(t).redISub(i).redMul(b),s=_.redMul(u.redSub(i)),h=_.redMul(b))}else u=t.redAdd(i),g=this.curve._mulC(this.z).redSqr(),b=u.redSub(g).redSub(g),n=this.curve._mulC(e.redISub(u)).redMul(b),s=this.curve._mulC(u).redMul(t.redISub(i)),h=u.redMul(b);return this.curve.point(n,s,h)};ot.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};ot.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),i=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),n=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),h=i.redSub(t),u=s.redSub(n),g=s.redAdd(n),b=i.redAdd(t),_=h.redMul(u),M=g.redMul(b),A=h.redMul(b),I=u.redMul(g);return this.curve.point(_,M,I,A)};ot.prototype._projAdd=function(e){var t=this.z.redMul(e.z),i=t.redSqr(),n=this.x.redMul(e.x),s=this.y.redMul(e.y),h=this.curve.d.redMul(n).redMul(s),u=i.redSub(h),g=i.redAdd(h),b=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(n).redISub(s),_=t.redMul(u).redMul(b),M,A;return this.curve.twisted?(M=t.redMul(g).redMul(s.redSub(this.curve._mulA(n))),A=u.redMul(g)):(M=t.redMul(g).redMul(s.redSub(n)),A=this.curve._mulC(u).redMul(g)),this.curve.point(_,M,A)};ot.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)};ot.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)};ot.prototype.mulAdd=function(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!1)};ot.prototype.jmulAdd=function(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!0)};ot.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this};ot.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};ot.prototype.getX=function(){return this.normalize(),this.x.fromRed()};ot.prototype.getY=function(){return this.normalize(),this.y.fromRed()};ot.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0};ot.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(t)===0)return!0;for(var i=e.clone(),n=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(n),this.x.cmp(t)===0)return!0}};ot.prototype.toP=ot.prototype.normalize;ot.prototype.mixedAdd=ot.prototype.add;(function(r){var e=r;e.base=oa,e.short=qb,e.mont=zb,e.edwards=Kb})(Ko);var ca={},Ua,fh;function jb(){return fh||(fh=1,Ua={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}),Ua}(function(r){var e=r,t=Xn,i=Ko,n=lr,s=n.assert;function h(b){b.type==="short"?this.curve=new i.short(b):b.type==="edwards"?this.curve=new i.edwards(b):this.curve=new i.mont(b),this.g=this.curve.g,this.n=this.curve.n,this.hash=b.hash,s(this.g.validate(),"Invalid curve"),s(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}e.PresetCurve=h;function u(b,_){Object.defineProperty(e,b,{configurable:!0,enumerable:!0,get:function(){var M=new h(_);return Object.defineProperty(e,b,{configurable:!0,enumerable:!0,value:M}),M}})}u("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:t.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),u("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:t.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),u("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:t.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),u("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:t.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),u("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:t.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),u("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:t.sha256,gRed:!1,g:["9"]}),u("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:t.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var g;try{g=jb()}catch{g=void 0}u("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:t.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",g]})})(ca);var Hb=Xn,Ci=Bo,Au=ki;function gi(r){if(!(this instanceof gi))return new gi(r);this.hash=r.hash,this.predResist=!!r.predResist,this.outLen=this.hash.outSize,this.minEntropy=r.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=Ci.toArray(r.entropy,r.entropyEnc||"hex"),t=Ci.toArray(r.nonce,r.nonceEnc||"hex"),i=Ci.toArray(r.pers,r.persEnc||"hex");Au(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,t,i)}var Vb=gi;gi.prototype._init=function(e,t,i){var n=e.concat(t).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656};gi.prototype._hmac=function(){return new Hb.hmac(this.hash,this.K)};gi.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())};gi.prototype.reseed=function(e,t,i,n){typeof t!="string"&&(n=i,i=t,t=null),e=Ci.toArray(e,t),i=Ci.toArray(i,n),Au(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1};gi.prototype.generate=function(e,t,i,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof t!="string"&&(n=i,i=t,t=null),i&&(i=Ci.toArray(i,n||"hex"),this._update(i));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var h=s.slice(0,e);return this._update(i),this._reseed++,Ci.encode(h,t)};var Gb=oi,Wb=lr,lo=Wb.assert;function $t(r,e){this.ec=r,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var Jb=$t;$t.fromPublic=function(e,t,i){return t instanceof $t?t:new $t(e,{pub:t,pubEnc:i})};$t.fromPrivate=function(e,t,i){return t instanceof $t?t:new $t(e,{priv:t,privEnc:i})};$t.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};$t.prototype.getPublic=function(e,t){return typeof e=="string"&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub};$t.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};$t.prototype._importPrivate=function(e,t){this.priv=new Gb(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)};$t.prototype._importPublic=function(e,t){if(e.x||e.y){this.ec.curve.type==="mont"?lo(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&lo(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,t)};$t.prototype.derive=function(e){return e.validate()||lo(e.validate(),"public point not validated"),e.mul(this.priv).getX()};$t.prototype.sign=function(e,t,i){return this.ec.sign(e,this,t,i)};$t.prototype.verify=function(e,t,i){return this.ec.verify(e,t,this,void 0,i)};$t.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var zs=oi,Ho=lr,Yb=Ho.assert;function ua(r,e){if(r instanceof ua)return r;this._importDER(r,e)||(Yb(r.r&&r.s,"Signature without r or s"),this.r=new zs(r.r,16),this.s=new zs(r.s,16),r.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=r.recoveryParam)}var Xb=ua;function Zb(){this.place=0}function za(r,e){var t=r[e.place++];if(!(t&128))return t;var i=t&15;if(i===0||i>4||r[e.place]===0)return!1;for(var n=0,s=0,h=e.place;s<i;s++,h++)n<<=8,n|=r[h],n>>>=0;return n<=127?!1:(e.place=h,n)}function hh(r){for(var e=0,t=r.length-1;!r[e]&&!(r[e+1]&128)&&e<t;)e++;return e===0?r:r.slice(e)}ua.prototype._importDER=function(e,t){e=Ho.toArray(e,t);var i=new Zb;if(e[i.place++]!==48)return!1;var n=za(e,i);if(n===!1||n+i.place!==e.length||e[i.place++]!==2)return!1;var s=za(e,i);if(s===!1||e[i.place]&128)return!1;var h=e.slice(i.place,s+i.place);if(i.place+=s,e[i.place++]!==2)return!1;var u=za(e,i);if(u===!1||e.length!==u+i.place||e[i.place]&128)return!1;var g=e.slice(i.place,u+i.place);if(h[0]===0)if(h[1]&128)h=h.slice(1);else return!1;if(g[0]===0)if(g[1]&128)g=g.slice(1);else return!1;return this.r=new zs(h),this.s=new zs(g),this.recoveryParam=null,!0};function Ba(r,e){if(e<128){r.push(e);return}var t=1+(Math.log(e)/Math.LN2>>>3);for(r.push(t|128);--t;)r.push(e>>>(t<<3)&255);r.push(e)}ua.prototype.toDER=function(e){var t=this.r.toArray(),i=this.s.toArray();for(t[0]&128&&(t=[0].concat(t)),i[0]&128&&(i=[0].concat(i)),t=hh(t),i=hh(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var n=[2];Ba(n,t.length),n=n.concat(t),n.push(2),Ba(n,i.length);var s=n.concat(i),h=[48];return Ba(h,s.length),h=h.concat(s),Ho.encode(h,e)};var ii=oi,Du=Vb,Qb=lr,ka=ca,em=Eu,Pu=Qb.assert,Vo=Jb,la=Xb;function wr(r){if(!(this instanceof wr))return new wr(r);typeof r=="string"&&(Pu(Object.prototype.hasOwnProperty.call(ka,r),"Unknown curve "+r),r=ka[r]),r instanceof ka.PresetCurve&&(r={curve:r}),this.curve=r.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=r.curve.g,this.g.precompute(r.curve.n.bitLength()+1),this.hash=r.hash||r.curve.hash}var tm=wr;wr.prototype.keyPair=function(e){return new Vo(this,e)};wr.prototype.keyFromPrivate=function(e,t){return Vo.fromPrivate(this,e,t)};wr.prototype.keyFromPublic=function(e,t){return Vo.fromPublic(this,e,t)};wr.prototype.genKeyPair=function(e){e||(e={});for(var t=new Du({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||em(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),n=this.n.sub(new ii(2));;){var s=new ii(t.generate(i));if(!(s.cmp(n)>0))return s.iaddn(1),this.keyFromPrivate(s)}};wr.prototype._truncateToN=function(e,t,i){var n;if(ii.isBN(e)||typeof e=="number")e=new ii(e,16),n=e.byteLength();else if(typeof e=="object")n=e.length,e=new ii(e,16);else{var s=e.toString();n=s.length+1>>>1,e=new ii(s,16)}typeof i!="number"&&(i=n*8);var h=i-this.n.bitLength();return h>0&&(e=e.ushrn(h)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e};wr.prototype.sign=function(e,t,i,n){typeof i=="object"&&(n=i,i=null),n||(n={}),t=this.keyFromPrivate(t,i),e=this._truncateToN(e,!1,n.msgBitLength);for(var s=this.n.byteLength(),h=t.getPrivate().toArray("be",s),u=e.toArray("be",s),g=new Du({hash:this.hash,entropy:h,nonce:u,pers:n.pers,persEnc:n.persEnc||"utf8"}),b=this.n.sub(new ii(1)),_=0;;_++){var M=n.k?n.k(_):new ii(g.generate(this.n.byteLength()));if(M=this._truncateToN(M,!0),!(M.cmpn(1)<=0||M.cmp(b)>=0)){var A=this.g.mul(M);if(!A.isInfinity()){var I=A.getX(),D=I.umod(this.n);if(D.cmpn(0)!==0){var N=M.invm(this.n).mul(D.mul(t.getPrivate()).iadd(e));if(N=N.umod(this.n),N.cmpn(0)!==0){var U=(A.getY().isOdd()?1:0)|(I.cmp(D)!==0?2:0);return n.canonical&&N.cmp(this.nh)>0&&(N=this.n.sub(N),U^=1),new la({r:D,s:N,recoveryParam:U})}}}}}};wr.prototype.verify=function(e,t,i,n,s){s||(s={}),e=this._truncateToN(e,!1,s.msgBitLength),i=this.keyFromPublic(i,n),t=new la(t,"hex");var h=t.r,u=t.s;if(h.cmpn(1)<0||h.cmp(this.n)>=0||u.cmpn(1)<0||u.cmp(this.n)>=0)return!1;var g=u.invm(this.n),b=g.mul(e).umod(this.n),_=g.mul(h).umod(this.n),M;return this.curve._maxwellTrick?(M=this.g.jmulAdd(b,i.getPublic(),_),M.isInfinity()?!1:M.eqXToP(h)):(M=this.g.mulAdd(b,i.getPublic(),_),M.isInfinity()?!1:M.getX().umod(this.n).cmp(h)===0)};wr.prototype.recoverPubKey=function(r,e,t,i){Pu((3&t)===t,"The recovery param is more than two bits"),e=new la(e,i);var n=this.n,s=new ii(r),h=e.r,u=e.s,g=t&1,b=t>>1;if(h.cmp(this.curve.p.umod(this.curve.n))>=0&&b)throw new Error("Unable to find sencond key candinate");b?h=this.curve.pointFromX(h.add(this.curve.n),g):h=this.curve.pointFromX(h,g);var _=e.r.invm(n),M=n.sub(s).mul(_).umod(n),A=u.mul(_).umod(n);return this.g.mulAdd(M,h,A)};wr.prototype.getKeyRecoveryParam=function(r,e,t,i){if(e=new la(e,i),e.recoveryParam!==null)return e.recoveryParam;for(var n=0;n<4;n++){var s;try{s=this.recoverPubKey(r,e,n)}catch{continue}if(s.eq(t))return n}throw new Error("Unable to find valid recovery factor")};var ts=lr,Ou=ts.assert,ch=ts.parseBytes,wn=ts.cachedProperty;function Mt(r,e){this.eddsa=r,this._secret=ch(e.secret),r.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=ch(e.pub)}Mt.fromPublic=function(e,t){return t instanceof Mt?t:new Mt(e,{pub:t})};Mt.fromSecret=function(e,t){return t instanceof Mt?t:new Mt(e,{secret:t})};Mt.prototype.secret=function(){return this._secret};wn(Mt,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});wn(Mt,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});wn(Mt,"privBytes",function(){var e=this.eddsa,t=this.hash(),i=e.encodingLength-1,n=t.slice(0,e.encodingLength);return n[0]&=248,n[i]&=127,n[i]|=64,n});wn(Mt,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});wn(Mt,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});wn(Mt,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});Mt.prototype.sign=function(e){return Ou(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)};Mt.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)};Mt.prototype.getSecret=function(e){return Ou(this._secret,"KeyPair is public only"),ts.encode(this.secret(),e)};Mt.prototype.getPublic=function(e){return ts.encode(this.pubBytes(),e)};var rm=Mt,im=oi,da=lr,uh=da.assert,pa=da.cachedProperty,nm=da.parseBytes;function ji(r,e){this.eddsa=r,typeof e!="object"&&(e=nm(e)),Array.isArray(e)&&(uh(e.length===r.encodingLength*2,"Signature has invalid size"),e={R:e.slice(0,r.encodingLength),S:e.slice(r.encodingLength)}),uh(e.R&&e.S,"Signature without R or S"),r.isPoint(e.R)&&(this._R=e.R),e.S instanceof im&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}pa(ji,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});pa(ji,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});pa(ji,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});pa(ji,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});ji.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};ji.prototype.toHex=function(){return da.encode(this.toBytes(),"hex").toUpperCase()};var sm=ji,am=Xn,om=ca,hn=lr,fm=hn.assert,Nu=hn.parseBytes,Ru=rm,lh=sm;function Ht(r){if(fm(r==="ed25519","only tested with ed25519 so far"),!(this instanceof Ht))return new Ht(r);r=om[r].curve,this.curve=r,this.g=r.g,this.g.precompute(r.n.bitLength()+1),this.pointClass=r.point().constructor,this.encodingLength=Math.ceil(r.n.bitLength()/8),this.hash=am.sha512}var hm=Ht;Ht.prototype.sign=function(e,t){e=Nu(e);var i=this.keyFromSecret(t),n=this.hashInt(i.messagePrefix(),e),s=this.g.mul(n),h=this.encodePoint(s),u=this.hashInt(h,i.pubBytes(),e).mul(i.priv()),g=n.add(u).umod(this.curve.n);return this.makeSignature({R:s,S:g,Rencoded:h})};Ht.prototype.verify=function(e,t,i){if(e=Nu(e),t=this.makeSignature(t),t.S().gte(t.eddsa.curve.n)||t.S().isNeg())return!1;var n=this.keyFromPublic(i),s=this.hashInt(t.Rencoded(),n.pubBytes(),e),h=this.g.mul(t.S()),u=t.R().add(n.pub().mul(s));return u.eq(h)};Ht.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return hn.intFromLE(e.digest()).umod(this.curve.n)};Ht.prototype.keyFromPublic=function(e){return Ru.fromPublic(this,e)};Ht.prototype.keyFromSecret=function(e){return Ru.fromSecret(this,e)};Ht.prototype.makeSignature=function(e){return e instanceof lh?e:new lh(this,e)};Ht.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t};Ht.prototype.decodePoint=function(e){e=hn.parseBytes(e);var t=e.length-1,i=e.slice(0,t).concat(e[t]&-129),n=(e[t]&128)!==0,s=hn.intFromLE(i);return this.curve.pointFromY(s,n)};Ht.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)};Ht.prototype.decodeInt=function(e){return hn.intFromLE(e)};Ht.prototype.isPoint=function(e){return e instanceof this.pointClass};(function(r){var e=r;e.version=Cb.version,e.utils=lr,e.rand=Eu,e.curve=Ko,e.curves=ca,e.ec=tm,e.eddsa=hm})(Mu);const cm={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var um={};const lm=":";function Es(r){const[e,t]=r.split(lm);return{namespace:e,reference:t}}function Tu(r,e){return r.includes(":")?[r]:e.chains||[]}var dm=Object.defineProperty,dh=Object.getOwnPropertySymbols,pm=Object.prototype.hasOwnProperty,vm=Object.prototype.propertyIsEnumerable,ph=(r,e,t)=>e in r?dm(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,vh=(r,e)=>{for(var t in e||(e={}))pm.call(e,t)&&ph(r,t,e[t]);if(dh)for(var t of dh(e))vm.call(e,t)&&ph(r,t,e[t]);return r};const gm="ReactNative",hr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},bm="js";function Bs(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function _n(){return!Yn()&&!!Ao()&&navigator.product===gm}function rs(){return!Bs()&&!!Ao()&&!!Yn()}function is(){return _n()?hr.reactNative:Bs()?hr.node:rs()?hr.browser:hr.unknown}function mm(){var r;try{return _n()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(r=global.Application)==null?void 0:r.applicationId:void 0}catch{return}}function ym(r,e){let t=Kn.parse(r);return t=vh(vh({},t),e),r=Kn.stringify(t),r}function Cu(){return Kc()||{name:"",description:"",url:"",icons:[""]}}function wm(){if(is()===hr.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:i}=global.Platform;return[t,i].join("-")}const r=$1();if(r===null)return"unknown";const e=r.os?r.os.replace(" ","").toLowerCase():"unknown";return r.type==="browser"?[e,r.name,r.version].join("-"):[e,r.version].join("-")}function _m(){var r;const e=is();return e===hr.browser?[e,((r=kc())==null?void 0:r.host)||"unknown"].join(":"):e}function Lu(r,e,t){const i=wm(),n=_m();return[[r,e].join("-"),[bm,t].join("-"),i,n].join("/")}function xm({protocol:r,version:e,relayUrl:t,sdkVersion:i,auth:n,projectId:s,useOnCloseEvent:h,bundleId:u}){const g=t.split("?"),b=Lu(r,e,i),_={auth:n,ua:b,projectId:s,useOnCloseEvent:h||void 0,origin:u||void 0},M=ym(g[1]||"",_);return g[0]+"?"+M}function Ti(r,e){return r.filter(t=>e.includes(t)).length===r.length}function $u(r){return Object.fromEntries(r.entries())}function Fu(r){return new Map(Object.entries(r))}function Di(r=be.FIVE_MINUTES,e){const t=be.toMiliseconds(r||be.FIVE_MINUTES);let i,n,s;return{resolve:h=>{s&&i&&(clearTimeout(s),i(h))},reject:h=>{s&&n&&(clearTimeout(s),n(h))},done:()=>new Promise((h,u)=>{s=setTimeout(()=>{u(new Error(e))},t),i=h,n=u})}}function nn(r,e,t){return new Promise(async(i,n)=>{const s=setTimeout(()=>n(new Error(t)),e);try{const h=await r;i(h)}catch(h){n(h)}clearTimeout(s)})}function qu(r,e){if(typeof e=="string"&&e.startsWith(`${r}:`))return e;if(r.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(r.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${r}`)}function Mm(r){return qu("topic",r)}function Em(r){return qu("id",r)}function Uu(r){const[e,t]=r.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")i.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))i.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return i}function yt(r,e){return be.fromMiliseconds(Date.now()+be.toMiliseconds(r))}function li(r){return Date.now()>=be.toMiliseconds(r)}function Qe(r,e){return`${r}${e?`:${e}`:""}`}function Sm(r=[],e=[]){return[...new Set([...r,...e])]}async function Im({id:r,topic:e,wcDeepLink:t}){var i;try{if(!t)return;const n=typeof t=="string"?JSON.parse(t):t,s=n==null?void 0:n.href;if(typeof s!="string")return;const h=Am(s,r,e),u=is();if(u===hr.browser){if(!((i=Yn())!=null&&i.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}h.startsWith("https://")||h.startsWith("http://")?window.open(h,"_blank","noreferrer noopener"):window.open(h,Pm()?"_blank":"_self","noreferrer noopener")}else u===hr.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(h)}catch(n){console.error(n)}}function Am(r,e,t){const i=`requestId=${e}&sessionTopic=${t}`;r.endsWith("/")&&(r=r.slice(0,-1));let n=`${r}`;if(r.startsWith("https://t.me")){const s=r.includes("?")?"&startapp=":"?startapp=";n=`${n}${s}${Om(i,!0)}`}else n=`${n}/wc?${i}`;return n}async function Dm(r,e){let t="";try{if(rs()&&(t=localStorage.getItem(e),t))return t;t=await r.getItem(e)}catch(i){console.error(i)}return t}function gh(r,e){if(!r.includes(e))return null;const t=r.split(/([&,?,=])/),i=t.indexOf(e);return t[i+2]}function bh(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)})}function Go(){return typeof process<"u"&&um.IS_VITEST==="true"}function Pm(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function Om(r,e=!1){const t=Buffer.from(r).toString("base64");return e?t.replace(/[=]/g,""):t}function zu(r){return Buffer.from(r,"base64").toString("utf-8")}const Nm="https://rpc.walletconnect.org/v1";async function Rm(r,e,t,i,n,s){switch(t.t){case"eip191":return Tm(r,e,t.s);case"eip1271":return await Cm(r,e,t.s,i,n,s);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${t.t}`)}}function Tm(r,e,t){return ab(Vc(e),t).toLowerCase()===r.toLowerCase()}async function Cm(r,e,t,i,n,s){const h=Es(i);if(!h.namespace||!h.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${i}`);try{const u="0x1626ba7e",g="0000000000000000000000000000000000000000000000000000000000000040",b="0000000000000000000000000000000000000000000000000000000000000041",_=t.substring(2),M=Vc(e).substring(2),A=u+M+g+b+_,I=await fetch(`${s||Nm}/?chainId=${i}&projectId=${n}`,{method:"POST",body:JSON.stringify({id:Lm(),jsonrpc:"2.0",method:"eth_call",params:[{to:r,data:A},"latest"]})}),{result:D}=await I.json();return D?D.slice(0,u.length).toLowerCase()===u.toLowerCase():!1}catch(u){return console.error("isValidEip1271Signature: ",u),!1}}function Lm(){return Date.now()+Math.floor(Math.random()*1e3)}var $m=Object.defineProperty,Fm=Object.defineProperties,qm=Object.getOwnPropertyDescriptors,mh=Object.getOwnPropertySymbols,Um=Object.prototype.hasOwnProperty,zm=Object.prototype.propertyIsEnumerable,yh=(r,e,t)=>e in r?$m(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Bm=(r,e)=>{for(var t in e||(e={}))Um.call(e,t)&&yh(r,t,e[t]);if(mh)for(var t of mh(e))zm.call(e,t)&&yh(r,t,e[t]);return r},km=(r,e)=>Fm(r,qm(e));const Km="did:pkh:",Wo=r=>r==null?void 0:r.split(":"),jm=r=>{const e=r&&Wo(r);if(e)return r.includes(Km)?e[3]:e[1]},po=r=>{const e=r&&Wo(r);if(e)return e[2]+":"+e[3]},ks=r=>{const e=r&&Wo(r);if(e)return e.pop()};async function wh(r){const{cacao:e,projectId:t}=r,{s:i,p:n}=e,s=Bu(n,n.iss),h=ks(n.iss);return await Rm(h,s,i,po(n.iss),t)}const Bu=(r,e)=>{const t=`${r.domain} wants you to sign in with your Ethereum account:`,i=ks(e);if(!r.aud&&!r.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let n=r.statement||void 0;const s=`URI: ${r.aud||r.uri}`,h=`Version: ${r.version}`,u=`Chain ID: ${jm(e)}`,g=`Nonce: ${r.nonce}`,b=`Issued At: ${r.iat}`,_=r.exp?`Expiration Time: ${r.exp}`:void 0,M=r.nbf?`Not Before: ${r.nbf}`:void 0,A=r.requestId?`Request ID: ${r.requestId}`:void 0,I=r.resources?`Resources:${r.resources.map(N=>`
- ${N}`).join("")}`:void 0,D=Ss(r.resources);if(D){const N=jn(D);n=Qm(n,N)}return[t,i,"",n,"",s,h,u,g,b,_,M,A,I].filter(N=>N!=null).join(`
`)};function Hm(r){return Buffer.from(JSON.stringify(r)).toString("base64")}function Vm(r){return JSON.parse(Buffer.from(r,"base64").toString("utf-8"))}function Fi(r){if(!r)throw new Error("No recap provided, value is undefined");if(!r.att)throw new Error("No `att` property found");const e=Object.keys(r.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(t=>{const i=r.att[t];if(Array.isArray(i))throw new Error(`Resource must be an object: ${t}`);if(typeof i!="object")throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(i).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(i).forEach(n=>{const s=i[n];if(!Array.isArray(s))throw new Error(`Ability limits ${n} must be an array of objects, found: ${s}`);if(!s.length)throw new Error(`Value of ${n} is empty array, must be an array with objects`);s.forEach(h=>{if(typeof h!="object")throw new Error(`Ability limits (${n}) must be an array of objects, found: ${h}`)})})})}function Gm(r,e,t,i={}){return t==null||t.sort((n,s)=>n.localeCompare(s)),{att:{[r]:Wm(e,t,i)}}}function Wm(r,e,t={}){e=e==null?void 0:e.sort((n,s)=>n.localeCompare(s));const i=e.map(n=>({[`${r}/${n}`]:[t]}));return Object.assign({},...i)}function ku(r){return Fi(r),`urn:recap:${Hm(r).replace(/=/g,"")}`}function jn(r){const e=Vm(r.replace("urn:recap:",""));return Fi(e),e}function Jm(r,e,t){const i=Gm(r,e,t);return ku(i)}function Ym(r){return r&&r.includes("urn:recap:")}function Xm(r,e){const t=jn(r),i=jn(e),n=Zm(t,i);return ku(n)}function Zm(r,e){Fi(r),Fi(e);const t=Object.keys(r.att).concat(Object.keys(e.att)).sort((n,s)=>n.localeCompare(s)),i={att:{}};return t.forEach(n=>{var s,h;Object.keys(((s=r.att)==null?void 0:s[n])||{}).concat(Object.keys(((h=e.att)==null?void 0:h[n])||{})).sort((u,g)=>u.localeCompare(g)).forEach(u=>{var g,b;i.att[n]=km(Bm({},i.att[n]),{[u]:((g=r.att[n])==null?void 0:g[u])||((b=e.att[n])==null?void 0:b[u])})})}),i}function Qm(r="",e){Fi(e);const t="I further authorize the stated URI to perform the following actions on my behalf: ";if(r.includes(t))return r;const i=[];let n=0;Object.keys(e.att).forEach(u=>{const g=Object.keys(e.att[u]).map(M=>({ability:M.split("/")[0],action:M.split("/")[1]}));g.sort((M,A)=>M.action.localeCompare(A.action));const b={};g.forEach(M=>{b[M.ability]||(b[M.ability]=[]),b[M.ability].push(M.action)});const _=Object.keys(b).map(M=>(n++,`(${n}) '${M}': '${b[M].join("', '")}' for '${u}'.`));i.push(_.join(", ").replace(".,","."))});const s=i.join(" "),h=`${t}${s}`;return`${r?r+" ":""}${h}`}function _h(r){var e;const t=jn(r);Fi(t);const i=(e=t.att)==null?void 0:e.eip155;return i?Object.keys(i).map(n=>n.split("/")[1]):[]}function xh(r){const e=jn(r);Fi(e);const t=[];return Object.values(e.att).forEach(i=>{Object.values(i).forEach(n=>{var s;(s=n==null?void 0:n[0])!=null&&s.chains&&t.push(n[0].chains)})}),[...new Set(t.flat())]}function Ss(r){if(!r)return;const e=r==null?void 0:r[r.length-1];return Ym(e)?e:void 0}const Ku="base10",qt="base16",pi="base64pad",On="base64url",ns="utf8",ju=0,ni=1,ss=2,ey=0,Mh=1,qn=12,Jo=32;function ty(){const r=Uo.generateKeyPair();return{privateKey:Kt(r.secretKey,qt),publicKey:Kt(r.publicKey,qt)}}function vo(){const r=bi.randomBytes(Jo);return Kt(r,qt)}function ry(r,e){const t=Uo.sharedKey(mr(r,qt),mr(e,qt),!0),i=new yb(Qn.SHA256,t).expand(Jo);return Kt(i,qt)}function Is(r){const e=Qn.hash(mr(r,qt));return Kt(e,qt)}function ti(r){const e=Qn.hash(mr(r,ns));return Kt(e,qt)}function Hu(r){return mr(`${r}`,Ku)}function qi(r){return Number(Kt(r,Ku))}function iy(r){const e=Hu(typeof r.type<"u"?r.type:ju);if(qi(e)===ni&&typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof r.senderPublicKey<"u"?mr(r.senderPublicKey,qt):void 0,i=typeof r.iv<"u"?mr(r.iv,qt):bi.randomBytes(qn),n=new Fo.ChaCha20Poly1305(mr(r.symKey,qt)).seal(i,mr(r.message,ns));return Vu({type:e,sealed:n,iv:i,senderPublicKey:t,encoding:r.encoding})}function ny(r,e){const t=Hu(ss),i=bi.randomBytes(qn),n=mr(r,ns);return Vu({type:t,sealed:n,iv:i,encoding:e})}function sy(r){const e=new Fo.ChaCha20Poly1305(mr(r.symKey,qt)),{sealed:t,iv:i}=Hn({encoded:r.encoded,encoding:r==null?void 0:r.encoding}),n=e.open(i,t);if(n===null)throw new Error("Failed to decrypt");return Kt(n,ns)}function ay(r,e){const{sealed:t}=Hn({encoded:r,encoding:e});return Kt(t,ns)}function Vu(r){const{encoding:e=pi}=r;if(qi(r.type)===ss)return Kt($a([r.type,r.sealed]),e);if(qi(r.type)===ni){if(typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Kt($a([r.type,r.senderPublicKey,r.iv,r.sealed]),e)}return Kt($a([r.type,r.iv,r.sealed]),e)}function Hn(r){const{encoded:e,encoding:t=pi}=r,i=mr(e,t),n=i.slice(ey,Mh),s=Mh;if(qi(n)===ni){const b=s+Jo,_=b+qn,M=i.slice(s,b),A=i.slice(b,_),I=i.slice(_);return{type:n,sealed:I,iv:A,senderPublicKey:M}}if(qi(n)===ss){const b=i.slice(s),_=bi.randomBytes(qn);return{type:n,sealed:b,iv:_}}const h=s+qn,u=i.slice(s,h),g=i.slice(h);return{type:n,sealed:g,iv:u}}function oy(r,e){const t=Hn({encoded:r,encoding:e==null?void 0:e.encoding});return Gu({type:qi(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?Kt(t.senderPublicKey,qt):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function Gu(r){const e=(r==null?void 0:r.type)||ju;if(e===ni){if(typeof(r==null?void 0:r.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(r==null?void 0:r.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:r==null?void 0:r.senderPublicKey,receiverPublicKey:r==null?void 0:r.receiverPublicKey}}function Eh(r){return r.type===ni&&typeof r.senderPublicKey=="string"&&typeof r.receiverPublicKey=="string"}function Sh(r){return r.type===ss}function fy(r){return new Mu.ec("p256").keyFromPublic({x:Buffer.from(r.x,"base64").toString("hex"),y:Buffer.from(r.y,"base64").toString("hex")},"hex")}function hy(r){let e=r.replace(/-/g,"+").replace(/_/g,"/");const t=e.length%4;return t>0&&(e+="=".repeat(4-t)),e}function cy(r){return Buffer.from(hy(r),"base64")}function uy(r,e){const[t,i,n]=r.split("."),s=cy(n);if(s.length!==64)throw new Error("Invalid signature length");const h=s.slice(0,32).toString("hex"),u=s.slice(32,64).toString("hex"),g=`${t}.${i}`,b=new Qn.SHA256().update(Buffer.from(g)).digest(),_=fy(e),M=Buffer.from(b).toString("hex");if(!_.verify(M,{r:h,s:u}))throw new Error("Invalid signature");return no(r).payload}const ly="irn";function go(r){return(r==null?void 0:r.relay)||{protocol:ly}}function Fn(r){const e=cm[r];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${r}`);return e}var dy=Object.defineProperty,py=Object.defineProperties,vy=Object.getOwnPropertyDescriptors,Ih=Object.getOwnPropertySymbols,gy=Object.prototype.hasOwnProperty,by=Object.prototype.propertyIsEnumerable,Ah=(r,e,t)=>e in r?dy(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Dh=(r,e)=>{for(var t in e||(e={}))gy.call(e,t)&&Ah(r,t,e[t]);if(Ih)for(var t of Ih(e))by.call(e,t)&&Ah(r,t,e[t]);return r},my=(r,e)=>py(r,vy(e));function yy(r,e="-"){const t={},i="relay"+e;return Object.keys(r).forEach(n=>{if(n.startsWith(i)){const s=n.replace(i,""),h=r[n];t[s]=h}}),t}function Ph(r){if(!r.includes("wc:")){const g=zu(r);g!=null&&g.includes("wc:")&&(r=g)}r=r.includes("wc://")?r.replace("wc://",""):r,r=r.includes("wc:")?r.replace("wc:",""):r;const e=r.indexOf(":"),t=r.indexOf("?")!==-1?r.indexOf("?"):void 0,i=r.substring(0,e),n=r.substring(e+1,t).split("@"),s=typeof t<"u"?r.substring(t):"",h=Kn.parse(s),u=typeof h.methods=="string"?h.methods.split(","):void 0;return{protocol:i,topic:wy(n[0]),version:parseInt(n[1],10),symKey:h.symKey,relay:yy(h),methods:u,expiryTimestamp:h.expiryTimestamp?parseInt(h.expiryTimestamp,10):void 0}}function wy(r){return r.startsWith("//")?r.substring(2):r}function _y(r,e="-"){const t="relay",i={};return Object.keys(r).forEach(n=>{const s=t+e+n;r[n]&&(i[s]=r[n])}),i}function Oh(r){return`${r.protocol}:${r.topic}@${r.version}?`+Kn.stringify(Dh(my(Dh({symKey:r.symKey},_y(r.relay)),{expiryTimestamp:r.expiryTimestamp}),r.methods?{methods:r.methods.join(",")}:{}))}function bs(r,e,t){return`${r}?wc_ev=${t}&topic=${e}`}function xn(r){const e=[];return r.forEach(t=>{const[i,n]=t.split(":");e.push(`${i}:${n}`)}),e}function xy(r){const e=[];return Object.values(r).forEach(t=>{e.push(...xn(t.accounts))}),e}function My(r,e){const t=[];return Object.values(r).forEach(i=>{xn(i.accounts).includes(e)&&t.push(...i.methods)}),t}function Ey(r,e){const t=[];return Object.values(r).forEach(i=>{xn(i.accounts).includes(e)&&t.push(...i.events)}),t}function Sy(r){const e={};return r==null||r.forEach(t=>{const[i,n]=t.split(":");e[i]||(e[i]={accounts:[],chains:[],events:[]}),e[i].accounts.push(t),e[i].chains.push(`${i}:${n}`)}),e}function Nh(r,e){e=e.map(i=>i.replace("did:pkh:",""));const t=Sy(e);for(const[i,n]of Object.entries(t))n.methods?n.methods=Sm(n.methods,r):n.methods=r,n.events=["chainChanged","accountsChanged"];return t}const Iy={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Ay={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function le(r,e){const{message:t,code:i}=Ay[r];return{message:e?`${t} ${e}`:t,code:i}}function st(r,e){const{message:t,code:i}=Iy[r];return{message:e?`${t} ${e}`:t,code:i}}function as(r,e){return!!Array.isArray(r)}function Ks(r){return Object.getPrototypeOf(r)===Object.prototype&&Object.keys(r).length}function kt(r){return typeof r>"u"}function vt(r,e){return e&&kt(r)?!0:typeof r=="string"&&!!r.trim().length}function Yo(r,e){return typeof r=="number"&&!isNaN(r)}function Dy(r,e){const{requiredNamespaces:t}=e,i=Object.keys(r.namespaces),n=Object.keys(t);let s=!0;return Ti(n,i)?(i.forEach(h=>{const{accounts:u,methods:g,events:b}=r.namespaces[h],_=xn(u),M=t[h];(!Ti(Tu(h,M),_)||!Ti(M.methods,g)||!Ti(M.events,b))&&(s=!1)}),s):!1}function js(r){return vt(r,!1)&&r.includes(":")?r.split(":").length===2:!1}function Py(r){if(vt(r,!1)&&r.includes(":")){const e=r.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&js(t)}}return!1}function Oy(r){function e(t){try{return typeof new URL(t)<"u"}catch{return!1}}try{if(vt(r,!1)){if(e(r))return!0;const t=zu(r);return e(t)}}catch{}return!1}function Ny(r){var e;return(e=r==null?void 0:r.proposer)==null?void 0:e.publicKey}function Ry(r){return r==null?void 0:r.topic}function Ty(r,e){let t=null;return vt(r==null?void 0:r.publicKey,!1)||(t=le("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function Rh(r){let e=!0;return as(r)?r.length&&(e=r.every(t=>vt(t,!1))):e=!1,e}function Cy(r,e,t){let i=null;return as(e)&&e.length?e.forEach(n=>{i||js(n)||(i=st("UNSUPPORTED_CHAINS",`${t}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):js(r)||(i=st("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),i}function Ly(r,e,t){let i=null;return Object.entries(r).forEach(([n,s])=>{if(i)return;const h=Cy(n,Tu(n,s),`${e} ${t}`);h&&(i=h)}),i}function $y(r,e){let t=null;return as(r)?r.forEach(i=>{t||Py(i)||(t=st("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):t=st("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function Fy(r,e){let t=null;return Object.values(r).forEach(i=>{if(t)return;const n=$y(i==null?void 0:i.accounts,`${e} namespace`);n&&(t=n)}),t}function qy(r,e){let t=null;return Rh(r==null?void 0:r.methods)?Rh(r==null?void 0:r.events)||(t=st("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=st("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function Wu(r,e){let t=null;return Object.values(r).forEach(i=>{if(t)return;const n=qy(i,`${e}, namespace`);n&&(t=n)}),t}function Uy(r,e,t){let i=null;if(r&&Ks(r)){const n=Wu(r,e);n&&(i=n);const s=Ly(r,e,t);s&&(i=s)}else i=le("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return i}function Ka(r,e){let t=null;if(r&&Ks(r)){const i=Wu(r,e);i&&(t=i);const n=Fy(r,e);n&&(t=n)}else t=le("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function Ju(r){return vt(r.protocol,!0)}function zy(r,e){let t=!1;return r?r&&as(r)&&r.length&&r.forEach(i=>{t=Ju(i)}):t=!0,t}function By(r){return typeof r=="number"}function Bt(r){return typeof r<"u"&&typeof r!==null}function ky(r){return!(!r||typeof r!="object"||!r.code||!Yo(r.code)||!r.message||!vt(r.message,!1))}function Ky(r){return!(kt(r)||!vt(r.method,!1))}function jy(r){return!(kt(r)||kt(r.result)&&kt(r.error)||!Yo(r.id)||!vt(r.jsonrpc,!1))}function Hy(r){return!(kt(r)||!vt(r.name,!1))}function Th(r,e){return!(!js(e)||!xy(r).includes(e))}function Vy(r,e,t){return vt(t,!1)?My(r,e).includes(t):!1}function Gy(r,e,t){return vt(t,!1)?Ey(r,e).includes(t):!1}function Ch(r,e,t){let i=null;const n=Wy(r),s=Jy(e),h=Object.keys(n),u=Object.keys(s),g=Lh(Object.keys(r)),b=Lh(Object.keys(e)),_=g.filter(M=>!b.includes(M));return _.length&&(i=le("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${_.toString()}
      Received: ${Object.keys(e).toString()}`)),Ti(h,u)||(i=le("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${h.toString()}
      Approved: ${u.toString()}`)),Object.keys(e).forEach(M=>{if(!M.includes(":")||i)return;const A=xn(e[M].accounts);A.includes(M)||(i=le("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${M}
        Required: ${M}
        Approved: ${A.toString()}`))}),h.forEach(M=>{i||(Ti(n[M].methods,s[M].methods)?Ti(n[M].events,s[M].events)||(i=le("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${M}`)):i=le("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${M}`))}),i}function Wy(r){const e={};return Object.keys(r).forEach(t=>{var i;t.includes(":")?e[t]=r[t]:(i=r[t].chains)==null||i.forEach(n=>{e[n]={methods:r[t].methods,events:r[t].events}})}),e}function Lh(r){return[...new Set(r.map(e=>e.includes(":")?e.split(":")[0]:e))]}function Jy(r){const e={};return Object.keys(r).forEach(t=>{if(t.includes(":"))e[t]=r[t];else{const i=xn(r[t].accounts);i==null||i.forEach(n=>{e[n]={accounts:r[t].accounts.filter(s=>s.includes(`${n}:`)),methods:r[t].methods,events:r[t].events}})}}),e}function Yy(r,e){return Yo(r)&&r<=e.max&&r>=e.min}function $h(){const r=is();return new Promise(e=>{switch(r){case hr.browser:e(Xy());break;case hr.reactNative:e(Zy());break;case hr.node:e(Qy());break;default:e(!0)}})}function Xy(){return rs()&&(navigator==null?void 0:navigator.onLine)}async function Zy(){if(_n()&&typeof global<"u"&&global!=null&&global.NetInfo){const r=await(global==null?void 0:global.NetInfo.fetch());return r==null?void 0:r.isConnected}return!0}function Qy(){return!0}function e2(r){switch(is()){case hr.browser:t2(r);break;case hr.reactNative:r2(r);break}}function t2(r){!_n()&&rs()&&(window.addEventListener("online",()=>r(!0)),window.addEventListener("offline",()=>r(!1)))}function r2(r){_n()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>r(e==null?void 0:e.isConnected)))}const ja={};class Nn{static get(e){return ja[e]}static set(e,t){ja[e]=t}static delete(e){delete ja[e]}}class i2{}class n2 extends i2{constructor(){super()}}class s2 extends n2{constructor(e){super()}}const a2="^wss?:";function o2(r){const e=r.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function f2(r,e){const t=o2(r);return typeof t>"u"?!1:new RegExp(e).test(t)}function Fh(r){return f2(r,a2)}function h2(r){return new RegExp("wss?://localhost(:d{2,5})?").test(r)}function Yu(r){return typeof r=="object"&&"id"in r&&"jsonrpc"in r&&r.jsonrpc==="2.0"}function Xo(r){return Yu(r)&&"method"in r}function va(r){return Yu(r)&&(Fr(r)||br(r))}function Fr(r){return"result"in r}function br(r){return"error"in r}class c2 extends s2{constructor(e){super(e),this.events=new Tr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Ni(e.method,e.params||[],e.id||Ri().toString()),t)}async requestStrict(e,t){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(s){n(s)}this.events.on(`${e.id}`,s=>{br(s)?n(s.error):i(s.result)});try{await this.connection.send(e,t)}catch(s){n(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),va(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const u2=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),l2=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",qh=r=>r.split("?")[0],Uh=10,d2=u2();let p2=class{constructor(e){if(this.url=e,this.events=new Tr.EventEmitter,this.registering=!1,!Fh(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Li(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!Fh(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,i)=>{const n=new URLSearchParams(e).get("origin"),s=k0.isReactNative()?{headers:{origin:n}}:{rejectUnauthorized:!h2(e)},h=new d2(e,[],s);l2()?h.onerror=u=>{const g=u;i(this.emitError(g.error))}:h.on("error",u=>{i(this.emitError(u))}),h.onopen=()=>{this.onOpen(h),t(h)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?sn(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const i=this.parseError(t),n=i.message||i.toString(),s=wo(e,n);this.events.emit("payload",s)}parseError(e,t=this.url){return K0(e,qh(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Uh&&this.events.setMaxListeners(Uh)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${qh(this.url)}`));return this.events.emit("register_error",t),t}};var Hs={exports:{}};Hs.exports;(function(r,e){var t=200,i="__lodash_hash_undefined__",n=1,s=2,h=9007199254740991,u="[object Arguments]",g="[object Array]",b="[object AsyncFunction]",_="[object Boolean]",M="[object Date]",A="[object Error]",I="[object Function]",D="[object GeneratorFunction]",N="[object Map]",U="[object Number]",k="[object Null]",T="[object Object]",K="[object Promise]",R="[object Proxy]",C="[object RegExp]",$="[object Set]",E="[object String]",O="[object Symbol]",J="[object Undefined]",Z="[object WeakMap]",P="[object ArrayBuffer]",w="[object DataView]",c="[object Float32Array]",a="[object Float64Array]",o="[object Int8Array]",d="[object Int16Array]",v="[object Int32Array]",y="[object Uint8Array]",m="[object Uint8ClampedArray]",l="[object Uint16Array]",p="[object Uint32Array]",f=/[\\^$.*+?()[\]{}|]/g,x=/^\[object .+?Constructor\]$/,H=/^(?:0|[1-9]\d*)$/,j={};j[c]=j[a]=j[o]=j[d]=j[v]=j[y]=j[m]=j[l]=j[p]=!0,j[u]=j[g]=j[P]=j[_]=j[w]=j[M]=j[A]=j[I]=j[N]=j[U]=j[T]=j[C]=j[$]=j[E]=j[Z]=!1;var G=typeof Oi=="object"&&Oi&&Oi.Object===Object&&Oi,B=typeof self=="object"&&self&&self.Object===Object&&self,z=G||B||Function("return this")(),q=e&&!e.nodeType&&e,S=q&&!0&&r&&!r.nodeType&&r,F=S&&S.exports===q,W=F&&G.process,te=function(){try{return W&&W.binding&&W.binding("util")}catch{}}(),fe=te&&te.isTypedArray;function ie(L,V){for(var X=-1,Ae=L==null?0:L.length,ft=0,Xe=[];++X<Ae;){var ut=L[X];V(ut,X,L)&&(Xe[ft++]=ut)}return Xe}function Ce(L,V){for(var X=-1,Ae=V.length,ft=L.length;++X<Ae;)L[ft+X]=V[X];return L}function ye(L,V){for(var X=-1,Ae=L==null?0:L.length;++X<Ae;)if(V(L[X],X,L))return!0;return!1}function oe(L,V){for(var X=-1,Ae=Array(L);++X<L;)Ae[X]=V(X);return Ae}function ze(L){return function(V){return L(V)}}function ge(L,V){return L.has(V)}function re(L,V){return L==null?void 0:L[V]}function Ne(L){var V=-1,X=Array(L.size);return L.forEach(function(Ae,ft){X[++V]=[ft,Ae]}),X}function ce(L,V){return function(X){return L(V(X))}}function ee(L){var V=-1,X=Array(L.size);return L.forEach(function(Ae){X[++V]=Ae}),X}var Ie=Array.prototype,se=Function.prototype,Y=Object.prototype,Pe=z["__core-js_shared__"],ve=se.toString,Q=Y.hasOwnProperty,Le=function(){var L=/[^.]+$/.exec(Pe&&Pe.keys&&Pe.keys.IE_PROTO||"");return L?"Symbol(src)_1."+L:""}(),me=Y.toString,ne=RegExp("^"+ve.call(Q).replace(f,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),$e=F?z.Buffer:void 0,we=z.Symbol,xe=z.Uint8Array,Ze=Y.propertyIsEnumerable,qe=Ie.splice,_e=we?we.toStringTag:void 0,tt=Object.getOwnPropertySymbols,Ue=$e?$e.isBuffer:void 0,Ee=ce(Object.keys,Object),Be=Vi(z,"DataView"),Se=Vi(z,"Map"),he=Vi(z,"Promise"),ke=Vi(z,"Set"),De=Vi(z,"WeakMap"),ae=Vi(Object,"create"),Ve=_i(Be),Re=_i(Se),de=_i(he),Ge=_i(ke),Te=_i(De),ue=we?we.prototype:void 0,Ke=ue?ue.valueOf:void 0;function Me(L){var V=-1,X=L==null?0:L.length;for(this.clear();++V<X;){var Ae=L[V];this.set(Ae[0],Ae[1])}}function pe(){this.__data__=ae?ae(null):{},this.size=0}function We(L){var V=this.has(L)&&delete this.__data__[L];return this.size-=V?1:0,V}function He(L){var V=this.__data__;if(ae){var X=V[L];return X===i?void 0:X}return Q.call(V,L)?V[L]:void 0}function Oe(L){var V=this.__data__;return ae?V[L]!==void 0:Q.call(V,L)}function rt(L,V){var X=this.__data__;return this.size+=this.has(L)?0:1,X[L]=ae&&V===void 0?i:V,this}Me.prototype.clear=pe,Me.prototype.delete=We,Me.prototype.get=He,Me.prototype.has=Oe,Me.prototype.set=rt;function Fe(L){var V=-1,X=L==null?0:L.length;for(this.clear();++V<X;){var Ae=L[V];this.set(Ae[0],Ae[1])}}function je(){this.__data__=[],this.size=0}function Gt(L){var V=this.__data__,X=fs(V,L);if(X<0)return!1;var Ae=V.length-1;return X==Ae?V.pop():qe.call(V,X,1),--this.size,!0}function Wt(L){var V=this.__data__,X=fs(V,L);return X<0?void 0:V[X][1]}function Jt(L){return fs(this.__data__,L)>-1}function Yt(L,V){var X=this.__data__,Ae=fs(X,L);return Ae<0?(++this.size,X.push([L,V])):X[Ae][1]=V,this}Fe.prototype.clear=je,Fe.prototype.delete=Gt,Fe.prototype.get=Wt,Fe.prototype.has=Jt,Fe.prototype.set=Yt;function mt(L){var V=-1,X=L==null?0:L.length;for(this.clear();++V<X;){var Ae=L[V];this.set(Ae[0],Ae[1])}}function Xt(){this.size=0,this.__data__={hash:new Me,map:new(Se||Fe),string:new Me}}function Zt(L){var V=hs(this,L).delete(L);return this.size-=V?1:0,V}function Qt(L){return hs(this,L).get(L)}function er(L){return hs(this,L).has(L)}function tr(L,V){var X=hs(this,L),Ae=X.size;return X.set(L,V),this.size+=X.size==Ae?0:1,this}mt.prototype.clear=Xt,mt.prototype.delete=Zt,mt.prototype.get=Qt,mt.prototype.has=er,mt.prototype.set=tr;function Rt(L){var V=-1,X=L==null?0:L.length;for(this.__data__=new mt;++V<X;)this.add(L[V])}function rr(L){return this.__data__.set(L,i),this}function ir(L){return this.__data__.has(L)}Rt.prototype.add=Rt.prototype.push=rr,Rt.prototype.has=ir;function gt(L){var V=this.__data__=new Fe(L);this.size=V.size}function nr(){this.__data__=new Fe,this.size=0}function sr(L){var V=this.__data__,X=V.delete(L);return this.size=V.size,X}function ar(L){return this.__data__.get(L)}function Yr(L){return this.__data__.has(L)}function Xr(L,V){var X=this.__data__;if(X instanceof Fe){var Ae=X.__data__;if(!Se||Ae.length<t-1)return Ae.push([L,V]),this.size=++X.size,this;X=this.__data__=new mt(Ae)}return X.set(L,V),this.size=X.size,this}gt.prototype.clear=nr,gt.prototype.delete=sr,gt.prototype.get=ar,gt.prototype.has=Yr,gt.prototype.set=Xr;function v0(L,V){var X=cs(L),Ae=!X&&O0(L),ft=!X&&!Ae&&ma(L),Xe=!X&&!Ae&&!ft&&uf(L),ut=X||Ae||ft||Xe,wt=ut?oe(L.length,String):[],At=wt.length;for(var ct in L)Q.call(L,ct)&&!(ut&&(ct=="length"||ft&&(ct=="offset"||ct=="parent")||Xe&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||S0(ct,At)))&&wt.push(ct);return wt}function fs(L,V){for(var X=L.length;X--;)if(of(L[X][0],V))return X;return-1}function g0(L,V,X){var Ae=V(L);return cs(L)?Ae:Ce(Ae,X(L))}function Mn(L){return L==null?L===void 0?J:k:_e&&_e in Object(L)?M0(L):P0(L)}function rf(L){return En(L)&&Mn(L)==u}function nf(L,V,X,Ae,ft){return L===V?!0:L==null||V==null||!En(L)&&!En(V)?L!==L&&V!==V:b0(L,V,X,Ae,nf,ft)}function b0(L,V,X,Ae,ft,Xe){var ut=cs(L),wt=cs(V),At=ut?g:fi(L),ct=wt?g:fi(V);At=At==u?T:At,ct=ct==u?T:ct;var or=At==T,Sr=ct==T,Tt=At==ct;if(Tt&&ma(L)){if(!ma(V))return!1;ut=!0,or=!1}if(Tt&&!or)return Xe||(Xe=new gt),ut||uf(L)?sf(L,V,X,Ae,ft,Xe):_0(L,V,At,X,Ae,ft,Xe);if(!(X&n)){var dr=or&&Q.call(L,"__wrapped__"),pr=Sr&&Q.call(V,"__wrapped__");if(dr||pr){var hi=dr?L.value():L,Zr=pr?V.value():V;return Xe||(Xe=new gt),ft(hi,Zr,X,Ae,Xe)}}return Tt?(Xe||(Xe=new gt),x0(L,V,X,Ae,ft,Xe)):!1}function m0(L){if(!cf(L)||A0(L))return!1;var V=ff(L)?ne:x;return V.test(_i(L))}function y0(L){return En(L)&&hf(L.length)&&!!j[Mn(L)]}function w0(L){if(!D0(L))return Ee(L);var V=[];for(var X in Object(L))Q.call(L,X)&&X!="constructor"&&V.push(X);return V}function sf(L,V,X,Ae,ft,Xe){var ut=X&n,wt=L.length,At=V.length;if(wt!=At&&!(ut&&At>wt))return!1;var ct=Xe.get(L);if(ct&&Xe.get(V))return ct==V;var or=-1,Sr=!0,Tt=X&s?new Rt:void 0;for(Xe.set(L,V),Xe.set(V,L);++or<wt;){var dr=L[or],pr=V[or];if(Ae)var hi=ut?Ae(pr,dr,or,V,L,Xe):Ae(dr,pr,or,L,V,Xe);if(hi!==void 0){if(hi)continue;Sr=!1;break}if(Tt){if(!ye(V,function(Zr,xi){if(!ge(Tt,xi)&&(dr===Zr||ft(dr,Zr,X,Ae,Xe)))return Tt.push(xi)})){Sr=!1;break}}else if(!(dr===pr||ft(dr,pr,X,Ae,Xe))){Sr=!1;break}}return Xe.delete(L),Xe.delete(V),Sr}function _0(L,V,X,Ae,ft,Xe,ut){switch(X){case w:if(L.byteLength!=V.byteLength||L.byteOffset!=V.byteOffset)return!1;L=L.buffer,V=V.buffer;case P:return!(L.byteLength!=V.byteLength||!Xe(new xe(L),new xe(V)));case _:case M:case U:return of(+L,+V);case A:return L.name==V.name&&L.message==V.message;case C:case E:return L==V+"";case N:var wt=Ne;case $:var At=Ae&n;if(wt||(wt=ee),L.size!=V.size&&!At)return!1;var ct=ut.get(L);if(ct)return ct==V;Ae|=s,ut.set(L,V);var or=sf(wt(L),wt(V),Ae,ft,Xe,ut);return ut.delete(L),or;case O:if(Ke)return Ke.call(L)==Ke.call(V)}return!1}function x0(L,V,X,Ae,ft,Xe){var ut=X&n,wt=af(L),At=wt.length,ct=af(V),or=ct.length;if(At!=or&&!ut)return!1;for(var Sr=At;Sr--;){var Tt=wt[Sr];if(!(ut?Tt in V:Q.call(V,Tt)))return!1}var dr=Xe.get(L);if(dr&&Xe.get(V))return dr==V;var pr=!0;Xe.set(L,V),Xe.set(V,L);for(var hi=ut;++Sr<At;){Tt=wt[Sr];var Zr=L[Tt],xi=V[Tt];if(Ae)var lf=ut?Ae(xi,Zr,Tt,V,L,Xe):Ae(Zr,xi,Tt,L,V,Xe);if(!(lf===void 0?Zr===xi||ft(Zr,xi,X,Ae,Xe):lf)){pr=!1;break}hi||(hi=Tt=="constructor")}if(pr&&!hi){var us=L.constructor,ls=V.constructor;us!=ls&&"constructor"in L&&"constructor"in V&&!(typeof us=="function"&&us instanceof us&&typeof ls=="function"&&ls instanceof ls)&&(pr=!1)}return Xe.delete(L),Xe.delete(V),pr}function af(L){return g0(L,T0,E0)}function hs(L,V){var X=L.__data__;return I0(V)?X[typeof V=="string"?"string":"hash"]:X.map}function Vi(L,V){var X=re(L,V);return m0(X)?X:void 0}function M0(L){var V=Q.call(L,_e),X=L[_e];try{L[_e]=void 0;var Ae=!0}catch{}var ft=me.call(L);return Ae&&(V?L[_e]=X:delete L[_e]),ft}var E0=tt?function(L){return L==null?[]:(L=Object(L),ie(tt(L),function(V){return Ze.call(L,V)}))}:C0,fi=Mn;(Be&&fi(new Be(new ArrayBuffer(1)))!=w||Se&&fi(new Se)!=N||he&&fi(he.resolve())!=K||ke&&fi(new ke)!=$||De&&fi(new De)!=Z)&&(fi=function(L){var V=Mn(L),X=V==T?L.constructor:void 0,Ae=X?_i(X):"";if(Ae)switch(Ae){case Ve:return w;case Re:return N;case de:return K;case Ge:return $;case Te:return Z}return V});function S0(L,V){return V=V??h,!!V&&(typeof L=="number"||H.test(L))&&L>-1&&L%1==0&&L<V}function I0(L){var V=typeof L;return V=="string"||V=="number"||V=="symbol"||V=="boolean"?L!=="__proto__":L===null}function A0(L){return!!Le&&Le in L}function D0(L){var V=L&&L.constructor,X=typeof V=="function"&&V.prototype||Y;return L===X}function P0(L){return me.call(L)}function _i(L){if(L!=null){try{return ve.call(L)}catch{}try{return L+""}catch{}}return""}function of(L,V){return L===V||L!==L&&V!==V}var O0=rf(function(){return arguments}())?rf:function(L){return En(L)&&Q.call(L,"callee")&&!Ze.call(L,"callee")},cs=Array.isArray;function N0(L){return L!=null&&hf(L.length)&&!ff(L)}var ma=Ue||L0;function R0(L,V){return nf(L,V)}function ff(L){if(!cf(L))return!1;var V=Mn(L);return V==I||V==D||V==b||V==R}function hf(L){return typeof L=="number"&&L>-1&&L%1==0&&L<=h}function cf(L){var V=typeof L;return L!=null&&(V=="object"||V=="function")}function En(L){return L!=null&&typeof L=="object"}var uf=fe?ze(fe):y0;function T0(L){return N0(L)?v0(L):w0(L)}function C0(){return[]}function L0(){return!1}r.exports=R0})(Hs,Hs.exports);var v2=Hs.exports;const g2=cn(v2),Xu="wc",Zu=2,Zo="core",Gr=`${Xu}@2:${Zo}:`,b2={name:Zo,logger:"error"},m2={database:":memory:"},y2="crypto",zh="client_ed25519_seed",w2=be.ONE_DAY,_2="keychain",x2="0.3",M2="messages",E2="0.3",S2=be.SIX_HOURS,I2="publisher",Qu="irn",A2="error",e0="wss://relay.walletconnect.org",D2="relayer",Ft={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},P2="_subscription",vr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},O2=.1,bo="2.17.2",nt={link_mode:"link_mode",relay:"relay"},N2="0.3",R2="WALLETCONNECT_CLIENT_ID",Bh="WALLETCONNECT_LINK_MODE_APPS",qr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},T2="subscription",C2="0.3",L2=be.FIVE_SECONDS*1e3,$2="pairing",F2="0.3",Rn={wc_pairingDelete:{req:{ttl:be.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:be.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:be.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:be.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:be.ONE_DAY,prompt:!1,tag:0},res:{ttl:be.ONE_DAY,prompt:!1,tag:0}}},Pi={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Ar={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},q2="history",U2="0.3",z2="expirer",gr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},B2="0.3",k2="verify-api",K2="https://verify.walletconnect.com",t0="https://verify.walletconnect.org",Un=t0,j2=`${Un}/v3`,H2=[K2,t0],V2="echo",G2="https://echo.walletconnect.com",$r={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},ei={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Dr={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},Ii={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},Ai={authenticated_session_approve_started:"authenticated_session_approve_started",authenticated_session_not_expired:"authenticated_session_not_expired",chains_caip2_compliant:"chains_caip2_compliant",chains_evm_compliant:"chains_evm_compliant",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve",authenticated_session_approve_publish_success:"authenticated_session_approve_publish_success"},Tn={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",missing_session_authenticate_request:"missing_session_authenticate_request",session_authenticate_request_expired:"session_authenticate_request_expired",chains_caip2_compliant_failure:"chains_caip2_compliant_failure",chains_evm_compliant_failure:"chains_evm_compliant_failure",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},W2=.1,J2="event-client",Y2=86400,X2="https://pulse.walletconnect.org/batch";function Z2(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var n=0;n<r.length;n++){var s=r.charAt(n),h=s.charCodeAt(0);if(t[h]!==255)throw new TypeError(s+" is ambiguous");t[h]=n}var u=r.length,g=r.charAt(0),b=Math.log(u)/Math.log(256),_=Math.log(256)/Math.log(u);function M(D){if(D instanceof Uint8Array||(ArrayBuffer.isView(D)?D=new Uint8Array(D.buffer,D.byteOffset,D.byteLength):Array.isArray(D)&&(D=Uint8Array.from(D))),!(D instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(D.length===0)return"";for(var N=0,U=0,k=0,T=D.length;k!==T&&D[k]===0;)k++,N++;for(var K=(T-k)*_+1>>>0,R=new Uint8Array(K);k!==T;){for(var C=D[k],$=0,E=K-1;(C!==0||$<U)&&E!==-1;E--,$++)C+=256*R[E]>>>0,R[E]=C%u>>>0,C=C/u>>>0;if(C!==0)throw new Error("Non-zero carry");U=$,k++}for(var O=K-U;O!==K&&R[O]===0;)O++;for(var J=g.repeat(N);O<K;++O)J+=r.charAt(R[O]);return J}function A(D){if(typeof D!="string")throw new TypeError("Expected String");if(D.length===0)return new Uint8Array;var N=0;if(D[N]!==" "){for(var U=0,k=0;D[N]===g;)U++,N++;for(var T=(D.length-N)*b+1>>>0,K=new Uint8Array(T);D[N];){var R=t[D.charCodeAt(N)];if(R===255)return;for(var C=0,$=T-1;(R!==0||C<k)&&$!==-1;$--,C++)R+=u*K[$]>>>0,K[$]=R%256>>>0,R=R/256>>>0;if(R!==0)throw new Error("Non-zero carry");k=C,N++}if(D[N]!==" "){for(var E=T-k;E!==T&&K[E]===0;)E++;for(var O=new Uint8Array(U+(T-E)),J=U;E!==T;)O[J++]=K[E++];return O}}}function I(D){var N=A(D);if(N)return N;throw new Error(`Non-${e} character`)}return{encode:M,decodeUnsafe:A,decode:I}}var Q2=Z2,e3=Q2;const r0=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},t3=r=>new TextEncoder().encode(r),r3=r=>new TextDecoder().decode(r);class i3{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class n3{constructor(e,t,i){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return i0(this,e)}}class s3{constructor(e){this.decoders=e}or(e){return i0(this,e)}decode(e){const t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const i0=(r,e)=>new s3({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class a3{constructor(e,t,i,n){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=n,this.encoder=new i3(e,t,i),this.decoder=new n3(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ga=({name:r,prefix:e,encode:t,decode:i})=>new a3(r,e,t,i),os=({prefix:r,name:e,alphabet:t})=>{const{encode:i,decode:n}=e3(t,e);return ga({prefix:r,name:e,encode:i,decode:s=>r0(n(s))})},o3=(r,e,t,i)=>{const n={};for(let _=0;_<e.length;++_)n[e[_]]=_;let s=r.length;for(;r[s-1]==="=";)--s;const h=new Uint8Array(s*t/8|0);let u=0,g=0,b=0;for(let _=0;_<s;++_){const M=n[r[_]];if(M===void 0)throw new SyntaxError(`Non-${i} character`);g=g<<t|M,u+=t,u>=8&&(u-=8,h[b++]=255&g>>u)}if(u>=t||255&g<<8-u)throw new SyntaxError("Unexpected end of data");return h},f3=(r,e,t)=>{const i=e[e.length-1]==="=",n=(1<<t)-1;let s="",h=0,u=0;for(let g=0;g<r.length;++g)for(u=u<<8|r[g],h+=8;h>t;)h-=t,s+=e[n&u>>h];if(h&&(s+=e[n&u<<t-h]),i)for(;s.length*t&7;)s+="=";return s},Nt=({name:r,prefix:e,bitsPerChar:t,alphabet:i})=>ga({prefix:e,name:r,encode(n){return f3(n,i,t)},decode(n){return o3(n,i,t,r)}}),h3=ga({prefix:"\0",name:"identity",encode:r=>r3(r),decode:r=>t3(r)});var c3=Object.freeze({__proto__:null,identity:h3});const u3=Nt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var l3=Object.freeze({__proto__:null,base2:u3});const d3=Nt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var p3=Object.freeze({__proto__:null,base8:d3});const v3=os({prefix:"9",name:"base10",alphabet:"0123456789"});var g3=Object.freeze({__proto__:null,base10:v3});const b3=Nt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),m3=Nt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var y3=Object.freeze({__proto__:null,base16:b3,base16upper:m3});const w3=Nt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),_3=Nt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),x3=Nt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),M3=Nt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),E3=Nt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),S3=Nt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),I3=Nt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),A3=Nt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),D3=Nt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var P3=Object.freeze({__proto__:null,base32:w3,base32upper:_3,base32pad:x3,base32padupper:M3,base32hex:E3,base32hexupper:S3,base32hexpad:I3,base32hexpadupper:A3,base32z:D3});const O3=os({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),N3=os({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var R3=Object.freeze({__proto__:null,base36:O3,base36upper:N3});const T3=os({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),C3=os({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var L3=Object.freeze({__proto__:null,base58btc:T3,base58flickr:C3});const $3=Nt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),F3=Nt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),q3=Nt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),U3=Nt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var z3=Object.freeze({__proto__:null,base64:$3,base64pad:F3,base64url:q3,base64urlpad:U3});const n0=Array.from(""),B3=n0.reduce((r,e,t)=>(r[t]=e,r),[]),k3=n0.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function K3(r){return r.reduce((e,t)=>(e+=B3[t],e),"")}function j3(r){const e=[];for(const t of r){const i=k3[t.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(i)}return new Uint8Array(e)}const H3=ga({prefix:"",name:"base256emoji",encode:K3,decode:j3});var V3=Object.freeze({__proto__:null,base256emoji:H3}),G3=s0,kh=128,W3=127,J3=~W3,Y3=Math.pow(2,31);function s0(r,e,t){e=e||[],t=t||0;for(var i=t;r>=Y3;)e[t++]=r&255|kh,r/=128;for(;r&J3;)e[t++]=r&255|kh,r>>>=7;return e[t]=r|0,s0.bytes=t-i+1,e}var X3=mo,Z3=128,Kh=127;function mo(r,i){var t=0,i=i||0,n=0,s=i,h,u=r.length;do{if(s>=u)throw mo.bytes=0,new RangeError("Could not decode varint");h=r[s++],t+=n<28?(h&Kh)<<n:(h&Kh)*Math.pow(2,n),n+=7}while(h>=Z3);return mo.bytes=s-i,t}var Q3=Math.pow(2,7),e6=Math.pow(2,14),t6=Math.pow(2,21),r6=Math.pow(2,28),i6=Math.pow(2,35),n6=Math.pow(2,42),s6=Math.pow(2,49),a6=Math.pow(2,56),o6=Math.pow(2,63),f6=function(r){return r<Q3?1:r<e6?2:r<t6?3:r<r6?4:r<i6?5:r<n6?6:r<s6?7:r<a6?8:r<o6?9:10},h6={encode:G3,decode:X3,encodingLength:f6},a0=h6;const jh=(r,e,t=0)=>(a0.encode(r,e,t),e),Hh=r=>a0.encodingLength(r),yo=(r,e)=>{const t=e.byteLength,i=Hh(r),n=i+Hh(t),s=new Uint8Array(n+t);return jh(r,s,0),jh(t,s,i),s.set(e,n),new c6(r,t,e,s)};class c6{constructor(e,t,i,n){this.code=e,this.size=t,this.digest=i,this.bytes=n}}const o0=({name:r,code:e,encode:t})=>new u6(r,e,t);class u6{constructor(e,t,i){this.name=e,this.code=t,this.encode=i}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?yo(this.code,t):t.then(i=>yo(this.code,i))}else throw Error("Unknown type, must be binary type")}}const f0=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),l6=o0({name:"sha2-256",code:18,encode:f0("SHA-256")}),d6=o0({name:"sha2-512",code:19,encode:f0("SHA-512")});var p6=Object.freeze({__proto__:null,sha256:l6,sha512:d6});const h0=0,v6="identity",c0=r0,g6=r=>yo(h0,c0(r)),b6={code:h0,name:v6,encode:c0,digest:g6};var m6=Object.freeze({__proto__:null,identity:b6});new TextEncoder,new TextDecoder;const Vh={...c3,...l3,...p3,...g3,...y3,...P3,...R3,...L3,...z3,...V3};({...p6,...m6});function y6(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function u0(r,e,t,i){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:i}}}const Gh=u0("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Ha=u0("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=y6(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),w6={utf8:Gh,"utf-8":Gh,hex:Vh.base16,latin1:Ha,ascii:Ha,binary:Ha,...Vh};function _6(r,e="utf8"){const t=w6[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}class x6{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=_2,this.version=x2,this.initialized=!1,this.storagePrefix=Gr,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()},this.get=i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:s}=le("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return n},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=Ut(t,this.name)}get context(){return Vt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,$u(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Fu(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=le("NOT_INITIALIZED",this.name);throw new Error(e)}}}class M6{constructor(e,t,i){this.core=e,this.logger=t,this.name=y2,this.randomSessionIdentifier=vo(),this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=n=>(this.isInitialized(),this.keychain.has(n)),this.getClientId=async()=>{this.isInitialized();const n=await this.getClientSeed(),s=Ff(n);return Bc(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const n=ty();return this.setPrivateKey(n.publicKey,n.privateKey)},this.signJWT=async n=>{this.isInitialized();const s=await this.getClientSeed(),h=Ff(s),u=this.randomSessionIdentifier;return await A1(u,n,w2,h)},this.generateSharedKey=(n,s,h)=>{this.isInitialized();const u=this.getPrivateKey(n),g=ry(u,s);return this.setSymKey(g,h)},this.setSymKey=async(n,s)=>{this.isInitialized();const h=s||Is(n);return await this.keychain.set(h,n),h},this.deleteKeyPair=async n=>{this.isInitialized(),await this.keychain.del(n)},this.deleteSymKey=async n=>{this.isInitialized(),await this.keychain.del(n)},this.encode=async(n,s,h)=>{this.isInitialized();const u=Gu(h),g=Li(s);if(Sh(u))return ny(g,h==null?void 0:h.encoding);if(Eh(u)){const A=u.senderPublicKey,I=u.receiverPublicKey;n=await this.generateSharedKey(A,I)}const b=this.getSymKey(n),{type:_,senderPublicKey:M}=u;return iy({type:_,symKey:b,message:g,senderPublicKey:M,encoding:h==null?void 0:h.encoding})},this.decode=async(n,s,h)=>{this.isInitialized();const u=oy(s,h);if(Sh(u)){const g=ay(s,h==null?void 0:h.encoding);return sn(g)}if(Eh(u)){const g=u.receiverPublicKey,b=u.senderPublicKey;n=await this.generateSharedKey(g,b)}try{const g=this.getSymKey(n),b=sy({symKey:g,encoded:s,encoding:h==null?void 0:h.encoding});return sn(b)}catch(g){this.logger.error(`Failed to decode message from topic: '${n}', clientId: '${await this.getClientId()}'`),this.logger.error(g)}},this.getPayloadType=(n,s=pi)=>{const h=Hn({encoded:n,encoding:s});return qi(h.type)},this.getPayloadSenderPublicKey=(n,s=pi)=>{const h=Hn({encoded:n,encoding:s});return h.senderPublicKey?Kt(h.senderPublicKey,qt):void 0},this.core=e,this.logger=Ut(t,this.name),this.keychain=i||new x6(this.core,this.logger)}get context(){return Vt(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(zh)}catch{e=vo(),await this.keychain.set(zh,e)}return _6(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=le("NOT_INITIALIZED",this.name);throw new Error(e)}}}class E6 extends Cd{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=M2,this.version=E2,this.initialized=!1,this.storagePrefix=Gr,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,n)=>{this.isInitialized();const s=ti(n);let h=this.messages.get(i);return typeof h>"u"&&(h={}),typeof h[s]<"u"||(h[s]=n,this.messages.set(i,h),await this.persist()),s},this.get=i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n},this.has=(i,n)=>{this.isInitialized();const s=this.get(i),h=ti(n);return typeof s[h]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=Ut(e,this.name),this.core=t}get context(){return Vt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,$u(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Fu(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=le("NOT_INITIALIZED",this.name);throw new Error(e)}}}class S6 extends Ld{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new Tr.EventEmitter,this.name=I2,this.queue=new Map,this.publishTimeout=be.toMiliseconds(be.ONE_MINUTE),this.failedPublishTimeout=be.toMiliseconds(be.ONE_SECOND),this.needsTransportRestart=!1,this.publish=async(i,n,s)=>{var h;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}});const u=(s==null?void 0:s.ttl)||S2,g=go(s),b=(s==null?void 0:s.prompt)||!1,_=(s==null?void 0:s.tag)||0,M=(s==null?void 0:s.id)||Ri().toString(),A={topic:i,message:n,opts:{ttl:u,relay:g,prompt:b,tag:_,id:M,attestation:s==null?void 0:s.attestation}},I=`Failed to publish payload, please try again. id:${M} tag:${_}`,D=Date.now();let N,U=1;try{for(;N===void 0;){if(Date.now()-D>this.publishTimeout)throw new Error(I);this.logger.trace({id:M,attempts:U},`publisher.publish - attempt ${U}`),N=await await nn(this.rpcPublish(i,n,u,g,b,_,M,s==null?void 0:s.attestation).catch(k=>this.logger.warn(k)),this.publishTimeout,I),U++,N||await new Promise(k=>setTimeout(k,this.failedPublishTimeout))}this.relayer.events.emit(Ft.publish,A),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{id:M,topic:i,message:n,opts:s}})}catch(k){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(k),(h=s==null?void 0:s.internal)!=null&&h.throwOnFailedPublish)throw k;this.queue.set(M,A)}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=Ut(t,this.name),this.registerEventListeners()}get context(){return Vt(this.logger)}rpcPublish(e,t,i,n,s,h,u,g){var b,_,M,A;const I={method:Fn(n.protocol).publish,params:{topic:e,message:t,ttl:i,prompt:s,tag:h,attestation:g},id:u};return kt((b=I.params)==null?void 0:b.prompt)&&((_=I.params)==null||delete _.prompt),kt((M=I.params)==null?void 0:M.tag)&&((A=I.params)==null||delete A.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:I}),this.relayer.request(I)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:i,opts:n}=e;await this.publish(t,i,n)})}registerEventListeners(){this.relayer.core.heartbeat.on(un.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Ft.connection_stalled);return}this.checkQueue()}),this.relayer.on(Ft.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class I6{constructor(){this.map=new Map,this.set=(e,t)=>{const i=this.get(e);this.exists(e,t)||this.map.set(e,[...i,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,t))return;const n=i.filter(s=>s!==t);if(!n.length){this.map.delete(e);return}this.map.set(e,n)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var A6=Object.defineProperty,D6=Object.defineProperties,P6=Object.getOwnPropertyDescriptors,Wh=Object.getOwnPropertySymbols,O6=Object.prototype.hasOwnProperty,N6=Object.prototype.propertyIsEnumerable,Jh=(r,e,t)=>e in r?A6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Cn=(r,e)=>{for(var t in e||(e={}))O6.call(e,t)&&Jh(r,t,e[t]);if(Wh)for(var t of Wh(e))N6.call(e,t)&&Jh(r,t,e[t]);return r},Va=(r,e)=>D6(r,P6(e));class R6 extends qd{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new I6,this.events=new Tr.EventEmitter,this.name=T2,this.version=C2,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Gr,this.subscribeTimeout=be.toMiliseconds(be.ONE_MINUTE),this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.pendingBatchMessages=[],this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId(),await this.restore()),this.initialized=!0},this.subscribe=async(i,n)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const s=go(n),h={topic:i,relay:s,transportType:n==null?void 0:n.transportType};this.pending.set(i,h);const u=await this.rpcSubscribe(i,s,n);return typeof u=="string"&&(this.onSubscribe(u,h),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}})),u}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),typeof(n==null?void 0:n.id)<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)},this.isSubscribed=async i=>{if(this.topics.includes(i))return!0;const n=`${this.pendingSubscriptionWatchLabel}_${i}`;return await new Promise((s,h)=>{const u=new be.Watch;u.start(n);const g=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(g),u.stop(n),s(!0)),u.elapsed(n)>=L2&&(clearInterval(g),u.stop(n),h(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.start=async()=>{await this.onConnect()},this.stop=async()=>{await this.onDisconnect()},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Ut(t,this.name),this.clientId=""}get context(){return Vt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let i=!1;try{i=this.getSubscription(e).topic===t}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,t)))}async unsubscribeById(e,t,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}});try{const n=go(i);await this.rpcUnsubscribe(e,t,n);const s=st("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,t,i){var n;(i==null?void 0:i.transportType)===nt.relay&&await this.restartToComplete();const s={method:Fn(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});const h=(n=i==null?void 0:i.internal)==null?void 0:n.throwOnFailedPublish;try{const u=ti(e+this.clientId);if((i==null?void 0:i.transportType)===nt.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(s).catch(b=>this.logger.warn(b))},be.toMiliseconds(be.ONE_SECOND)),u;const g=await nn(this.relayer.request(s).catch(b=>this.logger.warn(b)),this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!g&&h)throw new Error(`Subscribing to ${e} failed, please try again`);return g?u:null}catch(u){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Ft.connection_stalled),h)throw u}return null}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,i={method:Fn(t.protocol).batchSubscribe,params:{topics:e.map(n=>n.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{return await await nn(this.relayer.request(i).catch(n=>this.logger.warn(n)),this.subscribeTimeout)}catch{this.relayer.events.emit(Ft.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const t=e[0].relay,i={method:Fn(t.protocol).batchFetchMessages,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});let n;try{n=await await nn(this.relayer.request(i).catch(s=>this.logger.warn(s)),this.subscribeTimeout)}catch{this.relayer.events.emit(Ft.connection_stalled)}return n}rpcUnsubscribe(e,t,i){const n={method:Fn(i.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)}onSubscribe(e,t){this.setSubscription(e,Va(Cn({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,Cn({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,i){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,Cn({},t)),this.topicMap.set(t.topic,e),this.events.emit(qr.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:i}=le("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(qr.deleted,Va(Cn({},i),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(qr.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const i=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchFetchMessages(i),await this.batchSubscribe(i)}}this.events.emit(qr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=le("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);as(t)&&this.onBatchSubscribe(t.map((i,n)=>Va(Cn({},e[n]),{id:i})))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(this.pendingBatchMessages=this.pendingBatchMessages.concat(t.messages))}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||!this.relayer.connected)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e),this.pendingBatchMessages.length&&(await this.relayer.handleBatchMessageEvents(this.pendingBatchMessages),this.pendingBatchMessages=[])}registerEventListeners(){this.relayer.core.heartbeat.on(un.pulse,async()=>{await this.checkPending()}),this.events.on(qr.created,async e=>{const t=qr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(qr.deleted,async e=>{const t=qr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=le("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){!this.relayer.connected&&!this.relayer.connecting&&await this.relayer.transportOpen(),this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var T6=Object.defineProperty,Yh=Object.getOwnPropertySymbols,C6=Object.prototype.hasOwnProperty,L6=Object.prototype.propertyIsEnumerable,Xh=(r,e,t)=>e in r?T6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Zh=(r,e)=>{for(var t in e||(e={}))C6.call(e,t)&&Xh(r,t,e[t]);if(Yh)for(var t of Yh(e))L6.call(e,t)&&Xh(r,t,e[t]);return r};class $6 extends $d{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Tr.EventEmitter,this.name=D2,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","stalled","interrupted"],this.hasExperiencedNetworkDisruption=!1,this.requestsInFlight=new Map,this.heartBeatTimeout=be.toMiliseconds(be.THIRTY_SECONDS+be.ONE_SECOND),this.request=async t=>{var i,n;this.logger.debug("Publishing Request Payload");const s=t.id||Ri().toString();await this.toEstablishConnection();try{const h=this.provider.request(t);this.requestsInFlight.set(s,{promise:h,request:t}),this.logger.trace({id:s,method:t.method,topic:(i=t.params)==null?void 0:i.topic},"relayer.request - attempt to publish...");const u=await new Promise(async(g,b)=>{const _=()=>{b(new Error(`relayer.request - publish interrupted, id: ${s}`))};this.provider.on(vr.disconnect,_);const M=await h;this.provider.off(vr.disconnect,_),g(M)});return this.logger.trace({id:s,method:t.method,topic:(n=t.params)==null?void 0:n.topic},"relayer.request - published"),u}catch(h){throw this.logger.debug(`Failed to Publish Request: ${s}`),h}finally{this.requestsInFlight.delete(s)}},this.resetPingTimeout=()=>{if(Bs())try{clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var t,i,n;(n=(i=(t=this.provider)==null?void 0:t.connection)==null?void 0:i.socket)==null||n.terminate()},this.heartBeatTimeout)}catch(t){this.logger.warn(t)}},this.onPayloadHandler=t=>{this.onProviderPayload(t),this.resetPingTimeout()},this.onConnectHandler=()=>{this.logger.trace("relayer connected"),this.startPingTimeout(),this.events.emit(Ft.connect)},this.onDisconnectHandler=()=>{this.logger.trace("relayer disconnected"),this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(Ft.error,t),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(vr.payload,this.onPayloadHandler),this.provider.on(vr.connect,this.onConnectHandler),this.provider.on(vr.disconnect,this.onDisconnectHandler),this.provider.on(vr.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Ut(e.logger,this.name):Js(Eo({level:e.logger||A2})),this.messages=new E6(this.logger,e.core),this.subscriber=new R6(this,this.logger),this.publisher=new S6(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||e0,this.projectId=e.projectId,this.bundleId=mm(),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.cached.length>0)try{await this.transportOpen()}catch(e){this.logger.warn(e)}}get context(){return Vt(this.logger)}get connected(){var e,t,i;return((i=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:i.readyState)===1}get connecting(){var e,t,i;return((i=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:i.readyState)===0}async publish(e,t,i){this.isInitialized(),await this.publisher.publish(e,t,i),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:nt.relay})}async subscribe(e,t){var i,n,s;this.isInitialized(),(t==null?void 0:t.transportType)==="relay"&&await this.toEstablishConnection();const h=typeof((i=t==null?void 0:t.internal)==null?void 0:i.throwOnFailedPublish)>"u"?!0:(n=t==null?void 0:t.internal)==null?void 0:n.throwOnFailedPublish;let u=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"",g;const b=_=>{_.topic===e&&(this.subscriber.off(qr.created,b),g())};return await Promise.all([new Promise(_=>{g=_,this.subscriber.on(qr.created,b)}),new Promise(async(_,M)=>{u=await this.subscriber.subscribe(e,Zh({internal:{throwOnFailedPublish:h}},t)).catch(A=>{h&&M(A)})||u,_()})]),u}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){if(!this.hasExperiencedNetworkDisruption&&this.connected&&this.requestsInFlight.size>0)try{await Promise.all(Array.from(this.requestsInFlight.values()).map(e=>e.promise))}catch(e){this.logger.warn(e)}this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await nn(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),await this.createProvider(),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;try{await new Promise(async(t,i)=>{const n=()=>{this.provider.off(vr.disconnect,n),i(new Error("Connection interrupted while trying to subscribe"))};this.provider.on(vr.disconnect,n),await nn(this.provider.connect(),be.toMiliseconds(be.ONE_MINUTE),`Socket stalled when trying to connect to ${this.relayUrl}`).catch(s=>{i(s)}).finally(()=>{clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0}),this.subscriber.start().catch(s=>{this.logger.error(s),this.onDisconnectHandler()}),this.hasExperiencedNetworkDisruption=!1,t()})}catch(t){this.logger.error(t);const i=t;if(this.hasExperiencedNetworkDisruption=!0,!this.isConnectionStalled(i.message))throw t}finally{this.connectionAttemptInProgress=!1}}async restartTransport(e){this.connectionAttemptInProgress||(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await $h())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const t=e.sort((i,n)=>i.publishedAt-n.publishedAt);this.logger.trace(`Batch of ${t.length} message events sorted`);for(const i of t)try{await this.onMessageEvent(i)}catch(n){this.logger.warn(n)}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){const{topic:i}=e;if(!t.sessionExists){const n=yt(be.FIVE_MINUTES),s={topic:i,expiry:n,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(i,s)}this.events.emit(Ft.message,e),await this.recordMessageEvent(e)}startPingTimeout(){var e,t,i,n,s;if(Bs())try{(t=(e=this.provider)==null?void 0:e.connection)!=null&&t.socket&&((s=(n=(i=this.provider)==null?void 0:i.connection)==null?void 0:n.socket)==null||s.once("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(h){this.logger.warn(h)}}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new c2(new p2(xm({sdkVersion:bo,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:i}=e;await this.messages.set(t,i)}async shouldIgnoreMessageEvent(e){const{topic:t,message:i}=e;if(!i||i.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${i}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const n=this.messages.has(t,i);return n&&this.logger.debug(`Ignoring duplicate message: ${i}`),n}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Xo(e)){if(!e.method.endsWith(P2))return;const t=e.params,{topic:i,message:n,publishedAt:s,attestation:h}=t.data,u={topic:i,message:n,publishedAt:s,transportType:nt.relay,attestation:h};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Zh({type:"event",event:t.id},u)),this.events.emit(t.id,u),await this.acknowledgePayload(e),await this.onMessageEvent(u)}else va(e)&&this.events.emit(Ft.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Ft.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=_o(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(vr.payload,this.onPayloadHandler),this.provider.off(vr.connect,this.onConnectHandler),this.provider.off(vr.disconnect,this.onDisconnectHandler),this.provider.off(vr.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await $h();e2(async t=>{e!==t&&(e=t,t?await this.restartTransport().catch(i=>this.logger.error(i)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){await this.subscriber.stop(),this.requestsInFlight.clear(),clearTimeout(this.pingTimeout),this.events.emit(Ft.disconnect),this.connectionAttemptInProgress=!1,!this.transportExplicitlyClosed&&(this.reconnectTimeout||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e))},be.toMiliseconds(O2))))}isInitialized(){if(!this.initialized){const{message:e}=le("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&(this.connectionAttemptInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)}),await this.transportOpen())}}var F6=Object.defineProperty,Qh=Object.getOwnPropertySymbols,q6=Object.prototype.hasOwnProperty,U6=Object.prototype.propertyIsEnumerable,ec=(r,e,t)=>e in r?F6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,tc=(r,e)=>{for(var t in e||(e={}))q6.call(e,t)&&ec(r,t,e[t]);if(Qh)for(var t of Qh(e))U6.call(e,t)&&ec(r,t,e[t]);return r};class Hi extends Fd{constructor(e,t,i,n=Gr,s=void 0){super(e,t,i,n),this.core=e,this.logger=t,this.name=i,this.map=new Map,this.version=N2,this.cached=[],this.initialized=!1,this.storagePrefix=Gr,this.recentlyDeleted=[],this.recentlyDeletedLimit=200,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(h=>{this.getKey&&h!==null&&!kt(h)?this.map.set(this.getKey(h),h):Ny(h)?this.map.set(h.id,h):Ry(h)&&this.map.set(h.topic,h)}),this.cached=[],this.initialized=!0)},this.set=async(h,u)=>{this.isInitialized(),this.map.has(h)?await this.update(h,u):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:h,value:u}),this.map.set(h,u),await this.persist())},this.get=h=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:h}),this.getData(h)),this.getAll=h=>(this.isInitialized(),h?this.values.filter(u=>Object.keys(h).every(g=>g2(u[g],h[g]))):this.values),this.update=async(h,u)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:h,update:u});const g=tc(tc({},this.getData(h)),u);this.map.set(h,g),await this.persist()},this.delete=async(h,u)=>{this.isInitialized(),this.map.has(h)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:h,reason:u}),this.map.delete(h),this.addToRecentlyDeleted(h),await this.persist())},this.logger=Ut(t,this.name),this.storagePrefix=n,this.getKey=s}get context(){return Vt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){const{message:n}=le("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}const{message:i}=le("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=le("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=le("NOT_INITIALIZED",this.name);throw new Error(e)}}}class z6{constructor(e,t){this.core=e,this.logger=t,this.name=$2,this.version=F2,this.events=new mc,this.initialized=!1,this.storagePrefix=Gr,this.ignoredPayloadTypes=[ni],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async i=>{this.isInitialized();const n=vo(),s=await this.core.crypto.setSymKey(n),h=yt(be.FIVE_MINUTES),u={protocol:Qu},g={topic:s,expiry:h,relay:u,active:!1,methods:i==null?void 0:i.methods},b=Oh({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:n,relay:u,expiryTimestamp:h,methods:i==null?void 0:i.methods});return this.events.emit(Pi.create,g),this.core.expirer.set(s,h),await this.pairings.set(s,g),await this.core.relayer.subscribe(s,{transportType:i==null?void 0:i.transportType}),{topic:s,uri:b}},this.pair=async i=>{this.isInitialized();const n=this.core.eventClient.createEvent({properties:{topic:i==null?void 0:i.uri,trace:[$r.pairing_started]}});this.isValidPair(i,n);const{topic:s,symKey:h,relay:u,expiryTimestamp:g,methods:b}=Ph(i.uri);n.props.properties.topic=s,n.addTrace($r.pairing_uri_validation_success),n.addTrace($r.pairing_uri_not_expired);let _;if(this.pairings.keys.includes(s)){if(_=this.pairings.get(s),n.addTrace($r.existing_pairing),_.active)throw n.setError(ei.active_pairing_already_exists),new Error(`Pairing already exists: ${s}. Please try again with a new connection URI.`);n.addTrace($r.pairing_not_expired)}const M=g||yt(be.FIVE_MINUTES),A={topic:s,relay:u,expiry:M,active:!1,methods:b};this.core.expirer.set(s,M),await this.pairings.set(s,A),n.addTrace($r.store_new_pairing),i.activatePairing&&await this.activate({topic:s}),this.events.emit(Pi.create,A),n.addTrace($r.emit_inactive_pairing),this.core.crypto.keychain.has(s)||await this.core.crypto.setSymKey(h,s),n.addTrace($r.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{n.setError(ei.no_internet_connection)}try{await this.core.relayer.subscribe(s,{relay:u})}catch(I){throw n.setError(ei.subscribe_pairing_topic_failure),I}return n.addTrace($r.subscribe_pairing_topic_success),A},this.activate=async({topic:i})=>{this.isInitialized();const n=yt(be.THIRTY_DAYS);this.core.expirer.set(i,n),await this.pairings.update(i,{active:!0,expiry:n})},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.pairings.keys.includes(n)){const s=await this.sendRequest(n,"wc_pairingPing",{}),{done:h,resolve:u,reject:g}=Di();this.events.once(Qe("pairing_ping",s),({error:b})=>{b?g(b):u()}),await h()}},this.updateExpiry=async({topic:i,expiry:n})=>{this.isInitialized(),await this.pairings.update(i,{expiry:n})},this.updateMetadata=async({topic:i,metadata:n})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:n})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",st("USER_DISCONNECTED")),await this.deletePairing(n))},this.formatUriFromPairing=i=>{this.isInitialized();const{topic:n,relay:s,expiry:h,methods:u}=i,g=this.core.crypto.keychain.get(n);return Oh({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:g,relay:s,expiryTimestamp:h,methods:u})},this.sendRequest=async(i,n,s)=>{const h=Ni(n,s),u=await this.core.crypto.encode(i,h),g=Rn[n].req;return this.core.history.set(i,h),this.core.relayer.publish(i,u,g),h.id},this.sendResult=async(i,n,s)=>{const h=_o(i,s),u=await this.core.crypto.encode(n,h),g=await this.core.history.get(n,i),b=Rn[g.request.method].res;await this.core.relayer.publish(n,u,b),await this.core.history.resolve(h)},this.sendError=async(i,n,s)=>{const h=wo(i,s),u=await this.core.crypto.encode(n,h),g=await this.core.history.get(n,i),b=Rn[g.request.method]?Rn[g.request.method].res:Rn.unregistered_method.res;await this.core.relayer.publish(n,u,b),await this.core.history.resolve(h)},this.deletePairing=async(i,n)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,st("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),n?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(n=>li(n.expiry));await Promise.all(i.map(n=>this.deletePairing(n.topic)))},this.onRelayEventRequest=i=>{const{topic:n,payload:s}=i;switch(s.method){case"wc_pairingPing":return this.onPairingPingRequest(n,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(n,s);default:return this.onUnknownRpcMethodRequest(n,s)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:s}=i,h=(await this.core.history.get(n,s.id)).request.method;switch(h){case"wc_pairingPing":return this.onPairingPingResponse(n,s);default:return this.onUnknownRpcMethodResponse(h)}},this.onPairingPingRequest=async(i,n)=>{const{id:s}=n;try{this.isValidPing({topic:i}),await this.sendResult(s,i,!0),this.events.emit(Pi.ping,{id:s,topic:i})}catch(h){await this.sendError(s,i,h),this.logger.error(h)}},this.onPairingPingResponse=(i,n)=>{const{id:s}=n;setTimeout(()=>{Fr(n)?this.events.emit(Qe("pairing_ping",s),{}):br(n)&&this.events.emit(Qe("pairing_ping",s),{error:n.error})},500)},this.onPairingDeleteRequest=async(i,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit(Pi.delete,{id:s,topic:i})}catch(h){await this.sendError(s,i,h),this.logger.error(h)}},this.onUnknownRpcMethodRequest=async(i,n)=>{const{id:s,method:h}=n;try{if(this.registeredMethods.includes(h))return;const u=st("WC_METHOD_UNSUPPORTED",h);await this.sendError(s,i,u),this.logger.error(u)}catch(u){await this.sendError(s,i,u),this.logger.error(u)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(st("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=(i,n)=>{var s;if(!Bt(i)){const{message:u}=le("MISSING_OR_INVALID",`pair() params: ${i}`);throw n.setError(ei.malformed_pairing_uri),new Error(u)}if(!Oy(i.uri)){const{message:u}=le("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw n.setError(ei.malformed_pairing_uri),new Error(u)}const h=Ph(i==null?void 0:i.uri);if(!((s=h==null?void 0:h.relay)!=null&&s.protocol)){const{message:u}=le("MISSING_OR_INVALID","pair() uri#relay-protocol");throw n.setError(ei.malformed_pairing_uri),new Error(u)}if(!(h!=null&&h.symKey)){const{message:u}=le("MISSING_OR_INVALID","pair() uri#symKey");throw n.setError(ei.malformed_pairing_uri),new Error(u)}if(h!=null&&h.expiryTimestamp&&be.toMiliseconds(h==null?void 0:h.expiryTimestamp)<Date.now()){n.setError(ei.pairing_expired);const{message:u}=le("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(u)}},this.isValidPing=async i=>{if(!Bt(i)){const{message:s}=le("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidDisconnect=async i=>{if(!Bt(i)){const{message:s}=le("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidPairingTopic=async i=>{if(!vt(i,!1)){const{message:n}=le("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(n)}if(!this.pairings.keys.includes(i)){const{message:n}=le("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(n)}if(li(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:n}=le("EXPIRED",`pairing topic: ${i}`);throw new Error(n)}},this.core=e,this.logger=Ut(t,this.name),this.pairings=new Hi(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Vt(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=le("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Ft.message,async e=>{const{topic:t,message:i,transportType:n}=e;if(!this.pairings.keys.includes(t)||n===nt.link_mode||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const s=await this.core.crypto.decode(t,i);try{Xo(s)?(this.core.history.set(t,s),this.onRelayEventRequest({topic:t,payload:s})):va(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:t,payload:s}),this.core.history.delete(t,s.id))}catch(h){this.logger.error(h)}})}registerExpirerEvents(){this.core.expirer.on(gr.expired,async e=>{const{topic:t}=Uu(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(Pi.expire,{topic:t}))})}}class B6 extends Td{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new Tr.EventEmitter,this.name=q2,this.version=U2,this.cached=[],this.initialized=!1,this.storagePrefix=Gr,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,n,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:s}),this.records.has(n.id))return;const h={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:s,expiry:yt(be.THIRTY_DAYS)};this.records.set(h.id,h),this.persist(),this.events.emit(Ar.created,h)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=br(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.persist(),this.events.emit(Ar.updated,n))},this.get=async(i,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n}),await this.getRecord(n)),this.delete=(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(s=>{if(s.topic===i){if(typeof n<"u"&&s.id!==n)return;this.records.delete(s.id),this.events.emit(Ar.deleted,s)}}),this.persist()},this.exists=async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=Ut(t,this.name)}get context(){return Vt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const i={topic:t.topic,request:Ni(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:i}=le("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Ar.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=le("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Ar.created,e=>{const t=Ar.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(Ar.updated,e=>{const t=Ar.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(Ar.deleted,e=>{const t=Ar.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(un.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{be.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(Ar.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=le("NOT_INITIALIZED",this.name);throw new Error(e)}}}class k6 extends Ud{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new Tr.EventEmitter,this.name=z2,this.version=B2,this.cached=[],this.initialized=!1,this.storagePrefix=Gr,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}},this.set=(i,n)=>{this.isInitialized();const s=this.formatTarget(i),h={target:s,expiry:n};this.expirations.set(s,h),this.checkExpiry(s,h),this.events.emit(gr.created,{target:s,expiration:h})},this.get=i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)},this.del=i=>{if(this.isInitialized(),this.has(i)){const n=this.formatTarget(i),s=this.getExpiration(n);this.expirations.delete(n),this.events.emit(gr.deleted,{target:n,expiration:s})}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=Ut(t,this.name)}get context(){return Vt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Mm(e);if(typeof e=="number")return Em(e);const{message:t}=le("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(gr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=le("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:i}=le("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(i),new Error(i)}return t}checkExpiry(e,t){const{expiry:i}=t;be.toMiliseconds(i)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(gr.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(un.pulse,()=>this.checkExpirations()),this.events.on(gr.created,e=>{const t=gr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(gr.expired,e=>{const t=gr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(gr.deleted,e=>{const t=gr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=le("NOT_INITIALIZED",this.name);throw new Error(e)}}}class K6 extends zd{constructor(e,t,i){super(e,t,i),this.core=e,this.logger=t,this.store=i,this.name=k2,this.verifyUrlV3=j2,this.storagePrefix=Gr,this.version=Zu,this.init=async()=>{var n;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&be.toMiliseconds((n=this.publicKey)==null?void 0:n.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))},this.register=async n=>{if(!rs()||this.isDevEnv)return;const s=window.location.origin,{id:h,decryptedId:u}=n,g=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${s}&id=${h}&decryptedId=${u}`;try{const b=Yn(),_=this.startAbortTimer(be.ONE_SECOND*5),M=await new Promise((A,I)=>{const D=()=>{window.removeEventListener("message",U),b.body.removeChild(N),I("attestation aborted")};this.abortController.signal.addEventListener("abort",D);const N=b.createElement("iframe");N.src=g,N.style.display="none",N.addEventListener("error",D,{signal:this.abortController.signal});const U=k=>{if(k.data&&typeof k.data=="string")try{const T=JSON.parse(k.data);if(T.type==="verify_attestation"){if(no(T.attestation).payload.id!==h)return;clearInterval(_),b.body.removeChild(N),this.abortController.signal.removeEventListener("abort",D),window.removeEventListener("message",U),A(T.attestation===null?"":T.attestation)}}catch(T){this.logger.warn(T)}};b.body.appendChild(N),window.addEventListener("message",U,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",M),M}catch(b){this.logger.warn(b)}return""},this.resolve=async n=>{if(this.isDevEnv)return"";const{attestationId:s,hash:h,encryptedId:u}=n;if(s===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(s){if(no(s).payload.id!==u)return;const b=await this.isValidJwtAttestation(s);if(b){if(!b.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return b}}if(!h)return;const g=this.getVerifyUrl(n==null?void 0:n.verifyUrl);return this.fetchAttestation(h,g)},this.fetchAttestation=async(n,s)=>{this.logger.debug(`resolving attestation: ${n} from url: ${s}`);const h=this.startAbortTimer(be.ONE_SECOND*5),u=await fetch(`${s}/attestation/${n}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(h),u.status===200?await u.json():void 0},this.getVerifyUrl=n=>{let s=n||Un;return H2.includes(s)||(this.logger.info(`verify url: ${s}, not included in trusted list, assigning default: ${Un}`),s=Un),s},this.fetchPublicKey=async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const n=this.startAbortTimer(be.FIVE_SECONDS),s=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(n),await s.json()}catch(n){this.logger.warn(n)}},this.persistPublicKey=async n=>{this.logger.debug("persisting public key to local storage",n),await this.store.setItem(this.storeKey,n),this.publicKey=n},this.removePublicKey=async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0},this.isValidJwtAttestation=async n=>{const s=await this.getPublicKey();try{if(s)return this.validateAttestation(n,s)}catch(u){this.logger.error(u),this.logger.warn("error validating attestation")}const h=await this.fetchAndPersistPublicKey();try{if(h)return this.validateAttestation(n,h)}catch(u){this.logger.error(u),this.logger.warn("error validating attestation")}},this.getPublicKey=async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey(),this.fetchAndPersistPublicKey=async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async s=>{const h=await this.fetchPublicKey();h&&(await this.persistPublicKey(h),s(h))});const n=await this.fetchPromise;return this.fetchPromise=void 0,n},this.validateAttestation=(n,s)=>{const h=uy(n,s.publicKey),u={hasExpired:be.toMiliseconds(h.exp)<Date.now(),payload:h};if(u.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:u.payload.origin,isScam:u.payload.isScam,isVerified:u.payload.isVerified}},this.logger=Ut(t,this.name),this.abortController=new AbortController,this.isDevEnv=Go(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return Vt(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),be.toMiliseconds(e))}}class j6 extends Bd{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.context=V2,this.registerDeviceToken=async i=>{const{clientId:n,token:s,notificationType:h,enableEncrypted:u=!1}=i,g=`${G2}/${this.projectId}/clients`;await fetch(g,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:n,type:h,token:s,always_raw:u})})},this.logger=Ut(t,this.context)}}var H6=Object.defineProperty,rc=Object.getOwnPropertySymbols,V6=Object.prototype.hasOwnProperty,G6=Object.prototype.propertyIsEnumerable,ic=(r,e,t)=>e in r?H6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ln=(r,e)=>{for(var t in e||(e={}))V6.call(e,t)&&ic(r,t,e[t]);if(rc)for(var t of rc(e))G6.call(e,t)&&ic(r,t,e[t]);return r};class W6 extends kd{constructor(e,t,i=!0){super(e,t,i),this.core=e,this.logger=t,this.context=J2,this.storagePrefix=Gr,this.storageVersion=W2,this.events=new Map,this.shouldPersist=!1,this.init=async()=>{if(!Go())try{const n={eventId:bh(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:Lu(this.core.relayer.protocol,this.core.relayer.version,bo)}}};await this.sendEvent([n])}catch(n){this.logger.warn(n)}},this.createEvent=n=>{const{event:s="ERROR",type:h="",properties:{topic:u,trace:g}}=n,b=bh(),_=this.core.projectId||"",M=Date.now(),A=Ln({eventId:b,timestamp:M,props:{event:s,type:h,properties:{topic:u,trace:g}},bundleId:_,domain:this.getAppDomain()},this.setMethods(b));return this.telemetryEnabled&&(this.events.set(b,A),this.shouldPersist=!0),A},this.getEvent=n=>{const{eventId:s,topic:h}=n;if(s)return this.events.get(s);const u=Array.from(this.events.values()).find(g=>g.props.properties.topic===h);if(u)return Ln(Ln({},u),this.setMethods(u.eventId))},this.deleteEvent=n=>{const{eventId:s}=n;this.events.delete(s),this.shouldPersist=!0},this.setEventListeners=()=>{this.core.heartbeat.on(un.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(n=>{be.fromMiliseconds(Date.now())-be.fromMiliseconds(n.timestamp)>Y2&&(this.events.delete(n.eventId),this.shouldPersist=!0)})})},this.setMethods=n=>({addTrace:s=>this.addTrace(n,s),setError:s=>this.setError(n,s)}),this.addTrace=(n,s)=>{const h=this.events.get(n);h&&(h.props.properties.trace.push(s),this.events.set(n,h),this.shouldPersist=!0)},this.setError=(n,s)=>{const h=this.events.get(n);h&&(h.props.type=s,h.timestamp=Date.now(),this.events.set(n,h),this.shouldPersist=!0)},this.persist=async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1},this.restore=async()=>{try{const n=await this.core.storage.getItem(this.storageKey)||[];if(!n.length)return;n.forEach(s=>{this.events.set(s.eventId,Ln(Ln({},s),this.setMethods(s.eventId)))})}catch(n){this.logger.warn(n)}},this.submit=async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const n=[];for(const[s,h]of this.events)h.props.type&&n.push(h);if(n.length!==0)try{if((await this.sendEvent(n)).ok)for(const s of n)this.events.delete(s.eventId),this.shouldPersist=!0}catch(s){this.logger.warn(s)}},this.sendEvent=async n=>{const s=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${X2}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${bo}${s}`,{method:"POST",body:JSON.stringify(n)})},this.getAppDomain=()=>Cu().url,this.logger=Ut(t,this.context),this.telemetryEnabled=i,i?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var J6=Object.defineProperty,nc=Object.getOwnPropertySymbols,Y6=Object.prototype.hasOwnProperty,X6=Object.prototype.propertyIsEnumerable,sc=(r,e,t)=>e in r?J6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ac=(r,e)=>{for(var t in e||(e={}))Y6.call(e,t)&&sc(r,t,e[t]);if(nc)for(var t of nc(e))X6.call(e,t)&&sc(r,t,e[t]);return r};class Qo extends Rd{constructor(e){var t;super(e),this.protocol=Xu,this.version=Zu,this.name=Zo,this.events=new Tr.EventEmitter,this.initialized=!1,this.on=(h,u)=>this.events.on(h,u),this.once=(h,u)=>this.events.once(h,u),this.off=(h,u)=>this.events.off(h,u),this.removeListener=(h,u)=>this.events.removeListener(h,u),this.dispatchEnvelope=({topic:h,message:u,sessionExists:g})=>{if(!h||!u)return;const b={topic:h,message:u,publishedAt:Date.now(),transportType:nt.link_mode};this.relayer.onLinkMessageEvent(b,{sessionExists:g})},this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||e0,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const i=Eo({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:b2.logger}),{logger:n,chunkLoggerController:s}=Nd({opts:i,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=s,(t=this.logChunkController)!=null&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var h,u;(h=this.logChunkController)!=null&&h.downloadLogsBlobInBrowser&&((u=this.logChunkController)==null||u.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Ut(n,this.name),this.heartbeat=new Sl,this.crypto=new M6(this,this.logger,e==null?void 0:e.keychain),this.history=new B6(this,this.logger),this.expirer=new k6(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new id(ac(ac({},m2),e==null?void 0:e.storageOptions)),this.relayer=new $6({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new z6(this,this.logger),this.verify=new K6(this,this.logger,this.storage),this.echoClient=new j6(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new W6(this,this.logger,e==null?void 0:e.telemetryEnabled)}static async init(e){const t=new Qo(e);await t.initialize();const i=await t.crypto.getClientId();return await t.storage.setItem(R2,i),t}get context(){return Vt(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(Bh,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.eventClient.init(),this.linkModeSupportedApps=await this.storage.getItem(Bh)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const Z6=Qo,l0="wc",d0=2,p0="client",ef=`${l0}@${d0}:${p0}:`,Ga={name:p0,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.org"},oc="WALLETCONNECT_DEEPLINK_CHOICE",Q6="proposal",ew="Proposal expired",tw="session",Xi=be.SEVEN_DAYS,rw="engine",_t={wc_sessionPropose:{req:{ttl:be.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:be.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:be.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:be.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:be.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:be.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:be.ONE_DAY,prompt:!1,tag:1104},res:{ttl:be.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:be.ONE_DAY,prompt:!1,tag:1106},res:{ttl:be.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:be.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:be.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:be.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:be.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:be.ONE_DAY,prompt:!1,tag:1112},res:{ttl:be.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:be.ONE_DAY,prompt:!1,tag:1114},res:{ttl:be.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:be.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:be.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:be.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:be.FIVE_MINUTES,prompt:!1,tag:1119}}},Wa={min:be.FIVE_MINUTES,max:be.SEVEN_DAYS},Lr={idle:"IDLE",active:"ACTIVE"},iw="request",nw=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],sw="wc",aw="auth",ow="authKeys",fw="pairingTopics",hw="requests",ba=`${sw}@${1.5}:${aw}:`,As=`${ba}:PUB_KEY`;var cw=Object.defineProperty,uw=Object.defineProperties,lw=Object.getOwnPropertyDescriptors,fc=Object.getOwnPropertySymbols,dw=Object.prototype.hasOwnProperty,pw=Object.prototype.propertyIsEnumerable,hc=(r,e,t)=>e in r?cw(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,lt=(r,e)=>{for(var t in e||(e={}))dw.call(e,t)&&hc(r,t,e[t]);if(fc)for(var t of fc(e))pw.call(e,t)&&hc(r,t,e[t]);return r},Pr=(r,e)=>uw(r,lw(e));class vw extends jd{constructor(e){super(e),this.name=rw,this.events=new mc,this.initialized=!1,this.requestQueue={state:Lr.idle,queue:[]},this.sessionRequestQueue={state:Lr.idle,queue:[]},this.requestQueueDelay=be.ONE_SECOND,this.expectedPairingMethodMap=new Map,this.recentlyDeletedMap=new Map,this.recentlyDeletedLimit=200,this.relayMessageCache=[],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(_t)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},be.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const i=Pr(lt({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:h,sessionProperties:u,relays:g}=i;let b=n,_,M=!1;try{b&&(M=this.client.core.pairing.pairings.get(b).active)}catch(R){throw this.client.logger.error(`connect() -> pairing.get(${b}) failed`),R}if(!b||!M){const{topic:R,uri:C}=await this.client.core.pairing.create();b=R,_=C}if(!b){const{message:R}=le("NO_MATCHING_KEY",`connect() pairing topic: ${b}`);throw new Error(R)}const A=await this.client.core.crypto.generateKeyPair(),I=_t.wc_sessionPropose.req.ttl||be.FIVE_MINUTES,D=yt(I),N=lt({requiredNamespaces:s,optionalNamespaces:h,relays:g??[{protocol:Qu}],proposer:{publicKey:A,metadata:this.client.metadata},expiryTimestamp:D,pairingTopic:b},u&&{sessionProperties:u}),{reject:U,resolve:k,done:T}=Di(I,ew);this.events.once(Qe("session_connect"),async({error:R,session:C})=>{if(R)U(R);else if(C){C.self.publicKey=A;const $=Pr(lt({},C),{pairingTopic:N.pairingTopic,requiredNamespaces:N.requiredNamespaces,optionalNamespaces:N.optionalNamespaces,transportType:nt.relay});await this.client.session.set(C.topic,$),await this.setExpiry(C.topic,C.expiry),b&&await this.client.core.pairing.updateMetadata({topic:b,metadata:C.peer.metadata}),this.cleanupDuplicatePairings($),k($)}});const K=await this.sendRequest({topic:b,method:"wc_sessionPropose",params:N,throwOnFailedPublish:!0});return await this.setProposal(K,lt({id:K},N)),{uri:_,approval:T}},this.pair=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(t)}catch(i){throw this.client.logger.error("pair() failed"),i}},this.approve=async t=>{var i,n,s;const h=this.client.core.eventClient.createEvent({properties:{topic:(i=t==null?void 0:t.id)==null?void 0:i.toString(),trace:[Dr.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(O){throw h.setError(Ii.no_internet_connection),O}try{await this.isValidProposalId(t==null?void 0:t.id)}catch(O){throw this.client.logger.error(`approve() -> proposal.get(${t==null?void 0:t.id}) failed`),h.setError(Ii.proposal_not_found),O}try{await this.isValidApprove(t)}catch(O){throw this.client.logger.error("approve() -> isValidApprove() failed"),h.setError(Ii.session_approve_namespace_validation_failure),O}const{id:u,relayProtocol:g,namespaces:b,sessionProperties:_,sessionConfig:M}=t,A=this.client.proposal.get(u);this.client.core.eventClient.deleteEvent({eventId:h.eventId});const{pairingTopic:I,proposer:D,requiredNamespaces:N,optionalNamespaces:U}=A;let k=(n=this.client.core.eventClient)==null?void 0:n.getEvent({topic:I});k||(k=(s=this.client.core.eventClient)==null?void 0:s.createEvent({type:Dr.session_approve_started,properties:{topic:I,trace:[Dr.session_approve_started,Dr.session_namespaces_validation_success]}}));const T=await this.client.core.crypto.generateKeyPair(),K=D.publicKey,R=await this.client.core.crypto.generateSharedKey(T,K),C=lt(lt({relay:{protocol:g??"irn"},namespaces:b,controller:{publicKey:T,metadata:this.client.metadata},expiry:yt(Xi)},_&&{sessionProperties:_}),M&&{sessionConfig:M}),$=nt.relay;k.addTrace(Dr.subscribing_session_topic);try{await this.client.core.relayer.subscribe(R,{transportType:$})}catch(O){throw k.setError(Ii.subscribe_session_topic_failure),O}k.addTrace(Dr.subscribe_session_topic_success);const E=Pr(lt({},C),{topic:R,requiredNamespaces:N,optionalNamespaces:U,pairingTopic:I,acknowledged:!1,self:C.controller,peer:{publicKey:D.publicKey,metadata:D.metadata},controller:T,transportType:nt.relay});await this.client.session.set(R,E),k.addTrace(Dr.store_session);try{k.addTrace(Dr.publishing_session_settle),await this.sendRequest({topic:R,method:"wc_sessionSettle",params:C,throwOnFailedPublish:!0}).catch(O=>{throw k==null||k.setError(Ii.session_settle_publish_failure),O}),k.addTrace(Dr.session_settle_publish_success),k.addTrace(Dr.publishing_session_approve),await this.sendResult({id:u,topic:I,result:{relay:{protocol:g??"irn"},responderPublicKey:T},throwOnFailedPublish:!0}).catch(O=>{throw k==null||k.setError(Ii.session_approve_publish_failure),O}),k.addTrace(Dr.session_approve_publish_success)}catch(O){throw this.client.logger.error(O),this.client.session.delete(R,st("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(R),O}return this.client.core.eventClient.deleteEvent({eventId:k.eventId}),await this.client.core.pairing.updateMetadata({topic:I,metadata:D.metadata}),await this.client.proposal.delete(u,st("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:I}),await this.setExpiry(R,yt(Xi)),{topic:R,acknowledged:()=>Promise.resolve(this.client.session.get(R))}},this.reject=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(t)}catch(h){throw this.client.logger.error("reject() -> isValidReject() failed"),h}const{id:i,reason:n}=t;let s;try{s=this.client.proposal.get(i).pairingTopic}catch(h){throw this.client.logger.error(`reject() -> proposal.get(${i}) failed`),h}s&&(await this.sendError({id:i,topic:s,error:n,rpcOpts:_t.wc_sessionPropose.reject}),await this.client.proposal.delete(i,st("USER_DISCONNECTED")))},this.update=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(t)}catch(M){throw this.client.logger.error("update() -> isValidUpdate() failed"),M}const{topic:i,namespaces:n}=t,{done:s,resolve:h,reject:u}=Di(),g=Gi(),b=Ri().toString(),_=this.client.session.get(i).namespaces;return this.events.once(Qe("session_update",g),({error:M})=>{M?u(M):h()}),await this.client.session.update(i,{namespaces:n}),await this.sendRequest({topic:i,method:"wc_sessionUpdate",params:{namespaces:n},throwOnFailedPublish:!0,clientRpcId:g,relayRpcId:b}).catch(M=>{this.client.logger.error(M),this.client.session.update(i,{namespaces:_}),u(M)}),{acknowledged:s}},this.extend=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(t)}catch(g){throw this.client.logger.error("extend() -> isValidExtend() failed"),g}const{topic:i}=t,n=Gi(),{done:s,resolve:h,reject:u}=Di();return this.events.once(Qe("session_extend",n),({error:g})=>{g?u(g):h()}),await this.setExpiry(i,yt(Xi)),this.sendRequest({topic:i,method:"wc_sessionExtend",params:{},clientRpcId:n,throwOnFailedPublish:!0}).catch(g=>{u(g)}),{acknowledged:s}},this.request=async t=>{this.isInitialized();try{await this.isValidRequest(t)}catch(D){throw this.client.logger.error("request() -> isValidRequest() failed"),D}const{chainId:i,request:n,topic:s,expiry:h=_t.wc_sessionRequest.req.ttl}=t,u=this.client.session.get(s);(u==null?void 0:u.transportType)===nt.relay&&await this.confirmOnlineStateOrThrow();const g=Gi(),b=Ri().toString(),{done:_,resolve:M,reject:A}=Di(h,"Request expired. Please try again.");this.events.once(Qe("session_request",g),({error:D,result:N})=>{D?A(D):M(N)});const I=this.getAppLinkIfEnabled(u.peer.metadata,u.transportType);return I?(await this.sendRequest({clientRpcId:g,relayRpcId:b,topic:s,method:"wc_sessionRequest",params:{request:Pr(lt({},n),{expiryTimestamp:yt(h)}),chainId:i},expiry:h,throwOnFailedPublish:!0,appLink:I}).catch(D=>A(D)),this.client.events.emit("session_request_sent",{topic:s,request:n,chainId:i,id:g}),await _()):await Promise.all([new Promise(async D=>{await this.sendRequest({clientRpcId:g,relayRpcId:b,topic:s,method:"wc_sessionRequest",params:{request:Pr(lt({},n),{expiryTimestamp:yt(h)}),chainId:i},expiry:h,throwOnFailedPublish:!0}).catch(N=>A(N)),this.client.events.emit("session_request_sent",{topic:s,request:n,chainId:i,id:g}),D()}),new Promise(async D=>{var N;if(!((N=u.sessionConfig)!=null&&N.disableDeepLink)){const U=await Dm(this.client.core.storage,oc);await Im({id:g,topic:s,wcDeepLink:U})}D()}),_()]).then(D=>D[2])},this.respond=async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:i,response:n}=t,{id:s}=n,h=this.client.session.get(i);h.transportType===nt.relay&&await this.confirmOnlineStateOrThrow();const u=this.getAppLinkIfEnabled(h.peer.metadata,h.transportType);Fr(n)?await this.sendResult({id:s,topic:i,result:n.result,throwOnFailedPublish:!0,appLink:u}):br(n)&&await this.sendError({id:s,topic:i,error:n.error,appLink:u}),this.cleanupAfterResponse(t)},this.ping=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(t)}catch(n){throw this.client.logger.error("ping() -> isValidPing() failed"),n}const{topic:i}=t;if(this.client.session.keys.includes(i)){const n=Gi(),s=Ri().toString(),{done:h,resolve:u,reject:g}=Di();this.events.once(Qe("session_ping",n),({error:b})=>{b?g(b):u()}),await Promise.all([this.sendRequest({topic:i,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:n,relayRpcId:s}),h()])}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(t);const{topic:i,event:n,chainId:s}=t,h=Ri().toString();await this.sendRequest({topic:i,method:"wc_sessionEvent",params:{event:n,chainId:s},throwOnFailedPublish:!0,relayRpcId:h})},this.disconnect=async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(t);const{topic:i}=t;if(this.client.session.keys.includes(i))await this.sendRequest({topic:i,method:"wc_sessionDelete",params:st("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:i,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(i))await this.client.core.pairing.disconnect({topic:i});else{const{message:n}=le("MISMATCHED_TOPIC",`Session or pairing topic not found: ${i}`);throw new Error(n)}},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(i=>Dy(i,t))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.authenticate=async(t,i)=>{var n;this.isInitialized(),this.isValidAuthenticate(t);const s=i&&this.client.core.linkModeSupportedApps.includes(i)&&((n=this.client.metadata.redirect)==null?void 0:n.linkMode),h=s?nt.link_mode:nt.relay;h===nt.relay&&await this.confirmOnlineStateOrThrow();const{chains:u,statement:g="",uri:b,domain:_,nonce:M,type:A,exp:I,nbf:D,methods:N=[],expiry:U}=t,k=[...t.resources||[]],{topic:T,uri:K}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:h});this.client.logger.info({message:"Generated new pairing",pairing:{topic:T,uri:K}});const R=await this.client.core.crypto.generateKeyPair(),C=Is(R);if(await Promise.all([this.client.auth.authKeys.set(As,{responseTopic:C,publicKey:R}),this.client.auth.pairingTopics.set(C,{topic:C,pairingTopic:T})]),await this.client.core.relayer.subscribe(C,{transportType:h}),this.client.logger.info(`sending request to new pairing topic: ${T}`),N.length>0){const{namespace:y}=Es(u[0]);let m=Jm(y,"request",N);Ss(k)&&(m=Xm(m,k.pop())),k.push(m)}const $=U&&U>_t.wc_sessionAuthenticate.req.ttl?U:_t.wc_sessionAuthenticate.req.ttl,E={authPayload:{type:A??"caip122",chains:u,statement:g,aud:b,domain:_,version:"1",nonce:M,iat:new Date().toISOString(),exp:I,nbf:D,resources:k},requester:{publicKey:R,metadata:this.client.metadata},expiryTimestamp:yt($)},O={eip155:{chains:u,methods:[...new Set(["personal_sign",...N])],events:["chainChanged","accountsChanged"]}},J={requiredNamespaces:{},optionalNamespaces:O,relays:[{protocol:"irn"}],pairingTopic:T,proposer:{publicKey:R,metadata:this.client.metadata},expiryTimestamp:yt(_t.wc_sessionPropose.req.ttl)},{done:Z,resolve:P,reject:w}=Di($,"Request expired"),c=async({error:y,session:m})=>{if(this.events.off(Qe("session_request",o),a),y)w(y);else if(m){m.self.publicKey=R,await this.client.session.set(m.topic,m),await this.setExpiry(m.topic,m.expiry),T&&await this.client.core.pairing.updateMetadata({topic:T,metadata:m.peer.metadata});const l=this.client.session.get(m.topic);await this.deleteProposal(d),P({session:l})}},a=async y=>{var m,l,p;if(await this.deletePendingAuthRequest(o,{message:"fulfilled",code:0}),y.error){const z=st("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return y.error.code===z.code?void 0:(this.events.off(Qe("session_connect"),c),w(y.error.message))}await this.deleteProposal(d),this.events.off(Qe("session_connect"),c);const{cacaos:f,responder:x}=y.result,H=[],j=[];for(const z of f){await wh({cacao:z,projectId:this.client.core.projectId})||(this.client.logger.error(z,"Signature verification failed"),w(st("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:q}=z,S=Ss(q.resources),F=[po(q.iss)],W=ks(q.iss);if(S){const te=_h(S),fe=xh(S);H.push(...te),F.push(...fe)}for(const te of F)j.push(`${te}:${W}`)}const G=await this.client.core.crypto.generateSharedKey(R,x.publicKey);let B;H.length>0&&(B={topic:G,acknowledged:!0,self:{publicKey:R,metadata:this.client.metadata},peer:x,controller:x.publicKey,expiry:yt(Xi),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:T,namespaces:Nh([...new Set(H)],[...new Set(j)]),transportType:h},await this.client.core.relayer.subscribe(G,{transportType:h}),await this.client.session.set(G,B),T&&await this.client.core.pairing.updateMetadata({topic:T,metadata:x.metadata}),B=this.client.session.get(G)),(m=this.client.metadata.redirect)!=null&&m.linkMode&&(l=x.metadata.redirect)!=null&&l.linkMode&&(p=x.metadata.redirect)!=null&&p.universal&&i&&(this.client.core.addLinkModeSupportedApp(x.metadata.redirect.universal),this.client.session.update(G,{transportType:nt.link_mode})),P({auths:f,session:B})},o=Gi(),d=Gi();this.events.once(Qe("session_connect"),c),this.events.once(Qe("session_request",o),a);let v;try{if(s){const y=Ni("wc_sessionAuthenticate",E,o);this.client.core.history.set(T,y);const m=await this.client.core.crypto.encode("",y,{type:ss,encoding:On});v=bs(i,T,m)}else await Promise.all([this.sendRequest({topic:T,method:"wc_sessionAuthenticate",params:E,expiry:t.expiry,throwOnFailedPublish:!0,clientRpcId:o}),this.sendRequest({topic:T,method:"wc_sessionPropose",params:J,expiry:_t.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:d})])}catch(y){throw this.events.off(Qe("session_connect"),c),this.events.off(Qe("session_request",o),a),y}return await this.setProposal(d,lt({id:d},J)),await this.setAuthRequest(o,{request:Pr(lt({},E),{verifyContext:{}}),pairingTopic:T,transportType:h}),{uri:v??K,response:Z}},this.approveSessionAuthenticate=async t=>{const{id:i,auths:n}=t,s=this.client.core.eventClient.createEvent({properties:{topic:i.toString(),trace:[Ai.authenticated_session_approve_started]}});try{this.isInitialized()}catch(U){throw s.setError(Tn.no_internet_connection),U}const h=this.getPendingAuthRequest(i);if(!h)throw s.setError(Tn.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${i}`);const u=h.transportType||nt.relay;u===nt.relay&&await this.confirmOnlineStateOrThrow();const g=h.requester.publicKey,b=await this.client.core.crypto.generateKeyPair(),_=Is(g),M={type:ni,receiverPublicKey:g,senderPublicKey:b},A=[],I=[];for(const U of n){if(!await wh({cacao:U,projectId:this.client.core.projectId})){s.setError(Tn.invalid_cacao);const C=st("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:i,topic:_,error:C,encodeOpts:M}),new Error(C.message)}s.addTrace(Ai.cacaos_verified);const{p:k}=U,T=Ss(k.resources),K=[po(k.iss)],R=ks(k.iss);if(T){const C=_h(T),$=xh(T);A.push(...C),K.push(...$)}for(const C of K)I.push(`${C}:${R}`)}const D=await this.client.core.crypto.generateSharedKey(b,g);s.addTrace(Ai.create_authenticated_session_topic);let N;if((A==null?void 0:A.length)>0){N={topic:D,acknowledged:!0,self:{publicKey:b,metadata:this.client.metadata},peer:{publicKey:g,metadata:h.requester.metadata},controller:g,expiry:yt(Xi),authentication:n,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:h.pairingTopic,namespaces:Nh([...new Set(A)],[...new Set(I)]),transportType:u},s.addTrace(Ai.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(D,{transportType:u})}catch(U){throw s.setError(Tn.subscribe_authenticated_session_topic_failure),U}s.addTrace(Ai.subscribe_authenticated_session_topic_success),await this.client.session.set(D,N),s.addTrace(Ai.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:h.pairingTopic,metadata:h.requester.metadata})}s.addTrace(Ai.publishing_authenticated_session_approve);try{await this.sendResult({topic:_,id:i,result:{cacaos:n,responder:{publicKey:b,metadata:this.client.metadata}},encodeOpts:M,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(h.requester.metadata,u)})}catch(U){throw s.setError(Tn.authenticated_session_approve_publish_failure),U}return await this.client.auth.requests.delete(i,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:h.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:s.eventId}),{session:N}},this.rejectSessionAuthenticate=async t=>{this.isInitialized();const{id:i,reason:n}=t,s=this.getPendingAuthRequest(i);if(!s)throw new Error(`Could not find pending auth request with id ${i}`);s.transportType===nt.relay&&await this.confirmOnlineStateOrThrow();const h=s.requester.publicKey,u=await this.client.core.crypto.generateKeyPair(),g=Is(h),b={type:ni,receiverPublicKey:h,senderPublicKey:u};await this.sendError({id:i,topic:g,error:n,encodeOpts:b,rpcOpts:_t.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(s.requester.metadata,s.transportType)}),await this.client.auth.requests.delete(i,{message:"rejected",code:0}),await this.client.proposal.delete(i,st("USER_DISCONNECTED"))},this.formatAuthMessage=t=>{this.isInitialized();const{request:i,iss:n}=t;return Bu(i,n)},this.processRelayMessageCache=()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const t=this.relayMessageCache.shift();t&&await this.onRelayMessage(t)}catch(t){this.client.logger.error(t)}},50)},this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const i=this.client.core.pairing.pairings.get(t.pairingTopic),n=this.client.core.pairing.pairings.getAll().filter(s=>{var h,u;return((h=s.peerMetadata)==null?void 0:h.url)&&((u=s.peerMetadata)==null?void 0:u.url)===t.peer.metadata.url&&s.topic&&s.topic!==i.topic});if(n.length===0)return;this.client.logger.info(`Cleaning up ${n.length} duplicate pairing(s)`),await Promise.all(n.map(s=>this.client.core.pairing.disconnect({topic:s.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(i){this.client.logger.error(i)}},this.deleteSession=async t=>{var i;const{topic:n,expirerHasDeleted:s=!1,emitEvent:h=!0,id:u=0}=t,{self:g}=this.client.session.get(n);await this.client.core.relayer.unsubscribe(n),await this.client.session.delete(n,st("USER_DISCONNECTED")),this.addToRecentlyDeleted(n,"session"),this.client.core.crypto.keychain.has(g.publicKey)&&await this.client.core.crypto.deleteKeyPair(g.publicKey),this.client.core.crypto.keychain.has(n)&&await this.client.core.crypto.deleteSymKey(n),s||this.client.core.expirer.del(n),this.client.core.storage.removeItem(oc).catch(b=>this.client.logger.warn(b)),this.getPendingSessionRequests().forEach(b=>{b.topic===n&&this.deletePendingSessionRequest(b.id,st("USER_DISCONNECTED"))}),n===((i=this.sessionRequestQueue.queue[0])==null?void 0:i.topic)&&(this.sessionRequestQueue.state=Lr.idle),h&&this.client.events.emit("session_delete",{id:u,topic:n})},this.deleteProposal=async(t,i)=>{if(i)try{const n=this.client.proposal.get(t),s=this.client.core.eventClient.getEvent({topic:n.pairingTopic});s==null||s.setError(Ii.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(t,st("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"proposal")},this.deletePendingSessionRequest=async(t,i,n=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,i),n?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(s=>s.id!==t),n&&(this.sessionRequestQueue.state=Lr.idle,this.client.events.emit("session_request_expire",{id:t}))},this.deletePendingAuthRequest=async(t,i,n=!1)=>{await Promise.all([this.client.auth.requests.delete(t,i),n?Promise.resolve():this.client.core.expirer.del(t)])},this.setExpiry=async(t,i)=>{this.client.session.keys.includes(t)&&(this.client.core.expirer.set(t,i),await this.client.session.update(t,{expiry:i}))},this.setProposal=async(t,i)=>{this.client.core.expirer.set(t,yt(_t.wc_sessionPropose.req.ttl)),await this.client.proposal.set(t,i)},this.setAuthRequest=async(t,i)=>{const{request:n,pairingTopic:s,transportType:h=nt.relay}=i;this.client.core.expirer.set(t,n.expiryTimestamp),await this.client.auth.requests.set(t,{authPayload:n.authPayload,requester:n.requester,expiryTimestamp:n.expiryTimestamp,id:t,pairingTopic:s,verifyContext:n.verifyContext,transportType:h})},this.setPendingSessionRequest=async t=>{const{id:i,topic:n,params:s,verifyContext:h}=t,u=s.request.expiryTimestamp||yt(_t.wc_sessionRequest.req.ttl);this.client.core.expirer.set(i,u),await this.client.pendingRequest.set(i,{id:i,topic:n,params:s,verifyContext:h})},this.sendRequest=async t=>{const{topic:i,method:n,params:s,expiry:h,relayRpcId:u,clientRpcId:g,throwOnFailedPublish:b,appLink:_}=t,M=Ni(n,s,g);let A;const I=!!_;try{const U=I?On:pi;A=await this.client.core.crypto.encode(i,M,{encoding:U})}catch(U){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${i} failed`),U}let D;if(nw.includes(n)){const U=ti(JSON.stringify(M)),k=ti(A);D=await this.client.core.verify.register({id:k,decryptedId:U})}const N=_t[n].req;if(N.attestation=D,h&&(N.ttl=h),u&&(N.id=u),this.client.core.history.set(i,M),I){const U=bs(_,i,A);await global.Linking.openURL(U,this.client.name)}else{const U=_t[n].req;h&&(U.ttl=h),u&&(U.id=u),b?(U.internal=Pr(lt({},U.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,A,U)):this.client.core.relayer.publish(i,A,U).catch(k=>this.client.logger.error(k))}return M.id},this.sendResult=async t=>{const{id:i,topic:n,result:s,throwOnFailedPublish:h,encodeOpts:u,appLink:g}=t,b=_o(i,s);let _;const M=g&&typeof(global==null?void 0:global.Linking)<"u";try{const I=M?On:pi;_=await this.client.core.crypto.encode(n,b,Pr(lt({},u||{}),{encoding:I}))}catch(I){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${n} failed`),I}let A;try{A=await this.client.core.history.get(n,i)}catch(I){throw this.client.logger.error(`sendResult() -> history.get(${n}, ${i}) failed`),I}if(M){const I=bs(g,n,_);await global.Linking.openURL(I,this.client.name)}else{const I=_t[A.request.method].res;h?(I.internal=Pr(lt({},I.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,_,I)):this.client.core.relayer.publish(n,_,I).catch(D=>this.client.logger.error(D))}await this.client.core.history.resolve(b)},this.sendError=async t=>{const{id:i,topic:n,error:s,encodeOpts:h,rpcOpts:u,appLink:g}=t,b=wo(i,s);let _;const M=g&&typeof(global==null?void 0:global.Linking)<"u";try{const I=M?On:pi;_=await this.client.core.crypto.encode(n,b,Pr(lt({},h||{}),{encoding:I}))}catch(I){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${n} failed`),I}let A;try{A=await this.client.core.history.get(n,i)}catch(I){throw this.client.logger.error(`sendError() -> history.get(${n}, ${i}) failed`),I}if(M){const I=bs(g,n,_);await global.Linking.openURL(I,this.client.name)}else{const I=u||_t[A.request.method].res;this.client.core.relayer.publish(n,_,I)}await this.client.core.history.resolve(b)},this.cleanup=async()=>{const t=[],i=[];this.client.session.getAll().forEach(n=>{let s=!1;li(n.expiry)&&(s=!0),this.client.core.crypto.keychain.has(n.topic)||(s=!0),s&&t.push(n.topic)}),this.client.proposal.getAll().forEach(n=>{li(n.expiryTimestamp)&&i.push(n.id)}),await Promise.all([...t.map(n=>this.deleteSession({topic:n})),...i.map(n=>this.deleteProposal(n))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===Lr.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Lr.active;const t=this.requestQueue.queue.shift();if(t)try{await this.processRequest(t)}catch(i){this.client.logger.warn(i)}}this.requestQueue.state=Lr.idle},this.processRequest=async t=>{const{topic:i,payload:n,attestation:s,transportType:h,encryptedId:u}=t,g=n.method;if(!this.shouldIgnorePairingRequest({topic:i,requestMethod:g}))switch(g){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:i,payload:n,attestation:s,encryptedId:u});case"wc_sessionSettle":return await this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return await this.onSessionExtendRequest(i,n);case"wc_sessionPing":return await this.onSessionPingRequest(i,n);case"wc_sessionDelete":return await this.onSessionDeleteRequest(i,n);case"wc_sessionRequest":return await this.onSessionRequest({topic:i,payload:n,attestation:s,encryptedId:u,transportType:h});case"wc_sessionEvent":return await this.onSessionEventRequest(i,n);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:i,payload:n,attestation:s,encryptedId:u,transportType:h});default:return this.client.logger.info(`Unsupported request method ${g}`)}},this.onRelayEventResponse=async t=>{const{topic:i,payload:n,transportType:s}=t,h=(await this.client.core.history.get(i,n.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n,s);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:i}=t,{message:n}=le("MISSING_OR_INVALID",`Decoded payload on topic ${i} is not identifiable as a JSON-RPC request or a response.`);throw new Error(n)},this.shouldIgnorePairingRequest=t=>{const{topic:i,requestMethod:n}=t,s=this.expectedPairingMethodMap.get(i);return!s||s.includes(n)?!1:!!(s.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)},this.onSessionProposeRequest=async t=>{const{topic:i,payload:n,attestation:s,encryptedId:h}=t,{params:u,id:g}=n;try{const b=this.client.core.eventClient.getEvent({topic:i});this.isValidConnect(lt({},n.params));const _=u.expiryTimestamp||yt(_t.wc_sessionPropose.req.ttl),M=lt({id:g,pairingTopic:i,expiryTimestamp:_},u);await this.setProposal(g,M);const A=await this.getVerifyContext({attestationId:s,hash:ti(JSON.stringify(n)),encryptedId:h,metadata:M.proposer.metadata});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),b==null||b.setError(ei.proposal_listener_not_found)),b==null||b.addTrace($r.emit_session_proposal),this.client.events.emit("session_proposal",{id:g,params:M,verifyContext:A})}catch(b){await this.sendError({id:g,topic:i,error:b,rpcOpts:_t.wc_sessionPropose.autoReject}),this.client.logger.error(b)}},this.onSessionProposeResponse=async(t,i,n)=>{const{id:s}=i;if(Fr(i)){const{result:h}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const u=this.client.proposal.get(s);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:u});const g=u.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:g});const b=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:b});const _=await this.client.core.crypto.generateSharedKey(g,b);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:_});const M=await this.client.core.relayer.subscribe(_,{transportType:n});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:M}),await this.client.core.pairing.activate({topic:t})}else if(br(i)){await this.client.proposal.delete(s,st("USER_DISCONNECTED"));const h=Qe("session_connect");if(this.events.listenerCount(h)===0)throw new Error(`emitting ${h} without any listeners, 954`);this.events.emit(Qe("session_connect"),{error:i.error})}},this.onSessionSettleRequest=async(t,i)=>{const{id:n,params:s}=i;try{this.isValidSessionSettleRequest(s);const{relay:h,controller:u,expiry:g,namespaces:b,sessionProperties:_,sessionConfig:M}=i.params,A=Pr(lt(lt({topic:t,relay:h,expiry:g,namespaces:b,acknowledged:!0,pairingTopic:"",requiredNamespaces:{},optionalNamespaces:{},controller:u.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:u.publicKey,metadata:u.metadata}},_&&{sessionProperties:_}),M&&{sessionConfig:M}),{transportType:nt.relay}),I=Qe("session_connect");if(this.events.listenerCount(I)===0)throw new Error(`emitting ${I} without any listeners 997`);this.events.emit(Qe("session_connect"),{session:A}),await this.sendResult({id:i.id,topic:t,result:!0,throwOnFailedPublish:!0})}catch(h){await this.sendError({id:n,topic:t,error:h}),this.client.logger.error(h)}},this.onSessionSettleResponse=async(t,i)=>{const{id:n}=i;Fr(i)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(Qe("session_approve",n),{})):br(i)&&(await this.client.session.delete(t,st("USER_DISCONNECTED")),this.events.emit(Qe("session_approve",n),{error:i.error}))},this.onSessionUpdateRequest=async(t,i)=>{const{params:n,id:s}=i;try{const h=`${t}_session_update`,u=Nn.get(h);if(u&&this.isRequestOutOfSync(u,s)){this.client.logger.info(`Discarding out of sync request - ${s}`),this.sendError({id:s,topic:t,error:st("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(lt({topic:t},n));try{Nn.set(h,s),await this.client.session.update(t,{namespaces:n.namespaces}),await this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0})}catch(g){throw Nn.delete(h),g}this.client.events.emit("session_update",{id:s,topic:t,params:n})}catch(h){await this.sendError({id:s,topic:t,error:h}),this.client.logger.error(h)}},this.isRequestOutOfSync=(t,i)=>parseInt(i.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,i)=>{const{id:n}=i,s=Qe("session_update",n);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);Fr(i)?this.events.emit(Qe("session_update",n),{}):br(i)&&this.events.emit(Qe("session_update",n),{error:i.error})},this.onSessionExtendRequest=async(t,i)=>{const{id:n}=i;try{this.isValidExtend({topic:t}),await this.setExpiry(t,yt(Xi)),await this.sendResult({id:n,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:n,topic:t})}catch(s){await this.sendError({id:n,topic:t,error:s}),this.client.logger.error(s)}},this.onSessionExtendResponse=(t,i)=>{const{id:n}=i,s=Qe("session_extend",n);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);Fr(i)?this.events.emit(Qe("session_extend",n),{}):br(i)&&this.events.emit(Qe("session_extend",n),{error:i.error})},this.onSessionPingRequest=async(t,i)=>{const{id:n}=i;try{this.isValidPing({topic:t}),await this.sendResult({id:n,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:n,topic:t})}catch(s){await this.sendError({id:n,topic:t,error:s}),this.client.logger.error(s)}},this.onSessionPingResponse=(t,i)=>{const{id:n}=i,s=Qe("session_ping",n);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);setTimeout(()=>{Fr(i)?this.events.emit(Qe("session_ping",n),{}):br(i)&&this.events.emit(Qe("session_ping",n),{error:i.error})},500)},this.onSessionDeleteRequest=async(t,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:t,reason:i.params}),Promise.all([new Promise(s=>{this.client.core.relayer.once(Ft.publish,async()=>{s(await this.deleteSession({topic:t,id:n}))})}),this.sendResult({id:n,topic:t,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:st("USER_DISCONNECTED")})]).catch(s=>this.client.logger.error(s))}catch(s){this.client.logger.error(s)}},this.onSessionRequest=async t=>{var i,n,s;const{topic:h,payload:u,attestation:g,encryptedId:b,transportType:_}=t,{id:M,params:A}=u;try{await this.isValidRequest(lt({topic:h},A));const I=this.client.session.get(h),D=await this.getVerifyContext({attestationId:g,hash:ti(JSON.stringify(Ni("wc_sessionRequest",A,M))),encryptedId:b,metadata:I.peer.metadata,transportType:_}),N={id:M,topic:h,params:A,verifyContext:D};await this.setPendingSessionRequest(N),_===nt.link_mode&&(i=I.peer.metadata.redirect)!=null&&i.universal&&this.client.core.addLinkModeSupportedApp((n=I.peer.metadata.redirect)==null?void 0:n.universal),(s=this.client.signConfig)!=null&&s.disableRequestQueue?this.emitSessionRequest(N):(this.addSessionRequestToSessionRequestQueue(N),this.processSessionRequestQueue())}catch(I){await this.sendError({id:M,topic:h,error:I}),this.client.logger.error(I)}},this.onSessionRequestResponse=(t,i)=>{const{id:n}=i,s=Qe("session_request",n);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);Fr(i)?this.events.emit(Qe("session_request",n),{result:i.result}):br(i)&&this.events.emit(Qe("session_request",n),{error:i.error})},this.onSessionEventRequest=async(t,i)=>{const{id:n,params:s}=i;try{const h=`${t}_session_event_${s.event.name}`,u=Nn.get(h);if(u&&this.isRequestOutOfSync(u,n)){this.client.logger.info(`Discarding out of sync request - ${n}`);return}this.isValidEmit(lt({topic:t},s)),this.client.events.emit("session_event",{id:n,topic:t,params:s}),Nn.set(h,n)}catch(h){await this.sendError({id:n,topic:t,error:h}),this.client.logger.error(h)}},this.onSessionAuthenticateResponse=(t,i)=>{const{id:n}=i;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:t,payload:i}),Fr(i)?this.events.emit(Qe("session_request",n),{result:i.result}):br(i)&&this.events.emit(Qe("session_request",n),{error:i.error})},this.onSessionAuthenticateRequest=async t=>{var i;const{topic:n,payload:s,attestation:h,encryptedId:u,transportType:g}=t;try{const{requester:b,authPayload:_,expiryTimestamp:M}=s.params,A=await this.getVerifyContext({attestationId:h,hash:ti(JSON.stringify(s)),encryptedId:u,metadata:b.metadata,transportType:g}),I={requester:b,pairingTopic:n,id:s.id,authPayload:_,verifyContext:A,expiryTimestamp:M};await this.setAuthRequest(s.id,{request:I,pairingTopic:n,transportType:g}),g===nt.link_mode&&(i=b.metadata.redirect)!=null&&i.universal&&this.client.core.addLinkModeSupportedApp(b.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:n,params:s.params,id:s.id,verifyContext:A})}catch(b){this.client.logger.error(b);const _=s.params.requester.publicKey,M=await this.client.core.crypto.generateKeyPair(),A=this.getAppLinkIfEnabled(s.params.requester.metadata,g),I={type:ni,receiverPublicKey:_,senderPublicKey:M};await this.sendError({id:s.id,topic:n,error:b,encodeOpts:I,rpcOpts:_t.wc_sessionAuthenticate.autoReject,appLink:A})}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Lr.idle,this.processSessionRequestQueue()},be.toMiliseconds(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:t,error:i})=>{const n=this.client.core.history.pending;n.length>0&&n.filter(s=>s.topic===t&&s.request.method==="wc_sessionRequest").forEach(s=>{const h=s.request.id,u=Qe("session_request",h);if(this.events.listenerCount(u)===0)throw new Error(`emitting ${u} without any listeners`);this.events.emit(Qe("session_request",s.request.id),{error:i})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===Lr.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=Lr.active,this.emitSessionRequest(t)}catch(i){this.client.logger.error(i)}},this.emitSessionRequest=t=>{this.client.events.emit("session_request",t)},this.onPairingCreated=t=>{if(t.methods&&this.expectedPairingMethodMap.set(t.topic,t.methods),t.active)return;const i=this.client.proposal.getAll().find(n=>n.pairingTopic===t.topic);i&&this.onSessionProposeRequest({topic:t.topic,payload:Ni("wc_sessionPropose",{requiredNamespaces:i.requiredNamespaces,optionalNamespaces:i.optionalNamespaces,relays:i.relays,proposer:i.proposer,sessionProperties:i.sessionProperties},i.id)})},this.isValidConnect=async t=>{if(!Bt(t)){const{message:g}=le("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(g)}const{pairingTopic:i,requiredNamespaces:n,optionalNamespaces:s,sessionProperties:h,relays:u}=t;if(kt(i)||await this.isValidPairingTopic(i),!zy(u)){const{message:g}=le("MISSING_OR_INVALID",`connect() relays: ${u}`);throw new Error(g)}!kt(n)&&Ks(n)!==0&&this.validateNamespaces(n,"requiredNamespaces"),!kt(s)&&Ks(s)!==0&&this.validateNamespaces(s,"optionalNamespaces"),kt(h)||this.validateSessionProps(h,"sessionProperties")},this.validateNamespaces=(t,i)=>{const n=Uy(t,"connect()",i);if(n)throw new Error(n.message)},this.isValidApprove=async t=>{if(!Bt(t))throw new Error(le("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:i,namespaces:n,relayProtocol:s,sessionProperties:h}=t;this.checkRecentlyDeleted(i),await this.isValidProposalId(i);const u=this.client.proposal.get(i),g=Ka(n,"approve()");if(g)throw new Error(g.message);const b=Ch(u.requiredNamespaces,n,"approve()");if(b)throw new Error(b.message);if(!vt(s,!0)){const{message:_}=le("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(_)}kt(h)||this.validateSessionProps(h,"sessionProperties")},this.isValidReject=async t=>{if(!Bt(t)){const{message:s}=le("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(s)}const{id:i,reason:n}=t;if(this.checkRecentlyDeleted(i),await this.isValidProposalId(i),!ky(n)){const{message:s}=le("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidSessionSettleRequest=t=>{if(!Bt(t)){const{message:b}=le("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(b)}const{relay:i,controller:n,namespaces:s,expiry:h}=t;if(!Ju(i)){const{message:b}=le("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(b)}const u=Ty(n,"onSessionSettleRequest()");if(u)throw new Error(u.message);const g=Ka(s,"onSessionSettleRequest()");if(g)throw new Error(g.message);if(li(h)){const{message:b}=le("EXPIRED","onSessionSettleRequest()");throw new Error(b)}},this.isValidUpdate=async t=>{if(!Bt(t)){const{message:g}=le("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(g)}const{topic:i,namespaces:n}=t;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i);const s=this.client.session.get(i),h=Ka(n,"update()");if(h)throw new Error(h.message);const u=Ch(s.requiredNamespaces,n,"update()");if(u)throw new Error(u.message)},this.isValidExtend=async t=>{if(!Bt(t)){const{message:n}=le("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(n)}const{topic:i}=t;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i)},this.isValidRequest=async t=>{if(!Bt(t)){const{message:g}=le("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(g)}const{topic:i,request:n,chainId:s,expiry:h}=t;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i);const{namespaces:u}=this.client.session.get(i);if(!Th(u,s)){const{message:g}=le("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(g)}if(!Ky(n)){const{message:g}=le("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(g)}if(!Vy(u,s,n.method)){const{message:g}=le("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(g)}if(h&&!Yy(h,Wa)){const{message:g}=le("MISSING_OR_INVALID",`request() expiry: ${h}. Expiry must be a number (in seconds) between ${Wa.min} and ${Wa.max}`);throw new Error(g)}},this.isValidRespond=async t=>{var i;if(!Bt(t)){const{message:h}=le("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(h)}const{topic:n,response:s}=t;try{await this.isValidSessionTopic(n)}catch(h){throw(i=t==null?void 0:t.response)!=null&&i.id&&this.cleanupAfterResponse(t),h}if(!jy(s)){const{message:h}=le("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(s)}`);throw new Error(h)}},this.isValidPing=async t=>{if(!Bt(t)){const{message:n}=le("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(n)}const{topic:i}=t;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async t=>{if(!Bt(t)){const{message:u}=le("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(u)}const{topic:i,event:n,chainId:s}=t;await this.isValidSessionTopic(i);const{namespaces:h}=this.client.session.get(i);if(!Th(h,s)){const{message:u}=le("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(u)}if(!Hy(n)){const{message:u}=le("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(u)}if(!Gy(h,s,n.name)){const{message:u}=le("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(u)}},this.isValidDisconnect=async t=>{if(!Bt(t)){const{message:n}=le("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(n)}const{topic:i}=t;await this.isValidSessionOrPairingTopic(i)},this.isValidAuthenticate=t=>{const{chains:i,uri:n,domain:s,nonce:h}=t;if(!Array.isArray(i)||i.length===0)throw new Error("chains is required and must be a non-empty array");if(!vt(n,!1))throw new Error("uri is required parameter");if(!vt(s,!1))throw new Error("domain is required parameter");if(!vt(h,!1))throw new Error("nonce is required parameter");if([...new Set(i.map(g=>Es(g).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:u}=Es(i[0]);if(u!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")},this.getVerifyContext=async t=>{const{attestationId:i,hash:n,encryptedId:s,metadata:h,transportType:u}=t,g={verified:{verifyUrl:h.verifyUrl||Un,validation:"UNKNOWN",origin:h.url||""}};try{if(u===nt.link_mode){const _=this.getAppLinkIfEnabled(h,u);return g.verified.validation=_&&new URL(_).origin===new URL(h.url).origin?"VALID":"INVALID",g}const b=await this.client.core.verify.resolve({attestationId:i,hash:n,encryptedId:s,verifyUrl:h.verifyUrl});b&&(g.verified.origin=b.origin,g.verified.isScam=b.isScam,g.verified.validation=b.origin===new URL(h.url).origin?"VALID":"INVALID")}catch(b){this.client.logger.warn(b)}return this.client.logger.debug(`Verify context: ${JSON.stringify(g)}`),g},this.validateSessionProps=(t,i)=>{Object.values(t).forEach(n=>{if(!vt(n,!1)){const{message:s}=le("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(n)}`);throw new Error(s)}})},this.getPendingAuthRequest=t=>{const i=this.client.auth.requests.get(t);return typeof i=="object"?i:void 0},this.addToRecentlyDeleted=(t,i)=>{if(this.recentlyDeletedMap.set(t,i),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let n=0;const s=this.recentlyDeletedLimit/2;for(const h of this.recentlyDeletedMap.keys()){if(n++>=s)break;this.recentlyDeletedMap.delete(h)}}},this.checkRecentlyDeleted=t=>{const i=this.recentlyDeletedMap.get(t);if(i){const{message:n}=le("MISSING_OR_INVALID",`Record was recently deleted - ${i}: ${t}`);throw new Error(n)}},this.isLinkModeEnabled=(t,i)=>{var n,s,h,u,g,b,_,M,A;return!t||i!==nt.link_mode?!1:((s=(n=this.client.metadata)==null?void 0:n.redirect)==null?void 0:s.linkMode)===!0&&((u=(h=this.client.metadata)==null?void 0:h.redirect)==null?void 0:u.universal)!==void 0&&((b=(g=this.client.metadata)==null?void 0:g.redirect)==null?void 0:b.universal)!==""&&((_=t==null?void 0:t.redirect)==null?void 0:_.universal)!==void 0&&((M=t==null?void 0:t.redirect)==null?void 0:M.universal)!==""&&((A=t==null?void 0:t.redirect)==null?void 0:A.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(t.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"},this.getAppLinkIfEnabled=(t,i)=>{var n;return this.isLinkModeEnabled(t,i)?(n=t==null?void 0:t.redirect)==null?void 0:n.universal:void 0},this.handleLinkModeMessage=({url:t})=>{if(!t||!t.includes("wc_ev")||!t.includes("topic"))return;const i=gh(t,"topic")||"",n=decodeURIComponent(gh(t,"wc_ev")||""),s=this.client.session.keys.includes(i);s&&this.client.session.update(i,{transportType:nt.link_mode}),this.client.core.dispatchEnvelope({topic:i,message:n,sessionExists:s})},this.registerLinkModeListeners=async()=>{var t;if(Go()||_n()&&(t=this.client.metadata.redirect)!=null&&t.linkMode){const i=global==null?void 0:global.Linking;if(typeof i<"u"){i.addEventListener("url",this.handleLinkModeMessage,this.client.name);const n=await i.getInitialURL();n&&setTimeout(()=>{this.handleLinkModeMessage({url:n})},50)}}}}isInitialized(){if(!this.initialized){const{message:e}=le("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Ft.message,e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):this.onRelayMessage(e)})}async onRelayMessage(e){const{topic:t,message:i,attestation:n,transportType:s}=e,{publicKey:h}=this.client.auth.authKeys.keys.includes(As)?this.client.auth.authKeys.get(As):{responseTopic:void 0,publicKey:void 0},u=await this.client.core.crypto.decode(t,i,{receiverPublicKey:h,encoding:s===nt.link_mode?On:pi});try{Xo(u)?(this.client.core.history.set(t,u),this.onRelayEventRequest({topic:t,payload:u,attestation:n,transportType:s,encryptedId:ti(i)})):va(u)?(await this.client.core.history.resolve(u),await this.onRelayEventResponse({topic:t,payload:u,transportType:s}),this.client.core.history.delete(t,u.id)):this.onRelayEventUnknownPayload({topic:t,payload:u,transportType:s})}catch(g){this.client.logger.error(g)}}registerExpirerEvents(){this.client.core.expirer.on(gr.expired,async e=>{const{topic:t,id:i}=Uu(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,le("EXPIRED"),!0);if(i&&this.client.auth.requests.keys.includes(i))return await this.deletePendingAuthRequest(i,le("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}registerPairingEvents(){this.client.core.pairing.events.on(Pi.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(Pi.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!vt(e,!1)){const{message:t}=le("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=le("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(li(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=le("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!vt(e,!1)){const{message:t}=le("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:t}=le("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(li(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=le("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=le("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(vt(e,!1)){const{message:t}=le("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=le("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!By(e)){const{message:t}=le("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=le("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(li(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=le("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class gw extends Hi{constructor(e,t){super(e,t,Q6,ef),this.core=e,this.logger=t}}class bw extends Hi{constructor(e,t){super(e,t,tw,ef),this.core=e,this.logger=t}}class mw extends Hi{constructor(e,t){super(e,t,iw,ef,i=>i.id),this.core=e,this.logger=t}}class yw extends Hi{constructor(e,t){super(e,t,ow,ba,()=>As),this.core=e,this.logger=t}}class ww extends Hi{constructor(e,t){super(e,t,fw,ba),this.core=e,this.logger=t}}class _w extends Hi{constructor(e,t){super(e,t,hw,ba,i=>i.id),this.core=e,this.logger=t}}class xw{constructor(e,t){this.core=e,this.logger=t,this.authKeys=new yw(this.core,this.logger),this.pairingTopics=new ww(this.core,this.logger),this.requests=new _w(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}class tf extends Kd{constructor(e){super(e),this.protocol=l0,this.version=d0,this.name=Ga.name,this.events=new Tr.EventEmitter,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}},this.update=async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}},this.request=async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}},this.find=i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.authenticate=async(i,n)=>{try{return await this.engine.authenticate(i,n)}catch(s){throw this.logger.error(s.message),s}},this.formatAuthMessage=i=>{try{return this.engine.formatAuthMessage(i)}catch(n){throw this.logger.error(n.message),n}},this.approveSessionAuthenticate=async i=>{try{return await this.engine.approveSessionAuthenticate(i)}catch(n){throw this.logger.error(n.message),n}},this.rejectSessionAuthenticate=async i=>{try{return await this.engine.rejectSessionAuthenticate(i)}catch(n){throw this.logger.error(n.message),n}},this.name=(e==null?void 0:e.name)||Ga.name,this.metadata=(e==null?void 0:e.metadata)||Cu(),this.signConfig=e==null?void 0:e.signConfig;const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Js(Eo({level:(e==null?void 0:e.logger)||Ga.logger}));this.core=(e==null?void 0:e.core)||new Z6(e),this.logger=Ut(t,this.name),this.session=new bw(this.core,this.logger),this.proposal=new gw(this.core,this.logger),this.pendingRequest=new mw(this.core,this.logger),this.engine=new vw(this),this.auth=new xw(this.core,this.logger)}static async init(e){const t=new tf(e);return await t.initialize(),t}get context(){return Vt(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),this.engine.processRelayMessageCache()}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const jw=tf;export{aw as AUTH_CONTEXT,ow as AUTH_KEYS_CONTEXT,fw as AUTH_PAIRING_TOPIC_CONTEXT,sw as AUTH_PROTOCOL,As as AUTH_PUBLIC_KEY_NAME,hw as AUTH_REQUEST_CONTEXT,ba as AUTH_STORAGE_PREFIX,rw as ENGINE_CONTEXT,Lr as ENGINE_QUEUE_STATES,_t as ENGINE_RPC_OPTS,nw as METHODS_TO_VERIFY,Q6 as PROPOSAL_CONTEXT,ew as PROPOSAL_EXPIRY_MESSAGE,iw as REQUEST_CONTEXT,tw as SESSION_CONTEXT,Xi as SESSION_EXPIRY,Wa as SESSION_REQUEST_EXPIRY_BOUNDARIES,p0 as SIGN_CLIENT_CONTEXT,Ga as SIGN_CLIENT_DEFAULT,l0 as SIGN_CLIENT_PROTOCOL,ef as SIGN_CLIENT_STORAGE_PREFIX,d0 as SIGN_CLIENT_VERSION,jw as SignClient,oc as WALLETCONNECT_DEEPLINK_CHOICE,tf as default};
